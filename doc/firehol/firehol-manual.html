<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="generator" content="pandoc" />
    <meta name="author" content="Copyright (c) 2004,2013-2015 Costa Tsaousis costa@firehol.org" />
    <meta name="author" content="Copyright (c) 2012-2015 Phil Whineray phil@firehol.org" />
    <title>FireHOL Reference</title>
    <style type="text/css">code{white-space: pre;}</style>
    <link rel="stylesheet" href="firehol-manual.css" type="text/css" />
  </head>
  <body>
    <div id="header">
      <h1 class="title">FireHOL Reference</h1>
      <h2 class="author">Copyright (c) 2004,2013-2015 Costa Tsaousis <a href="mailto:costa@firehol.org">costa@firehol.org</a></h2>
      <h2 class="author">Copyright (c) 2012-2015 Phil Whineray <a href="mailto:phil@firehol.org">phil@firehol.org</a></h2>
      <h3 class="date">Version 3.0.1 (Built 10 Jan 2016)</h3>
    </div>
    <div id="TOC">
      <ul>
        <li>
          <a href="#firehol-reference">FireHOL Reference</a>
          <ul>
            <li>
              <a href="#who-should-read-this-manual">Who should read this manual</a>
            </li>
            <li>
              <a href="#where-to-get-help">Where to get help</a>
            </li>
            <li>
              <a href="#installation">Installation</a>
            </li>
            <li>
              <a href="#licence">Licence</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#setting-up-and-running-firehol">Setting up and running FireHOL</a>
        </li>
        <li>
          <a href="#primary-commands">Primary commands</a>
        </li>
        <li>
          <a href="#sub-commands">Sub-commands</a>
        </li>
        <li>
          <a href="#helper-commands">Helper commands</a>
        </li>
        <li>
          <a href="#manual-pages-in-alphabetical-order">Manual Pages in Alphabetical Order</a>
          <ul>
            <li>
              <a href="#firehol1">firehol(1)</a>
              <ul>
                <li>
                  <a href="#name">NAME</a>
                </li>
                <li>
                  <a href="#synopsis">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#commands">COMMANDS</a>
                </li>
                <li>
                  <a href="#files">FILES</a>
                </li>
                <li>
                  <a href="#see-also">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol.conf5">firehol.conf(5)</a>
              <ul>
                <li>
                  <a href="#name-1">NAME</a>
                </li>
                <li>
                  <a href="#description-1">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#variables-available">VARIABLES AVAILABLE</a>
                </li>
                <li>
                  <a href="#adding-services">ADDING SERVICES</a>
                </li>
                <li>
                  <a href="#definitions">DEFINITIONS</a>
                </li>
                <li>
                  <a href="#subcommands">SUBCOMMANDS</a>
                </li>
                <li>
                  <a href="#helper-commands-1">HELPER COMMANDS</a>
                </li>
                <li>
                  <a href="#configuration-helper-commands">CONFIGURATION HELPER COMMANDS</a>
                </li>
                <li>
                  <a href="#see-also-1">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-action5">firehol-action(5)</a>
              <ul>
                <li>
                  <a href="#name-2">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-1">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-2">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#see-also-2">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-actions5">firehol-actions(5)</a>
              <ul>
                <li>
                  <a href="#name-3">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-2">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-3">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#reject-with-messages">REJECT WITH MESSAGES</a>
                </li>
                <li>
                  <a href="#see-also-3">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-blacklist5">firehol-blacklist(5)</a>
              <ul>
                <li>
                  <a href="#name-4">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-3">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-4">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-4">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-classify5">firehol-classify(5)</a>
              <ul>
                <li>
                  <a href="#name-5">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-4">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-5">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-1">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-5">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-client5">firehol-client(5)</a>
              <ul>
                <li>
                  <a href="#name-6">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-5">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-6">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-2">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-6">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-connmark5">firehol-connmark(5)</a>
              <ul>
                <li>
                  <a href="#name-7">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-6">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-7">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-3">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-7">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-dscp5">firehol-dscp(5)</a>
              <ul>
                <li>
                  <a href="#name-8">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-7">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-8">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-4">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-8">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-group5">firehol-group(5)</a>
              <ul>
                <li>
                  <a href="#name-9">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-8">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-9">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-5">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-9">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-interface5">firehol-interface(5)</a>
              <ul>
                <li>
                  <a href="#name-10">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-9">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-10">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#parameters">PARAMETERS</a>
                </li>
                <li>
                  <a href="#see-also-10">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-ipset5">firehol-ipset(5)</a>
              <ul>
                <li>
                  <a href="#name-11">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-10">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-11">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#firehol-ipset-extensions">FireHOL ipset extensions</a>
                </li>
                <li>
                  <a href="#examples-6">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-11">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-iptables5">firehol-iptables(5)</a>
              <ul>
                <li>
                  <a href="#name-12">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-11">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-12">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#see-also-12">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-iptrap5">firehol-iptrap(5)</a>
              <ul>
                <li>
                  <a href="#name-13">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-12">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-13">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-7">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-13">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-mac5">firehol-mac(5)</a>
              <ul>
                <li>
                  <a href="#name-14">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-13">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-14">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-8">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-14">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-mark5">firehol-mark(5)</a>
              <ul>
                <li>
                  <a href="#name-15">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-14">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-15">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-9">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-15">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-masquerade5">firehol-masquerade(5)</a>
              <ul>
                <li>
                  <a href="#name-16">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-15">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-16">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#masquerading-and-snat">MASQUERADING AND SNAT</a>
                </li>
                <li>
                  <a href="#examples-10">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-16">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-modifiers5">firehol-modifiers(5)</a>
              <ul>
                <li>
                  <a href="#name-17">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-16">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-17">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#see-also-17">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-nat5">firehol-nat(5)</a>
              <ul>
                <li>
                  <a href="#name-18">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-17">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-18">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#balancing">BALANCING</a>
                </li>
                <li>
                  <a href="#examples-11">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-18">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-params5">firehol-params(5)</a>
              <ul>
                <li>
                  <a href="#name-19">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-18">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-19">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#common">COMMON</a>
                </li>
                <li>
                  <a href="#router-only">ROUTER ONLY</a>
                </li>
                <li>
                  <a href="#interface-only">INTERFACE ONLY</a>
                </li>
                <li>
                  <a href="#logging">LOGGING</a>
                </li>
                <li>
                  <a href="#helpers-only-parameters">HELPERS ONLY PARAMETERS</a>
                </li>
                <li>
                  <a href="#see-also-19">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-policy5">firehol-policy(5)</a>
              <ul>
                <li>
                  <a href="#name-20">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-19">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-20">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#example">EXAMPLE</a>
                </li>
                <li>
                  <a href="#see-also-20">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-protection5">firehol-protection(5)</a>
              <ul>
                <li>
                  <a href="#name-21">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-20">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-21">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#packet-protection-types">PACKET PROTECTION TYPES</a>
                </li>
                <li>
                  <a href="#flood-protection-types">FLOOD PROTECTION TYPES</a>
                </li>
                <li>
                  <a href="#client-limiting-types">CLIENT LIMITING TYPES</a>
                </li>
                <li>
                  <a href="#known-issues">KNOWN ISSUES</a>
                </li>
                <li>
                  <a href="#see-also-21">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-proxy5">firehol-proxy(5)</a>
              <ul>
                <li>
                  <a href="#name-22">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-21">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-22">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-15">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-22">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-router5">firehol-router(5)</a>
              <ul>
                <li>
                  <a href="#name-23">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-22">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-23">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#parameters-1">PARAMETERS</a>
                </li>
                <li>
                  <a href="#working-with-routers">WORKING WITH ROUTERS</a>
                </li>
                <li>
                  <a href="#see-also-23">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-server5">firehol-server(5)</a>
              <ul>
                <li>
                  <a href="#name-24">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-23">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-24">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-16">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-24">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-services5">firehol-services(5)</a>
              <ul>
                <li>
                  <a href="#name-25">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-24">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-25">DESCRIPTION</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-synproxy5">firehol-synproxy(5)</a>
              <ul>
                <li>
                  <a href="#name-26">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-25">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-26">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#background">BACKGROUND</a>
                </li>
                <li>
                  <a href="#how-it-works">HOW IT WORKS</a>
                </li>
                <li>
                  <a href="#use-cases">USE CASES</a>
                </li>
                <li>
                  <a href="#design">DESIGN</a>
                </li>
                <li>
                  <a href="#limitations">LIMITATIONS</a>
                </li>
                <li>
                  <a href="#other-options">OTHER OPTIONS</a>
                </li>
                <li>
                  <a href="#synproxy-and-dynamic-ip">SYNPROXY AND DYNAMIC IP</a>
                </li>
                <li>
                  <a href="#examples-17">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-25">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-tcpmss5">firehol-tcpmss(5)</a>
              <ul>
                <li>
                  <a href="#name-27">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-26">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-27">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-18">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-26">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-tos5">firehol-tos(5)</a>
              <ul>
                <li>
                  <a href="#name-28">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-27">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-28">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#examples-19">EXAMPLES</a>
                </li>
                <li>
                  <a href="#see-also-27">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-tosfix5">firehol-tosfix(5)</a>
              <ul>
                <li>
                  <a href="#name-29">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-28">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-29">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#example-1">EXAMPLE</a>
                </li>
                <li>
                  <a href="#see-also-28">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-variables5">firehol-variables(5)</a>
              <ul>
                <li>
                  <a href="#name-30">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-29">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-30">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#variables">VARIABLES</a>
                </li>
                <li>
                  <a href="#see-also-29">SEE ALSO</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#firehol-version5">firehol-version(5)</a>
              <ul>
                <li>
                  <a href="#name-31">NAME</a>
                </li>
                <li>
                  <a href="#synopsis-30">SYNOPSIS</a>
                </li>
                <li>
                  <a href="#description-31">DESCRIPTION</a>
                </li>
                <li>
                  <a href="#see-also-30">SEE ALSO</a>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <p></p>
<!--
  This file is processed to include inline the individual pages
  single-page HTML and PDF. It is used as-is as a contents page
  for multi-page formats.
  -->
    <p>The latest version of this manual is available online as a <a href="http://firehol.org/firehol-manual.pdf">PDF</a>, as <a href="http://firehol.org/firehol-manual.html">single page HTML</a> and also as <a href="http://firehol.org/firehol-manual/">multiple pages within the website</a>.</p>
    <h1 id="firehol-reference">
      <a href="#firehol-reference">FireHOL Reference</a>
    </h1>
    <h2 id="who-should-read-this-manual">
      <a href="#who-should-read-this-manual">Who should read this manual</a>
    </h2>
    <p>This is a reference guide with specific detailed information on commands and configuration syntax for the FireHOL tool. The reference is unlikely to be suitable for newcomers to the tools, except as a means to look up more information on a particular command.</p>
    <p>For tutorials and guides to using FireHOL and FireQOS, please visit the <a href="http://firehol.org/">website</a>.</p>
    <h2 id="where-to-get-help">
      <a href="#where-to-get-help">Where to get help</a>
    </h2>
    <p>The <a href="http://firehol.org/">FireHOL website</a>.</p>
    <p>The <a href="http://lists.firehol.org/mailman/listinfo">mailing lists and archives</a>.</p>
    <p>The package comes with a complete set of manpages, a README and a brief INSTALL guide.</p>
    <h2 id="installation">
      <a href="#installation">Installation</a>
    </h2>
    <p>You can download tar-file releases by visiting the <a href="http://firehol.org/download/">FireHOL website download area</a>.</p>
    <p>Unpack and change directory with:</p>
    <pre><code>tar xfz firehol-version.tar.gz
cd firehol-version
      </code></pre>
    <p>Options for the configure program can be seen in the INSTALL file and by running:</p>
    <pre><code>./configure --help
      </code></pre>
    <p>To build and install taking the default options:</p>
    <pre><code>./configure &amp;&amp; make &amp;&amp; sudo make install
      </code></pre>
    <p>Alternatively, just copy the <code>sbin/firehol.in</code> file to where you want it. All of the common SysVInit command line arguments are recognised which makes it easy to deploy the script as a startup service.</p>
    <p>Packages are available for most distributions and you can use your distribution's standard commands (e.g. aptitude, yum, etc.) to install these.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>Distributions do not always offer the latest version. You can see what the latest release is on the <a href="http://firehol.org/">FireHOL website</a>.</p>
    </blockquote>
    <h2 id="licence">
      <a href="#licence">Licence</a>
    </h2>
    <p>This manual is licensed under the same terms as the FireHOL package, the GNU GPL v2 or later.</p>
    <p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
    <p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
    <p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</p>
    <p></p>
    <h1 id="setting-up-and-running-firehol">
      <a href="#setting-up-and-running-firehol">Setting up and running FireHOL</a>
    </h1>
    <p>FireHOL is started and stopped using the <a href="#firehol1">firehol</a> script. The default firewall configuration is to be found in <a href="#firehol.conf5">/etc/firehol/firehol.conf</a>, with some behaviours governed by variables in <a href="#firehol-variables5">/etc/firehol/firehol-defaults.conf</a>.</p>
    <h1 id="primary-commands">
      <a href="#primary-commands">Primary commands</a>
    </h1>
    <p>These are the primary packet filtering building blocks. Below each of these, sub-commands can be added.</p>
<!-- INSERT TABLE primary -->
    <table>
      <col width="20%" />
      <col width="9%" />
      <col width="15%" />
      <col width="54%" />
      <thead>
        <tr class="header">
          <th align="left">command</th>
          <th align="center">4/6/46</th>
          <th align="left">forbidden params</th>
          <th align="left">description</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-interface5">interface</a>
          </td>
          <td align="center">Y</td>
          <td align="left">inface outface physout</td>
          <td align="left">Define packet filtering blocks, protecting the firewall host itself.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-router5">router</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Define packet filtering blocks, protecting other hosts from routed traffic.</td>
        </tr>
      </tbody>
    </table>
    <h1 id="sub-commands">
      <a href="#sub-commands">Sub-commands</a>
    </h1>
    <p>A rule in an <code>interface</code> or <code>router</code> definition typically consists of a subcommand to apply to a <a href="#firehol-services5">service</a> using one of the standard <a href="#firehol-actions5">actions</a> provided it matches certain <a href="#firehol-params5">optional rule parameters</a>. e.g.</p>
    <pre class="firehol">
      <code>server ssh accept src 10.0.0.0/8</code></pre>
    <p>The following sub-commands can be used below <strong>primary commands</strong> to form rules.</p>
<!-- INSERT TABLE subcommand -->
    <table>
      <col width="20%" />
      <col width="9%" />
      <col width="15%" />
      <col width="54%" />
      <thead>
        <tr class="header">
          <th align="left">command</th>
          <th align="center">4/6/46</th>
          <th align="left">forbidden params</th>
          <th align="left">description</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-client5">client</a>
          </td>
          <td align="center">Y</td>
          <td align="left">sport dport</td>
          <td align="left">Allow access to a client running on the <code>interface</code> or the protected <code>router</code> hosts.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-group5">group</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Define groups of commands that share optional rule parameters. Groups can be nested.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-iptables5">iptables ip6tables</a>
          </td>
          <td align="center">N</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">A wrapper for the system iptables command, to add custom iptables statements to a FireHOL firewall.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-masquerade5">masquerade</a>
          </td>
          <td align="center">Y</td>
          <td align="left">inface outface</td>
          <td align="left">Change the source IP of packets leaving <code>outface</code>, with the IP of the interface they are using to leave.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-policy5">policy</a>
          </td>
          <td align="center">N</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">Define the action to be applied on packets not matched by any <code>server</code> or <code>client</code> statements in the <code>interface</code> or <code>router</code>.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-protection5">protection</a>
          </td>
          <td align="center">N</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">Examine incoming packets per <code>interface</code> or <code>router</code> and filter out bad packets or limit request frequency.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-server5">server</a>
          </td>
          <td align="center">Y</td>
          <td align="left">sport dport</td>
          <td align="left">Allow access to a server running on the <code>interface</code> or the protected <code>router</code> hosts.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-tcpmss5">tcpmss</a>
          </td>
          <td align="center">Y</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">Set the MSS (Maximum Segment Size) of TCP SYN packets routed through the firewall.</td>
        </tr>
      </tbody>
    </table>
    <h1 id="helper-commands">
      <a href="#helper-commands">Helper commands</a>
    </h1>
    <p>The following commands are generally used to set things up before the first <strong>primary command</strong>. Some can be used below an <code>interface</code> or <code>router</code> and also appear in the <a href="#sub-commands">subcommands</a> table.</p>
<!-- INSERT TABLE helper -->
    <table>
      <col width="20%" />
      <col width="9%" />
      <col width="15%" />
      <col width="54%" />
      <thead>
        <tr class="header">
          <th align="left">command</th>
          <th align="center">4/6/46</th>
          <th align="left">forbidden params</th>
          <th align="left">description</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-action5">action</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Define new actions that can differentiate the final action based on rules. <code>action</code> can be used to define traps.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-blacklist5">blacklist</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Drop matching packets globally.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-classify5">classify</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Put matching traffic into the specified traffic shaping class.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-connmark5">connmark</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Set a stateful mark from the <code>connmark</code> group.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-dscp5">dscp</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Set the DSCP field of packets.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-ipset5">ipset</a>
          </td>
          <td align="center">4/6</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">Define ipsets. A wrapper for the system ipset command to add ipsets to a FireHOL firewall.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-iptables5">iptables ip6tables</a>
          </td>
          <td align="center">N</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">A wrapper for the system iptables command, to add custom iptables statements to a FireHOL firewall.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-iptrap5">iptrap</a>
          </td>
          <td align="center">4/6</td>
          <td align="left">-</td>
          <td align="left">Dynamically put IP addresses in an ipset.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-mac5">mac</a>
          </td>
          <td align="center">Y</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">Restricts an IP to a particular MAC address.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-mark5">mark</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Set a stateful mark from the <code>usermark</code> group.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-masquerade5">masquerade</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Change the source IP of packets leaving <code>outface</code>, with the IP of the interface they are using to leave.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-nat5">dnat</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Change the destination IP or port of packets received, to fixed values or fixed ranges. <code>dnat</code> can be used to implement load balancers.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-nat5">snat</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Change the source IP or port of packets leaving, to fixed values or fixed ranges.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-nat5">redirect</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Redirect packets to the firewall host, possibly changing the destination port. Can support load balancers if multiple daemons run on localhost.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-proxy5">transparent_proxy</a>
          </td>
          <td align="center">Y</td>
          <td align="left">
            <em>see notes</em>
          </td>
          <td align="left">Set up a transparent TCP, HTTP or squid proxy.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-synproxy5">synproxy</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Configure synproxy.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-tcpmss5">tcpmss</a>
          </td>
          <td align="center">Y</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">Set the MSS (Maximum Segment Size) of TCP SYN packets routed through the firewall.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-tos5">tos</a>
          </td>
          <td align="center">Y</td>
          <td align="left">-</td>
          <td align="left">Set the Type of Service (TOS) of packets.</td>
        </tr>
        <tr class="odd">
          <td align="left">
            <a href="#firehol-tosfix5">tosfix</a>
          </td>
          <td align="center">Y</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">Apply suggested TOS values to packets.</td>
        </tr>
        <tr class="even">
          <td align="left">
            <a href="#firehol-version5">version</a>
          </td>
          <td align="center">N</td>
          <td align="left">
            <em>all forbidden</em>
          </td>
          <td align="left">Specify a version number for the configuration file.</td>
        </tr>
      </tbody>
    </table>
    <h1 id="manual-pages-in-alphabetical-order">
      <a href="#manual-pages-in-alphabetical-order">Manual Pages in Alphabetical Order</a>
    </h1>
    <h2 id="firehol1">
      <a href="#firehol1">firehol(1)</a>
    </h2>
    <h3 id="name">
      <a href="#name">NAME</a>
    </h3>
    <p>firehol - an easy to use but powerful iptables stateful firewall</p>
    <h3 id="synopsis">
      <a href="#synopsis">SYNOPSIS</a>
    </h3>
    <p>firehol</p>
    <p>sudo -E firehol panic [ <em>IP</em> ]</p>
    <p>firehol <em>command</em> [ -- <em>conf-arg</em>... ]</p>
    <p>firehol <em>CONFIGFILE</em> [start|debug|try] [-- <em>conf-arg</em>... ]</p>
    <h3 id="description">
      <a href="#description">DESCRIPTION</a>
    </h3>
    <p>Running <code>firehol</code> invokes iptables(8) to manipulate your firewall.</p>
    <p>Run without any arguments, <code>firehol</code> will present some help on usage.</p>
    <p>When given <em>CONFIGFILE</em>, <code>firehol</code> will use the named file instead of <code>/etc/firehol/firehol.conf</code> as its configuration. If no <em>command</em> is given, <code>firehol</code> assumes <code>try</code>.</p>
    <p>It is possible to pass arguments for use by the configuration file separating any conf-arg values from the rest of the arguments with <code>--</code>. The arguments are accessible in the configuration using standard bash(1) syntax e.g. $1, $2, etc.</p>
    <h4 id="panic">
      <a href="#panic">PANIC</a>
    </h4>
    <p>To block all communication, invoke <code>firehol</code> with the <code>panic</code> command.</p>
    <p>FireHOL removes all rules from the running firewall and then DROPs all traffic on all iptables(8) tables (mangle, nat, filter) and pre-defined chains (PREROUTING, INPUT, FORWARD, OUTPUT, POSTROUTING).</p>
    <p>DROPing is not done by changing the default policy to DROP, but by adding one rule per table/chain to drop all traffic. This allows systems which do not reset all the chains to ACCEPT when starting to function correctly.</p>
    <p>When activating panic mode, FireHOL checks for the existence of the SSH_CLIENT shell environment variable, which is set by ssh(1). If it finds this, then panic mode will allow the established SSH connection specified in this variable to operate.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>In order for FireHOL to see the environment variable you must ensure that it is preserved. For sudo(8) use the <code>-E</code> and for su(1) omit the <code>-</code> (minus sign).</p>
    </blockquote>
    <p>If SSH_CLIENT is not set, the <em>IP</em> after the panic argument allows you to give an IP address for which all established connections between the IP address and the host in panic will be allowed to continue.</p>
    <h3 id="commands">
      <a href="#commands">COMMANDS</a>
    </h3>
    <dl>
      <dt>start; restart</dt>
      <dd>
        <p>Activates the firewall using <code>/etc/firehol/firehol.conf</code>.</p>
        <p>Use of the term <code>restart</code> is allowed for compatibility with common init implementations.</p>
      </dd>
      <dt>try</dt>
      <dd>
        <p>Activates the firewall, waiting for the user to type the word <code>commit</code>. If this word is not typed within 30 seconds, the previous firewall is restored.</p>
      </dd>
      <dt>stop</dt>
      <dd>
        <p>Stops a running iptables(8) firewall by clearing all of the tables and chains and setting the default policies to ACCEPT. This will allow all traffic to pass unchecked.</p>
      </dd>
      <dt>condrestart</dt>
      <dd>
        <p>Restarts the FireHOL firewall only if it is already active. This is the generally expected behaviour (but opposite to FireHOL prior to 2.0.0-pre4).</p>
      </dd>
      <dt>status</dt>
      <dd>
        <p>Shows the running firewall, using <code>/sbin/iptables -nxvL | less</code>.</p>
      </dd>
      <dt>save</dt>
      <dd>
        <p>Start the firewall and then save it using iptables-save(8) to the location given by FIREHOL_AUTOSAVE. See <a href="#firehol-variables5">firehol-variables(5)</a> for more information.</p>
        <p>The required kernel modules are saved to an executable shell script <code>/var/spool/firehol/last_save_modules.sh</code>, which can be called during boot if a firewall is to be restored.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>External changes may cause a firewall restored after a reboot to not work as intended where starting the firewall with FireHOL will work.</p>
          <p>This is because as part of starting a firewall, FireHOL checks some changeable values. For instance the current kernel configuration is checked (for client port ranges), and RPC servers are queried (to allow correct functioning of the NFS service).</p>
        </blockquote>
      </dd>
      <dt><a id="debug"></a>debug</dt>
      <dd>
        <p>Parses the configuration file but instead of activating it, FireHOL shows the generated iptables(8) statements.</p>
      </dd>
      <dt><a id="explain"></a>explain</dt>
      <dd>
        <p>Enters an interactive mode where FireHOL accepts normal configuration commands and presents the generated iptables(8) commands for each of them, together with some reasoning for its purpose.</p>
        <p>Additionally, FireHOL automatically generates a configuration script based on the successful commands given.</p>
        <p>Some extra commands are available in <code>explain</code> mode.</p>
        <dl>
          <dt>help</dt>
          <dd>
            <p>Present some help</p>
          </dd>
          <dt>show</dt>
          <dd>
            <p>Present the generated configuration</p>
          </dd>
          <dt>quit</dt>
          <dd>
            <p>Exit interactive mode and quit</p>
          </dd>
        </dl>
      </dd>
      <dt><a id="helpme-wizard"></a>helpme; wizard</dt>
      <dd>
        <p>Tries to guess the FireHOL configuration needed for the current machine.</p>
        <p>FireHOL will not stop or alter the running firewall. The configuration file is given in the standard output of firehol, thus <code>firehol helpme &gt; /tmp/firehol.conf</code> will produce the output in <code>/tmp/firehol.conf</code>.</p>
        <p>The generated FireHOL configuration <em>must</em> be edited before use on your systems. You are required to take a number of decisions; the comments in the generated file will instruct you in the choices you must make.</p>
      </dd>
    </dl>
    <h3 id="files">
      <a href="#files">FILES</a>
    </h3>
    <p>
      <code>/etc/firehol/firehol.conf</code>    </p>
    <h3 id="see-also">
      <a href="#see-also">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-variables5">firehol-variables(5)</a> - control variables</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol.conf5">
      <a href="#firehol.conf5">firehol.conf(5)</a>
    </h2>
    <h3 id="name-1">
      <a href="#name-1">NAME</a>
    </h3>
    <p>firehol.conf - FireHOL configuration</p>
<!--
extra-manpage: firehol.conf.5
  -->
    <h3 id="description-1">
      <a href="#description-1">DESCRIPTION</a>
    </h3>
    <p><code>/etc/firehol/firehol.conf</code> is the default configuration file for <a href="#firehol1">firehol(1)</a>. It defines the stateful firewall that will be produced.</p>
    <p>A configuration file starts with an optional version indicator which looks like this:</p>
    <pre><code>version 6</code></pre>
    <p>See <a href="#firehol-version5">firehol-version(1)</a> for full details.</p>
    <p>A configuration file contains one or more <code>interface</code> definitions, which look like this:</p>
    <pre><code> interface eth0 lan
   client all accept # This host can access any remote service
   server ssh accept # Remote hosts can access SSH on local server
   # ...</code></pre>
    <p>The above definition has name "lan" and specifies a network interface (eth0). A definition may contain zero or more subcommands. See <a href="#firehol-interface5">firehol-interface(5)</a> for full details.</p>
    <p>By default FireHOL will try to create both IPv4 and IPv6 rules for each interface. To make this explicit or restrict which rules are created write <code>both interface</code>, <code>ipv4 interface</code> or <code>ipv6 interface</code>.</p>
    <p>Note that IPv6 will be disabled silently if your system is not configured to use it. You can test this by looking for the file <code>/proc/net/if_inet6</code>. The <a href="http://www.tldp.org/HOWTO/Linux+IPv6-HOWTO/systemcheck-kernel.html">IPv6 HOWTO</a> has more information.</p>
    <p>A configuration file contains zero or more <code>router</code> definitions, which look like this:</p>
    <pre><code>DMZ_IF=eth0
WAN_IF=eth1
router wan2dmz inface ${WAN_IF} outface ${DMZ_IF}
  route http accept  # Hosts on WAN may access HTTP on hosts in DMZ
  server ssh accept  # Hosts on WAN may access SSH on hosts in DMZ
  client pop3 accept # Hosts in DMZ may access POP3 on hosts on WAN
  # ...</code></pre>
    <p>The above definition has name "wan2dmz" and specifies incoming and outgoing network interfaces (eth1 and eth0) using variables. A definition may contain zero or more subcommands. Note that a router is not required to specify network interfaces to operate on. See <a href="#firehol-router5">firehol-router(5)</a> for full details.</p>
    <p>By default FireHOL will try to create both IPv4 and IPv6 rules for each router. To make this explicit or restrict which rules are created write <code>both router</code>, <code>ipv4 router</code> or <code>ipv6 router</code>.</p>
    <p>It is simple to add extra service definitions which can then be used in the same way as those provided as standard. See <a href="#adding-services">ADDING SERVICES</a>.</p>
    <p>The configuration file is parsed as a bash(1) script, allowing you to set up and use variables, flow control and external commands.</p>
    <p>Special control variables may be set up and used outside of any definition, see <a href="#firehol-variables5">firehol-variables(5)</a> as can the functions in <a href="#configuration-helper-commands">CONFIGURATION HELPER COMMANDS</a> and <a href="#helper-commands">HELPER COMMANDS</a>.</p>
    <h3 id="variables-available">
      <a href="#variables-available">VARIABLES AVAILABLE</a>
    </h3>
    <p>The following variables are made available in the FireHOL configuration file and can be accessed as ${<em>VARIABLE</em>}.</p>
    <dl>
      <dt>UNROUTABLE_IPS</dt>
      <dd>
        <p>This variable includes the IPs from both PRIVATE_IPS and RESERVED_IPS. It is useful to restrict traffic on interfaces and routers accepting Internet traffic, for example:</p>
        <pre><code>interface eth0 internet src not "${UNROUTABLE_IPS}"</code></pre>
      </dd>
      <dt>PRIVATE_IPS</dt>
      <dd>
        <p>This variable includes all the IP addresses defined as Private or Test by <a href="https://tools.ietf.org/html/rfc3330">RFC 3330</a>.</p>
        <p>You can override the default values by creating a file called <code>/etc/firehol/PRIVATE_IPS</code>.</p>
      </dd>
      <dt>RESERVED_IPS</dt>
      <dd>
        <p>This variable includes all the IP addresses defined by <a href="http://www.iana.org/">IANA</a> as reserved.</p>
        <p>You can override the default values by creating a file called <code>/etc/firehol/RESERVED_IPS</code>.</p>
        <p>Now that IPv4 address space has all been allocated there is very little reason that this value will need to change in future.</p>
      </dd>
      <dt>MULTICAST_IPS</dt>
      <dd>
        <p>This variable includes all the IP addresses defined as Multicast by <a href="https://tools.ietf.org/html/rfc3330">RFC 3330</a>.</p>
        <p>You can override the default values by creating a file called <code>/etc/firehol/MULTICAST_IPS</code>.</p>
      </dd>
    </dl>
    <h3 id="adding-services">
      <a href="#adding-services">ADDING SERVICES</a>
    </h3>
    <p>To define new services you add the appropriate lines before using them later in the configuration file.</p>
    <p>The following are required:</p>
    <blockquote>
      <p>server_<em>myservice</em>_ports="<em>proto</em>/<em>sports</em>"</p>
    </blockquote>
    <blockquote>
      <p>client_<em>myservice</em>_ports="<em>cports</em>"</p>
    </blockquote>
    <p><em>proto</em> is anything iptables(8) accepts e.g. "tcp", "udp", "icmp", including numeric protocol values.</p>
    <p><em>sports</em> is the ports the server is listening at. It is a space-separated list of port numbers, names and ranges (from:to). The keyword <code>any</code> will match any server port.</p>
    <p><em>cports</em> is the ports the client may use to initiate a connection. It is a space-separated list of port numbers, names and ranges (from:to). The keyword <code>any</code> will match any client port. The keyword <code>default</code> will match default client ports. For the local machine (e.g. a <code>client</code> within an <code>interface</code>) it resolves to sysctl(8) variable net.ipv4.ip_local_port_range (or <code>/proc/sys/net/ipv4/ip_local_port_range</code>). For a remote machine (e.g. a client within an interface or anything in a router) it resolves to the variable DEFAULT_CLIENT_PORTS (see <a href="#firehol-variables5">firehol-variables(5)</a>).</p>
    <p>The following are optional:</p>
    <blockquote>
      <p>require_<em>myservice</em>_modules="<em>modules</em>"</p>
    </blockquote>
    <blockquote>
      <p>require_<em>myservice</em>_nat_modules="<em>nat-modules</em>"</p>
    </blockquote>
    <p>The named kernel modules will be loaded when the definition is used. The NAT modules will only be loaded if FIREHOL_NAT is non-zero (see <a href="#firehol-variables5">firehol-variables(5)</a>).</p>
    <p>For example, for a service named <code>daftnet</code> that listens at two ports, port 1234 TCP and 1234 UDP where the expected client ports are the default random ports a system may choose, plus the same port numbers the server listens at, with further dynamic ports requiring kernel modules to be loaded:</p>
    <pre><code>    # Setup service
    server_daftnet_ports="tcp/1234 udp/1234"
    client_daftnet_ports="default 1234"
    require_daftnet_modules="ip_conntrack_daftnet"
    require_daftnet_nat_modules="ip_nat_daftnet
    
    interface eth0 lan0
      server daftnet accept
     
    interface eth1 lan1
      client daftnet reject
    
    router lan2lan inface eth0 outface eth1
      route daftnet accept</code></pre>
    <p>Where multiple ports are provides (as per the example), FireHOL simply determines all of the combinations of client and server ports and generates multiple iptables(8) statements to match them.</p>
    <p>To create more complex rules, or stateless rules, you will need to create a bash function prefixed <code>rules_</code> e.g. <code>rules_myservice</code>. The best reference is the many such functions in the main firehol(1) script.</p>
    <p>When adding a service which uses modules, or via a custom function, you may also wish to include the following:</p>
    <blockquote>
      <p>ALL_SHOULD_ALSO_RUN="${ALL_SHOULD_ALSO_RUN} <em>myservice</em>"</p>
    </blockquote>
    <p>which will ensure your service is set-up correctly as part of the <code>all</code> service.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>To allow definitions to be shared you can instead create files and install them in the <code>/etc/firehol/services</code> directory with a <code>.conf</code> extension.</p>
      <p>The first line must read:</p>
      <pre><code>#FHVER: 1:213</code></pre>
      <p>1 is the service definition API version. It will be changed if the API is ever modified. The 213 originally referred to a FireHOL 1.x minor version but is no longer checked.</p>
      <p>FireHOL will refuse to run if the API version does not match the expected one.</p>
    </blockquote>
    <h3 id="definitions">
      <a href="#definitions">DEFINITIONS</a>
    </h3>
    <ul>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
    </ul>
    <h3 id="subcommands">
      <a href="#subcommands">SUBCOMMANDS</a>
    </h3>
    <ul>
      <li><a href="#firehol-policy5">firehol-policy(5)</a> - policy command</li>
      <li><a href="#firehol-protection5">firehol-protection(5)</a> - protection command</li>
      <li><a href="#firehol-server5">firehol-server(5)</a> - server, route commands</li>
      <li><a href="#firehol-client5">firehol-client(5)</a> - client command</li>
      <li><a href="#firehol-group5">firehol-group(5)</a> - group command</li>
    </ul>
    <h3 id="helper-commands-1">
      <a href="#helper-commands-1">HELPER COMMANDS</a>
    </h3>
    <p>These helpers can be used in <code>interface</code> and <code>router</code> definitions as well as before them:</p>
    <ul>
      <li><a href="#firehol-iptables5">firehol-iptables(5)</a> - iptables helper</li>
      <li><a href="#firehol-masquerade5">firehol-masquerade(5)</a> - masquerade helper</li>
    </ul>
    <p>This helper can be used in <code>router</code> definitions as well as before any <code>router</code> or <code>interface</code>:</p>
    <ul>
      <li><a href="#firehol-tcpmss5">firehol-tcpmss(5)</a> - tcpmss helper</li>
    </ul>
    <h3 id="configuration-helper-commands">
      <a href="#configuration-helper-commands">CONFIGURATION HELPER COMMANDS</a>
    </h3>
    <p>These helpers should only be used outside of <code>interface</code> and <code>router</code> definitions (i.e. before the first interface is defined).</p>
    <ul>
      <li><a href="#firehol-version5">firehol-version(5)</a> - version config helper</li>
      <li><a href="#firehol-action5">firehol-action(5)</a> - action config helper</li>
      <li><a href="#firehol-blacklist5">firehol-blacklist(5)</a> - blacklist config helper</li>
      <li><a href="#firehol-classify5">firehol-classify(5)</a> - classify config helper</li>
      <li><a href="#firehol-connmark5">firehol-connmark(5)</a> - connmark config helper</li>
      <li><a href="#firehol-dscp5">firehol-dscp(5)</a> - dscp config helper</li>
      <li><a href="#firehol-mac5">firehol-mac(5)</a> - mac config helper</li>
      <li><a href="#firehol-mark5">firehol-mark(5)</a> - mark config helper</li>
      <li><a href="#firehol-nat5">firehol-nat(5)</a> - nat, snat, dnat, redirect helpers</li>
      <li><a href="#firehol-proxy5">firehol-proxy(5)</a> - transparent proxy/squid helpers</li>
      <li><a href="#firehol-tos5">firehol-tos(5)</a> - tos config helper</li>
      <li><a href="#firehol-tosfix5">firehol-tosfix(5)</a> - tosfix config helper</li>
    </ul>
    <h3 id="see-also-1">
      <a href="#see-also-1">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol-variables5">firehol-variables(5)</a> - control variables</li>
      <li><a href="#firehol-services5">firehol-services(5)</a> - services list</li>
      <li><a href="#firehol-actions5">firehol-actions(5)</a> - actions for rules</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-action5">
      <a href="#firehol-action5">firehol-action(5)</a>
    </h2>
    <h3 id="name-2">
      <a href="#name-2">NAME</a>
    </h3>
    <p>firehol-action - set up custom filtering actions</p>
    <h3 id="synopsis-1">
      <a href="#synopsis-1">SYNOPSIS</a>
    </h3>
    <p>action <em>name</em> [table <em>table_name</em>] <em>type</em> <em>type_params</em> [ next [ type <em>type_params</em> [ next ... ] ] ]</p>
<!--
contents-table:helper:action:keyword-firehol-action:Y:-:Define new actions that can differentiate the final action based on rules. `action` can be used to define traps.
  -->
    <h3 id="description-2">
      <a href="#description-2">DESCRIPTION</a>
    </h3>
    <p>The <code>action</code> helper creates custom actions that can be used everywhere in FireHOL, like this:</p>
    <pre><code>action ACT1 chain accept

interface any world
    server smtp ACT1

router myrouter
    policy ACT1</code></pre>
    <p>The <code>action</code> helper allows linking multiple actions together and having some logic to select which action to execute, like this:</p>
    <pre><code>action ACT1 \
         rule src 192.168.0.0/16 action reject \
    next rule dst 192.168.0.0/16 action reject \
    next rule inface eth2 action drop \
    next rule outface eth2 action drop \
    next action accept

interface any world
    server smtp ACT1

router myrouter
    policy ACT1</code></pre>
    <p>There is no limit on the number of actions that can be linked together.</p>
    <p><code>type</code> can be <code>chain</code> or <code>action</code> (<code>chain</code> and <code>action</code> are aliases), <code>rule</code>, <code>iptrap</code>, <code>ipuntrap</code> or <code>sockets_suspects_trap</code>.</p>
    <h4 id="chain-type-actions">
      <a href="#chain-type-actions">Chain type actions</a>
    </h4>
    <p>This is the simpler action. It creates an iptables(8) chain which can be used to control the action of other firewall rules once the firewall is running.</p>
    <p>For example, you can setup the custom action ACT1, which by default is ACCEPT, but can be dynamically changed to DROP, REJECT or RETURN (and back) without restarting the firewall.</p>
    <p>The <em>name</em> can be any chain name accepted by iptables. You should try to keep it within 5 and 10 characters.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>The <em>name</em>s created with this command are case-sensitive.</p>
    </blockquote>
    <p>The <em>action</em> can be any of those supported by FireHOL (see <a href="#firehol-actions5">firehol-actions(5)</a>). Only ACCEPT, REJECT, DROP, RETURN have any meaning in this instance.</p>
    <p>Once the firewall is running you can dynamically modify the behaviour of the chain from the Linux command-line, as detailed below:</p>
    <pre><code>action ACT1 chain accept

interface any world
    server smtp ACT1
    client smtp ACT1</code></pre>
    <p>To insert a DROP action at the start of the chain to override the default action (ACCEPT):</p>
    <pre><code>iptables -t filter -I ACT1 -j DROP</code></pre>
    <p>To delete the DROP action from the start of the chain to return to the default action:</p>
    <pre><code>iptables -t filter -D ACT1 -j DROP</code></pre>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>If you delete all of the rules in the chain, the default will be to RETURN, in which case the behaviour will be as if any rules with the action were not present in the configuration file.</p>
    </blockquote>
    <h4 id="rule-type-actions">
      <a href="#rule-type-actions">Rule type actions</a>
    </h4>
    <p><code>rule</code> type actions define a few conditions that will lead to an action.</p>
    <p>All optional rule parameters FireHOL supports can be used here (see <a href="#firehol-params5">firehol-params(5)</a>).</p>
    <pre><code>action ACT1 \
    rule inface eth0 action accept
    next rule outface eth0 action accept
    next action reject

interface any world
    server smtp ACT1</code></pre>
    <p>In the above example the smtp server can only be accessed from eth0.</p>
    <p>It is important to remember that actions will be applied for all the traffic, both requests and replies. The type of traffic can be filtered with the <code>state</code> optional rule parameter, like this:</p>
    <pre><code>action ACT1 \
    rule inface eth0 state NEW action reject
    next action accept

interface any world
    server smtp ACT1
    client smtp ACT1</code></pre>
    <p>In the above example, the smtp server will not accept NEW connections from eth0, but the smtp client will be able to connect to servers on eth0 (and everywhere else).</p>
    <h4 id="iptrap-type-actions">
      <a href="#iptrap-type-actions">iptrap type actions</a>
    </h4>
    <p><code>iptrap</code> (see <a href="#firehol-iptrap5">firehol-iptrap(5)</a>) is a helper than copies (traps) an IP to an ipset (see <a href="#firehol-ipset5">firehol-ipset(5)</a>). It does not perform any action on the traffic.</p>
    <p>Using the <code>iptrap</code> action, the <code>iptrap</code> helper can be linked to filtering actions, like this:</p>
    <pre><code> # a simple version of TRAP_AND_REJECT
 # this uses just 2 ipsets, one for counting packets (policytrap)
 # and one to store the banned IPs (trap).
 # it also needs a ipset called whitelist, for excluded source IPs.
 # it will ban IPs when they have 50+ reject packets
 action4 TRAP_AND_REJECT \
    rule iptrap src policytrap 30 inface "${wan}" \
        src not "${UNROUTABLE_IPS} ipset:whitelist" \
        state NEW log "POLICY TRAP" \
    next iptrap trap src 86400 \
        state NEW log "POLICY TRAP - BANNED" \
        ipset policytrap src no-counters packets-above 50 \
    next action reject

 # a complete TRAP_AND_REJECT
 # this uses 3 ipset, one for keeping track of the rejected sockets
 # per source IP (called 'sockets'), one for counting the sockets
 # per source IP (called 'suspects') and one to store the banned IPs
 # (called 'trap').
 # it also needs a ipset called whitelist, for excluded source IPs.
 # it will ban IPs when they have 3 or more rejected sockets
 action4 TRAP_AND_REJECT \
    iptrap sockets src,dst,dst 3600 method hash:ip,port,ip counters \
        state NEW log "TRAP AND REJECT - NEW SOCKET" \
        inface "${wan}" \
        src not "${UNROUTABLE_IPS} ipset:whitelist" \
    next iptrap suspects src 3600 counters \
        state NEW log "TRAP AND REJECT - NEW SUSPECT" \
        ipset sockets src,dst,dst no-counters packets 1 \
    next iptrap trap src 86400 \
        state NEW log "TRAP AND REJECT - BANNED" \
        ipset suspects src no-counters packets-above 2 \
    next action REJECT

 interface any world
    policy TRAP_AND_REJECT
    protection bad-packets
    ...

 router wan2lan inface "${wan}" outface "${lan}"
    policy TRAP_AND_REJECT
    protection bad-packets
    ...</code></pre>
    <p>Since we used the action TRAP_AND_REJECT as an interface policy, it will get all the traffic not accepted, rejected, or dropped by the server and client statements.</p>
    <p>For all these packets, the action TRAP_AND_REJECT will first check that they are coming in from wan0, that their src IP is not in <code>UNROUTABLE_IPS</code> list and in the <code>whitelist</code> ipset, that they are NEW connections, and if all these conditions are met, it will log with the tag <code>POLICY TRAP</code> and add the src IP of the packets in the <code>policytrap</code> ipset for 30 seconds.</p>
    <p>All traffic not matched by the above, will be just rejected.</p>
    <h4 id="sockets_suspects_trap-type-actions">
      <a href="#sockets_suspects_trap-type-actions">sockets_suspects_trap type actions</a>
    </h4>
    <p>The type <code>sockets_suspects_trap</code> will automatically a custom trap using the following template:</p>
    <pre><code>action4 *name* sockets_suspects_trap *SUSPECTS_TIMEOUT* *TRAP_TIMEOUT* *VALID_CONNECTIONS* [*optional params*] next ...</code></pre>
    <p>This will:</p>
    <ol style="list-style-type: decimal">
      <li>Create the ipset <code>${name}_sockets</code> where the matched sockets will be stored for <code>SUSPECTS_TIMEOUT</code> seconds.</li>
      <li>Create the ipset <code>${name}_suspects</code> where the source IPs of the matched sockets will be stored for <code>SUSPECTS_TIMEOUT</code> seconds.</li>
      <li>Create the ipset <code>${name}_trap</code> where the trapped IPs will be stored for <code>TRAP_TIMEOUT</code> seconds. IPs will be added to this ipset only if more than <code>VALID_CONNECTIONS</code> have been matched by this IP.</li>
    </ol>
    <p><code>optional params</code> are FireHOL optional rule parameters (<a href="#firehol-params5">firehol-params(5)</a>) that can be used to limit the match for the first ipset (sockets).</p>
    <p>So, to design the same TRAP_AND_REJECT as above, this statement is needed:</p>
    <pre><code>action4 TRAP_AND_REJECT \
    sockets_suspects_trap 3600 86400 2 \
        inface "${wan}" \
        src not "${UNROUTABLE_IPS} ipset:whitelist" \
    next action REJECT</code></pre>
    <p>The ipsets that will be created will be named: <code>TRAP_AND_REJECT_sockets</code>, <code>TRAP_AND_REJECT_suspects</code> and <code>TRAP_AND_REJECT_trap</code>.</p>
    <blockquote>
      <p><strong>Note</strong> Always terminate <code>sockets_suspects_trap</code> with a <code>next action DROP</code> or <code>next action REJECT</code>, or the traffic will continue to flow.</p>
    </blockquote>
    <h3 id="see-also-2">
      <a href="#see-also-2">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-actions5">firehol-actions(5)</a> - optional rule parameters</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-actions5">
      <a href="#firehol-actions5">firehol-actions(5)</a>
    </h2>
    <h3 id="name-3">
      <a href="#name-3">NAME</a>
    </h3>
    <p>firehol-actions - actions for rules</p>
<!--
extra-manpage: firehol-accept.5
extra-manpage: firehol-reject.5
extra-manpage: firehol-drop.5
extra-manpage: firehol-deny.5
extra-manpage: firehol-return.5
extra-manpage: firehol-tarpit.5
-->
    <h3 id="synopsis-2">
      <a href="#synopsis-2">SYNOPSIS</a>
    </h3>
    <p>accept</p>
    <p>accept with hashlimit <em>name</em> upto|above <em>amount/period</em> [burst <em>amount</em>] [mode <em>{srcip|srcport|dstip|dstport},...</em>] [srcmask <em>prefix</em>] [dstmask <em>prefix</em>] [htable-size <em>buckets</em>] [htable-max <em>entries</em>] [htable-expire <em>msec</em>] [htable-gcinterval <em>msec</em>]</p>
    <p>accept with connlimit upto|above <em>limit</em> [mask <em>mask</em>] [saddr|daddr]</p>
    <p>accept with limit <em>requests/period burst</em> [overflow <em>action</em>]</p>
    <p>accept with recent <em>name</em> <em>seconds</em> <em>hits</em></p>
    <p>accept with knock <em>name</em></p>
    <p>reject [with <em>message</em>]</p>
    <p>drop | deny</p>
    <p>return</p>
    <p>tarpit</p>
    <h3 id="description-3">
      <a href="#description-3">DESCRIPTION</a>
    </h3>
    <p>These actions are the actions to be taken on traffic that has been matched by a particular rule.</p>
    <p>FireHOL will also pass through any actions that iptables(8) accepts, however these definitions provide lowercase versions which accept arguments where appropriate and which could otherwise not be passed through.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>The iptables(8) LOG action is best used through the optional rule parameter <code>log</code> since the latter can be combined with one of these actions (FireHOL will generate multiple firewall rules to make this happen). For more information see <a href="#log-loglimit">log</a> and <a href="#log-loglimit">loglimit</a>.</p>
    </blockquote>
    <p>The following actions are defined:</p>
    <h4 id="accept">
      <a href="#accept">accept</a>
    </h4>
    <p><code>accept</code> allows the traffic matching the rules to reach its destination.</p>
    <p>For example, to allow SMTP requests and their replies to flow:</p>
    <pre><code>server smtp accept
                </code></pre>
    <h4 id="accept-with-hashlimit-name-uptoabove-amountperiod-burst-amount-mode-srcipsrcportdstipdstport...-srcmask-prefix-dstmask-prefix-htable-size-buckets-htable-max-entries-htable-expire-msec-htable-gcinterval-msec">
      <a href="#accept-with-hashlimit-name-uptoabove-amountperiod-burst-amount-mode-srcipsrcportdstipdstport...-srcmask-prefix-dstmask-prefix-htable-size-buckets-htable-max-entries-htable-expire-msec-htable-gcinterval-msec">accept with hashlimit <em>name</em> upto|above <em>amount/period</em> [burst <em>amount</em>] [mode <em>{srcip|srcport|dstip|dstport},...</em>] [srcmask <em>prefix</em>] [dstmask <em>prefix</em>] [htable-size <em>buckets</em>] [htable-max <em>entries</em>] [htable-expire <em>msec</em>] [htable-gcinterval <em>msec</em>]</a>
    </h4>
    <p><code>hashlimit</code> hashlimit uses hash buckets to express a rate limiting match (like the limit match) for a group of connections using a single iptables rule. Grouping can be done per-hostgroup (source and/or destination address) and/or per-port.</p>
    <p><em>name</em> The name for the /proc/net/ipt_hashlimit/<em>name</em> entry.</p>
    <p><code>upto</code><em>amount[/second|/minute|/hour|/day]</em> Match if the rate is below or equal to amount/quantum. It is specified either as a number, with an optional time quantum suffix (the default is 3/hour).</p>
    <p><code>above</code><em>amount[/second|/minute|/hour|/day]</em> Match if the rate is above amount/quantum.</p>
    <p><code>burst</code><em>amount</em> Maximum initial number of packets to match: this number gets recharged by one every time the limit specified above is not reached, up to this number; the default is 5. This option should be used with caution - if the entry expires, the burst value is reset too.</p>
    <p><code>mode</code><em>{srcip|srcport|dstip|dstport},...</em> A comma-separated list of objects to take into consideration. If no <code>mode</code> option is given, <em>srcip,dstport</em> is assumed.</p>
    <p><code>srcmask</code><em>prefix</em> When --hashlimit-mode srcip is used, all source addresses encountered will be grouped according to the given prefix length and the so-created subnet will be subject to hashlimit. prefix must be between (inclusive) 0 and 32. Note that <code>srcmask</code> <em>0</em> is basically doing the same thing as not specifying srcip for <code>mode</code>, but is technically more expensive.</p>
    <p><code>dstmask</code><em>prefix</em> Like <code>srcmask</code>, but for destination addresses.</p>
    <p><code>htable-size</code><em>buckets</em> The number of buckets of the hash table</p>
    <p><code>htable-max</code><em>entries</em> Maximum entries in the hash.</p>
    <p><code>htable-expire</code><em>msec</em> After how many milliseconds do hash entries expire.</p>
    <p><code>htable-gcinterval</code><em>msec</em> How many milliseconds between garbage collection intervals.</p>
    <p>Examples:</p>
    <p>Allow up to 5 connections per second per client to SMTP server:</p>
    <pre><code>server smtp accept with hashlimit smtplimit upto 5/s</code></pre>
    <p>You can monitor it using the file /proc/net/ipt_hashlimit/smtplimit</p>
    <h4 id="accept-with-connlimit-uptoabove-limit-mask-mask-saddrdaddr">
      <a href="#accept-with-connlimit-uptoabove-limit-mask-mask-saddrdaddr">accept with connlimit upto|above <em>limit</em> [mask <em>mask</em>] [saddr|daddr]</a>
    </h4>
    <p><code>accept with connlimit</code> matches on the number of connections per IP.</p>
    <p><em>saddr</em> matches on source IP. <em>daddr</em> matches on destination IP. <em>mask</em> groups IPs with the <em>mask</em> given <em>upto</em> matches when the number of connections is up to the given <em>limit</em> <em>above</em> matches when the number of connections above to the given <em>limit</em></p>
    <p>The number of connections counted are system wide, not service specific. For example for <em>saddr</em>, you cannot connlimit 2 connections for SSH and 4 for SMTP. If you connlimit 2 connections for SSH, then the first 2 connections of a client can be SSH. If a client has already 2 connections to another service, the client will not be able to connect to SSH.</p>
    <p>So, <code>connlimit</code> can safely be used:</p>
    <ul>
      <li>with <em>daddr</em> to limit the connections a server can accept</li>
      <li>with <em>saddr</em> to limit the total connections per client to all services.</li>
    </ul>
    <h4 id="accept-with-limit-requestsperiod-burst-overflow-action">
      <a href="#accept-with-limit-requestsperiod-burst-overflow-action">accept with limit <em>requests/period burst</em> [overflow <em>action</em>]</a>
    </h4>
    <p><code>accept with limit</code> allows the traffic, with new connections limited to <em>requests/period</em> with a maximum <em>burst</em>. Run <code>iptables -m limit --help</code> for more information.</p>
    <p>The default <code>overflow</code> <em>action</em> is to REJECT the excess connections (DROP would produce timeouts on otherwise valid service clients).</p>
    <p>Examples:</p>
    <pre><code>
server smtp accept with limit 10/sec 100

server smtp accept with limit 10/sec 100 overflow drop</code></pre>
    <h4 id="accept-with-recent-name-seconds-hits">
      <a href="#accept-with-recent-name-seconds-hits">accept with recent <em>name</em> <em>seconds</em> <em>hits</em></a>
    </h4>
    <p><code>accept with recent</code> allows the traffic matching the rules to reach its destination, limited per remote IP to <em>hits</em> per <em>seconds</em>. Run <code>iptables -m recent --help</code> for more information.</p>
    <p>The <em>name</em> parameter is used to allow multiple rules to share the same table of recent IPs.</p>
    <p>For example, to allow only 2 connections every 60 seconds per remote IP, to the smtp server:</p>
    <pre><code>server smtp accept with recent mail 60 2
              </code></pre>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>When a new connection is not allowed, the traffic will continue to be matched by the rest of the firewall. In other words, if the traffic is not allowed due to the limitations set here, it is not dropped, it is just not matched by this rule.</p>
    </blockquote>
    <h4 id="accept-with-knock-name">
      <a href="#accept-with-knock-name">accept with knock <em>name</em></a>
    </h4>
    <p><code>accept with knock</code> allows easy integration with <a href="http://www.zeroflux.org/projects/knock/">knockd</a>, a server that allows you to control access to services by sending certain packets to "knock" on the door, before the door is opened for service.</p>
    <p>The <em>name</em> is used to build a special chain knock_&lt;<code>name</code>&gt; which contains rules to allow established connections to work. If knockd has not allowed new connections any traffic entering this chain will just return back and continue to match against the other rules until the end of the firewall.</p>
    <p>For example, to allow HTTPS requests based on a knock write:</p>
    <pre><code>server https accept with knock hidden
                </code></pre>
    <p>then configure knockd to enable the HTTPS service with:</p>
    <pre><code>iptables -A knock_hidden -s %IP% -j ACCEPT
                </code></pre>
    <p>and disable it with:</p>
    <pre><code>iptables -D knock_hidden -s %IP% -j ACCEPT
                </code></pre>
    <p>You can use the same knock <em>name</em> in more than one FireHOL rule to enable/disable all the services based on a single knockd configuration entry.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>There is no need to match anything other than the IP in knockd. FireHOL already matches everything else needed for its rules to work.</p>
    </blockquote>
    <h4 id="reject">
      <a href="#reject">reject</a>
    </h4>
    <p><code>reject</code> discards the traffic matching the rules and sends a rejecting message back to the sender.</p>
    <h4 id="reject-with-message">
      <a href="#reject-with-message">reject with <em>message</em></a>
    </h4>
    <p>When used with <code>with</code> the specific message to return can be specified. Run <code>iptables -j REJECT --help</code> for a list of the <code>--reject-with</code> values which can be used for <em>message</em>. See <a href="#reject-with-messages">REJECT WITH MESSAGES</a> for some examples.</p>
    <p>The default (no <em>message</em> specified) is to send <code>tcp-reset</code> when dealing with TCP connections and <code>icmp-port-unreachable</code> for all other protocols.</p>
    <p>For example:</p>
    <pre><code>
UNMATCHED_INPUT_POLICY="reject with host-prohib"

policy reject with host-unreach

server ident reject with tcp-reset</code></pre>
    <h4 id="drop-deny">
      <a href="#drop-deny">drop; deny</a>
    </h4>
    <p><code>drop</code> discards the traffic matching the rules. It does so silently and the sender will need to timeout to conclude it cannot reach the service.</p>
    <p><code>deny</code> is a synonym for <code>drop</code>. For example, either of these would silently discard SMTP traffic:</p>
    <pre><code>server smtp drop

server smtp deny</code></pre>
    <h4 id="return">
      <a href="#return">return</a>
    </h4>
    <p><code>return</code> will return the flow of processing to the parent of the current command.</p>
    <p>Currently, the only time <code>return</code> can be used meaningfully used is as a policy for an interface definition. Unmatched traffic will continue being processed with the possibility of being matched by a later definition. For example:</p>
    <pre><code>policy return
              </code></pre>
    <h4 id="tarpit">
      <a href="#tarpit">tarpit</a>
    </h4>
    <p><code>tarpit</code> captures and holds incoming TCP connections open.</p>
    <p>Connections are accepted and immediately switched to the persist state (0 byte window), in which the remote side stops sending data and asks to continue every 60-240 seconds.</p>
    <p>Attempts to close the connection are ignored, forcing the remote side to time out the connection after 12-24 minutes.</p>
    <p>Example:</p>
    <pre><code>server smtp tarpit</code></pre>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>As the kernel conntrack modules are always loaded by FireHOL, some per-connection resources will be consumed. See this <a href="http://bugs.sanewall.org/sanewall/issues/10">bug report</a> for details.</p>
    </blockquote>
    <p>The following actions also exist but should not be used under normal circumstances:</p>
    <h4 id="mirror">
      <a href="#mirror">mirror</a>
    </h4>
    <p><code>mirror</code> returns the traffic it receives by switching the source and destination fields. REJECT will be used for traffic generated by the local host.</p>
    <blockquote>
      <p>
        <strong>Warning</strong>
      </p>
      <p>The MIRROR target was removed from the Linux kernel due to its security implications.</p>
      <p>MIRROR is dangerous; use it with care and only if you understand what you are doing.</p>
    </blockquote>
    <h4 id="redirect-redirect-to-port-port">
      <a href="#redirect-redirect-to-port-port">redirect; redirect to-port port</a>
    </h4>
    <p><code>redirect</code> is used internally by FireHOL helper commands.</p>
    <p>Only FireHOL developers should need to use this action directly.</p>
    <h3 id="reject-with-messages">
      <a href="#reject-with-messages">REJECT WITH MESSAGES</a>
    </h3>
    <p>The following RFCs contain information relevant to these messages:</p>
    <ul>
      <li>
        <a href="http://www.ietf.org/rfc/rfc1812.txt">RFC 1812</a>
      </li>
      <li>
        <a href="http://www.ietf.org/rfc/rfc1122.txt">RFC 1122</a>
      </li>
      <li>
        <a href="http://www.ietf.org/rfc/rfc0792.txt">RFC 792</a>
      </li>
    </ul>
    <dl>
      <dt>icmp-net-unreachable; net-unreach</dt>
      <dd>
        <p>ICMP network unreachable</p>
        <p>Generated by a router if a forwarding path (route) to the destination network is not available.</p>
        <p>From RFC 1812, section 5.2.7.1. See RFC 1812 and RFC 792.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>Use with care. The sender and the routers between you and the sender may conclude that the whole network your host resides in is unreachable, and prevent other traffic from reaching you.</p>
        </blockquote>
      </dd>
      <dt>icmp-host-unreachable; host-unreach</dt>
      <dd>
        <p>ICMP host unreachable</p>
        <p>Generated by a router if a forwarding path (route) to the destination host on a directly connected network is not available (does not respond to ARP).</p>
        <p>From RFC 1812, section 5.2.7.1. See RFC 1812 and RFC 792.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>Use with care. The sender and the routers between you and the sender may conclude that your host is entirely unreachable, and prevent other traffic from reaching you.</p>
        </blockquote>
      </dd>
      <dt>icmp-proto-unreachable; proto-unreach</dt>
      <dd>
        <p>ICMP protocol unreachable</p>
        <p>Generated if the transport protocol designated in a datagram is not supported in the transport layer of the final destination.</p>
        <p>From RFC 1812, section 5.2.7.1. See RFC 1812 and RFC 792.</p>
      </dd>
      <dt>icmp-port-unreachable; port-unreach</dt>
      <dd>
        <p>ICMP port unreachable</p>
        <p>Generated if the designated transport protocol (e.g. TCP, UDP, etc.) is unable to demultiplex the datagram in the transport layer of the final destination but has no protocol mechanism to inform the sender.</p>
        <p>From RFC 1812, section 5.2.7.1. See RFC 1812 and RFC 792.</p>
        <p>Generated by hosts to indicate that the required port is not active.</p>
      </dd>
      <dt>icmp-net-prohibited; net-prohib</dt>
      <dd>
        <p>ICMP communication with destination network administratively prohibited</p>
        <p>This code was intended for use by end-to-end encryption devices used by U.S. military agencies. Routers SHOULD use the newly defined Code 13 (Communication Administratively Prohibited) if they administratively filter packets.</p>
        <p>From RFC 1812, section 5.2.7.1. See RFC 1812 and RFC 1122.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>This message may not be widely understood.</p>
        </blockquote>
      </dd>
      <dt>icmp-host-prohibited; host-prohib</dt>
      <dd>
        <p>ICMP communication with destination host administratively prohibited</p>
        <p>This code was intended for use by end-to-end encryption devices used by U.S. military agencies. Routers SHOULD use the newly defined Code 13 (Communication Administratively Prohibited) if they administratively filter packets.</p>
        <p>From RFC 1812, section 5.2.7.1. See RFC 1812 and RFC 1122.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>This message may not be widely understood.</p>
        </blockquote>
      </dd>
      <dt>tcp-reset</dt>
      <dd>
        <p>TCP RST</p>
        <p>The port unreachable message of the TCP stack.</p>
        <p>See RFC 1122.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p><code>tcp-reset</code> is useful when you want to prevent timeouts on rejected TCP services where the client incorrectly ignores ICMP port unreachable messages.</p>
        </blockquote>
      </dd>
    </dl>
    <h3 id="see-also-3">
      <a href="#see-also-3">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-blacklist5">
      <a href="#firehol-blacklist5">firehol-blacklist(5)</a>
    </h2>
    <h3 id="name-4">
      <a href="#name-4">NAME</a>
    </h3>
    <p>firehol-blacklist - set up a unidirectional or bidirectional blacklist</p>
<!--
contents-table:helper:blacklist:keyword-firehol-blacklist:Y:-:Drop matching packets globally.
  -->
    <h3 id="synopsis-3">
      <a href="#synopsis-3">SYNOPSIS</a>
    </h3>
    <p>{ blacklist | blacklist4 | blacklist6 } [ <em>type</em> ] [ inface <em>device</em> ] [ log <em>"text"</em> ] [ loglimit <em>"text"</em> ] [ accounting <em>accounting_name</em> ] <em>ip</em>... [ except <em>rule-params</em> ]</p>
    <h3 id="description-4">
      <a href="#description-4">DESCRIPTION</a>
    </h3>
    <p>The <code>blacklist</code> helper command creates a blacklist for the <em>ip</em> list given (which can be in quotes or not).</p>
    <p>If the type <code>full</code> or <code>all</code> is supplied (or no type at all), a bidirectional stateless blacklist will be generated. The firewall will REJECT all traffic going to the IP addresses and DROP all traffic coming from them.</p>
    <p>If the type <code>input</code> or <code>him</code>, <code>her</code>, <code>it</code>, <code>this</code>, <code>these</code> is supplied, a unidirectional stateful blacklist will be generated. Connections can be established to such IP addresses, but the IP addresses will not be able to connect to the firewall or hosts protected by it.</p>
    <p>Using <code>log</code> or <code>loglimit</code>, the <code>text</code> will be logged when matching packets are found.</p>
    <p>Using <code>inface</code>, the blacklist will be created on the interface <code>device</code> only (this includes forwarded traffic).</p>
    <p><code>accounting</code> will update the NFACCT accounting with the name given.</p>
    <p>If the keyword <code>except</code> is found, then all the parameters following it are rules to match packets that should excluded from the blacklist (i.e. they are a whitelist for this blacklist). See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <p>Blacklists must be declared before the first router or interface.</p>
    <p>IP Lists for abuse, malware, attacks, proxies, anonymizers, etc can be downloaded with the contrib/update-ipsets.sh script. Information about the supported IP Lists can be found at <a href="http://iplists.firehol.org/">FireHOL IP Lists</a></p>
    <h3 id="examples">
      <a href="#examples">EXAMPLES</a>
    </h3>
    <pre><code>blacklist full 192.0.2.1 192.0.2.2
blacklist input "192.0.2.3 192.0.2.4"
blacklist full inface eth0 log "BADGUY" 192.0.1.1 192.0.1.2</code></pre>
    <h3 id="see-also-4">
      <a href="#see-also-4">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="http://iplists.firehol.org/">FireHOL IP Lists</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-classify5">
      <a href="#firehol-classify5">firehol-classify(5)</a>
    </h2>
    <h3 id="name-5">
      <a href="#name-5">NAME</a>
    </h3>
    <p>firehol-classify - classify traffic for traffic shaping tools</p>
<!--
contents-table:helper:classify:keyword-firehol-classify:Y:-:Put matching traffic into the specified traffic shaping class.
  -->
    <h3 id="synopsis-4">
      <a href="#synopsis-4">SYNOPSIS</a>
    </h3>
    <p>{ classify | classify46 } <em>class</em> [<em>rule-params</em>]</p>
    <p>classify4 <em>class</em> [<em>rule-params</em>]</p>
    <p>classify6 <em>class</em> [<em>rule-params</em>]</p>
    <h3 id="description-5">
      <a href="#description-5">DESCRIPTION</a>
    </h3>
    <p>The <code>classify</code> helper command puts matching traffic into the specified traffic shaping class.</p>
    <p>The <em>class</em> is a class as used by iptables(8) and tc(8) (e.g. MAJOR:MINOR).</p>
    <p>The <em>rule-params</em> define a set of rule parameters to match the traffic that is to be classified. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <p>Any classify commands will affect all traffic matched. They must be declared before the first router or interface.</p>
    <h3 id="examples-1">
      <a href="#examples-1">EXAMPLES</a>
    </h3>
    <pre><code> # Put all smtp traffic leaving via eth1 in class 1:1
 classify 1:1 outface eth1 proto tcp dport 25</code></pre>
    <h3 id="see-also-5">
      <a href="#see-also-5">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>tc(8) - show / manipulate traffic control settings</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="http://lartc.org/howto/">Linux Advanced Routing &amp; Traffic Control HOWTO</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-client5">
      <a href="#firehol-client5">firehol-client(5)</a>
    </h2>
    <h3 id="name-6">
      <a href="#name-6">NAME</a>
    </h3>
    <p>firehol-client - client command</p>
<!--
contents-table:subcommand:client:keyword-firehol-client:Y:sport dport:Allow access to a client running on the `interface` or the protected `router` hosts.
  -->
    <h3 id="synopsis-5">
      <a href="#synopsis-5">SYNOPSIS</a>
    </h3>
    <p>{ client | client46 } <em>service</em> <em>action</em> [<em>rule-params</em>]</p>
    <p>client4 <em>service</em> <em>action</em> [<em>rule-params</em>]</p>
    <p>client6 <em>service</em> <em>action</em> [<em>rule-params</em>]</p>
<!--
extra-manpage: firehol-client46.5
extra-manpage: firehol-client4.5
extra-manpage: firehol-client6.5
  -->
    <h3 id="description-6">
      <a href="#description-6">DESCRIPTION</a>
    </h3>
    <p>The <code>client</code> subcommand defines a client of a service on an interface or router. Any <em>rule-params</em> given to a parent interface or router are inherited by the client, but are reversed.</p>
    <p>For FireHOL a client is the source of a request. Even though this is more complex for some multi-socket services, to FireHOL a client always initiates the connection.</p>
    <p>The <em>service</em> parameter is one of the supported service names from <a href="#firehol-services5">firehol-services(5)</a>. Multiple services may be specified, space delimited in quotes.</p>
    <p>The <em>action</em> can be any of the actions listed in <a href="#firehol-actions5">firehol-actions(5)</a>.</p>
    <p>The <em>rule-params</em> define a set of rule parameters to further restrict the traffic that is matched to this service. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>Writing <code>client4</code> is equivalent to writing <code>ipv4 client</code> and ensures this subcommand is applied only in the IPv4 firewall rules.</p>
      <p>Writing <code>client6</code> is equivalent to writing <code>ipv6 client</code> and ensures this subcommand is applied only in the IPv6 firewall rules.</p>
      <p>Writing <code>client46</code> is equivalent to writing <code>both client</code> and ensures this subcommand is applied in both the IPv4 and IPv6 firewall rules; it cannot be used as part an interface or router that is IPv4 or IPv6 only.</p>
      <p>The default <code>client</code> inherits its behaviour from the enclosing interface or router.</p>
    </blockquote>
    <h3 id="examples-2">
      <a href="#examples-2">EXAMPLES</a>
    </h3>
    <pre><code>client smtp accept

client "smtp pop3" accept

client smtp accept src 192.0.2.1

client smtp accept log "mail packet" src 192.0.2.1</code></pre>
    <h3 id="see-also-6">
      <a href="#see-also-6">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-modifiers5">firehol-modifiers(5)</a> - ipv4/ipv6 selection</li>
      <li><a href="#firehol-services5">firehol-services(5)</a> - services list</li>
      <li><a href="#firehol-actions5">firehol-actions(5)</a> - actions for rules</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-server5">firehol-server(5)</a> - server subcommand</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-connmark5">
      <a href="#firehol-connmark5">firehol-connmark(5)</a>
    </h2>
    <h3 id="name-7">
      <a href="#name-7">NAME</a>
    </h3>
    <p>firehol-connmark - set a stateful mark on a connection</p>
<!--
contents-table:helper:connmark:keyword-firehol-connmark:Y:-:Set a stateful mark from the `connmark` group.
  -->
    <h3 id="synopsis-6">
      <a href="#synopsis-6">SYNOPSIS</a>
    </h3>
    <p>
      <em>Warning - this manual page is out of date for nightly build/v3 behaviour</em>
    </p>
    <p>{ connmark | connmark46 } { value | save | restore } <em>chain</em> <em>rule-params</em></p>
    <p>connmark4 { value | save | restore } <em>chain</em> <em>rule-params</em></p>
    <p>connmark6 { value | save | restore } <em>chain</em> <em>rule-params</em></p>
    <h3 id="description-7">
      <a href="#description-7">DESCRIPTION</a>
    </h3>
    <p>The <code>connmark</code> helper command sets a mark on a whole connection. It applies to both directions.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>To set a mark on packets matching particular rules, regardless of any connection, see <a href="#firehol-mark5">firehol-mark(5)</a>.</p>
    </blockquote>
    <p>The <em>value</em> is the mark value to set (a 32 bit integer). If you specify <code>save</code> then the mark on the matched packet will be turned into a connmark. If you specify <code>restore</code> then the matched packet will have its mark set to the current connmark.</p>
    <p>The <em>chain</em> will be used to find traffic to mark. It can be any of the iptables(8) built in chains belonging to the <code>mangle</code> table. The chain names are: INPUT, FORWARD, OUTPUT, PREROUTING and POSTROUTING. The names are case-sensitive.</p>
    <p>The <em>rule-params</em> define a set of rule parameters to match the traffic that is to be marked within the chosen chain. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <p>Any <code>connmark</code> commands will affect all traffic matched. They must be declared before the first router or interface.</p>
    <h3 id="examples-3">
      <a href="#examples-3">EXAMPLES</a>
    </h3>
    <p>Consider a scenario with 3 ethernet ports, where eth0 is on the local LAN, eth1 connects to ISP 'A' and eth2 to ISP 'B'. To ensure traffic leaves via the same ISP as it arrives from you can mark the traffic.</p>
    <pre><code> # mark connections when they arrive from the ISPs
 connmark 1 PREROUTING inface eth1
 connmark 2 PREROUTING inface eth2

 # restore the mark (from the connmark) when packets arrive from the LAN
 connmark restore OUTPUT
 connmark restore PREROUTING inface eth0</code></pre>
    <p>It is then possible to use the commands from iproute2 such as ip(8), to pick the correct routing table based on the mark on the packets.</p>
    <h3 id="see-also-7">
      <a href="#see-also-7">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-mark5">firehol-mark(5)</a> - mark traffic for traffic shaping tools</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>ip(8) - show / manipulate routing, devices, policy routing and tunnels</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="http://lartc.org/howto/">Linux Advanced Routing &amp; Traffic Control HOWTO</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-dscp5">
      <a href="#firehol-dscp5">firehol-dscp(5)</a>
    </h2>
    <h3 id="name-8">
      <a href="#name-8">NAME</a>
    </h3>
    <p>firehol-dscp - set the DSCP field in the packet header</p>
<!--
contents-table:helper:dscp:keyword-firehol-dscp-helper:Y:-:Set the DSCP field of packets.
  -->
    <h3 id="synopsis-7">
      <a href="#synopsis-7">SYNOPSIS</a>
    </h3>
    <p>dscp { <em>value</em> | class <em>classid</em> } <em>chain</em> <em>rule-params</em></p>
    <h3 id="description-8">
      <a href="#description-8">DESCRIPTION</a>
    </h3>
    <p>The <code>dscp</code> helper command sets the DSCP field in the header of packets traffic, to allow QoS shaping.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>There is also a <code>dscp</code> parameter which allows matching DSCP values within individual rules (see <a href="#dscp">firehol-params(5)</a>).</p>
    </blockquote>
    <p>Set <em>value</em> to a decimal or hexadecimal (0xnn) number to set an explicit DSCP value or use <code>class</code> <em>classid</em> to use an iptables(8) DiffServ class, such as EF, BE, CSxx or AFxx (see <code>iptables -j DSCP --help</code> for more information).</p>
    <p>The <em>chain</em> will be used to find traffic to mark. It can be any of the iptables(8) built in chains belonging to the <code>mangle</code> table. The chain names are: INPUT, FORWARD, OUTPUT, PREROUTING and POSTROUTING. The names are case-sensitive.</p>
    <p>The <em>rule-params</em> define a set of rule parameters to match the traffic that is to be marked within the chosen chain. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <p>Any <code>dscp</code> commands will affect all traffic matched. They must be declared before the first router or interface.</p>
    <h3 id="examples-4">
      <a href="#examples-4">EXAMPLES</a>
    </h3>
    <pre><code>
 # set DSCP field to 32, packets sent by the local machine
 dscp 32 OUTPUT

 # set DSCP field to 32 (hex 20), packets routed by the local machine
 dscp 0x20 FORWARD

 # set DSCP to DiffServ class EF, packets routed by the local machine
 #              and destined for port TCP/25 of 198.51.100.1
 dscp class EF FORWARD proto tcp dport 25 dst 198.51.100.1</code></pre>
    <h3 id="see-also-8">
      <a href="#see-also-8">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>ip(8) - show / manipulate routing, devices, policy routing and tunnels</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="http://lartc.org/howto/">Linux Advanced Routing &amp; Traffic Control HOWTO</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-group5">
      <a href="#firehol-group5">firehol-group(5)</a>
    </h2>
    <h3 id="name-9">
      <a href="#name-9">NAME</a>
    </h3>
    <p>firehol-group - group commands with common options</p>
<!--
contents-table:subcommand:group:keyword-firehol-group:Y:-:Define groups of commands that share optional rule parameters. Groups can be nested.
  -->
    <h3 id="synopsis-8">
      <a href="#synopsis-8">SYNOPSIS</a>
    </h3>
    <p>group with <em>rule-params</em></p>
    <p>group end</p>
    <h3 id="description-9">
      <a href="#description-9">DESCRIPTION</a>
    </h3>
    <p>The <code>group</code> command allows you to group together multiple <code>client</code> and <code>server</code> commands.</p>
    <p>Grouping commands with common options (see <a href="#firehol-params5">firehol-params(5)</a>) allows the option values to be checked only once in the generated firewall rather than once per service, making it more efficient.</p>
    <p>Nested groups may be used.</p>
    <h3 id="examples-5">
      <a href="#examples-5">EXAMPLES</a>
    </h3>
    <p>This:</p>
    <pre><code>
interface any world
  client all accept
  server http accept

  # Provide these services to trusted hosts only
  server "ssh telnet" accept src "192.0.2.1 192.0.2.2"</code></pre>
    <p>can be replaced to produce a more efficient firewall by this:</p>
    <pre><code>
interface any world
  client all accept
  server http accept

  # Provide these services to trusted hosts only
  group with src "192.0.2.1 192.0.2.2"
    server telnet accept
    server ssh accept
  group end</code></pre>
    <h3 id="see-also-9">
      <a href="#see-also-9">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-interface5">
      <a href="#firehol-interface5">firehol-interface(5)</a>
    </h2>
    <h3 id="name-10">
      <a href="#name-10">NAME</a>
    </h3>
    <p>firehol-interface - interface definition</p>
<!--
contents-table:primary:interface:keyword-firehol-interface:Y:inface outface physout:Define packet filtering blocks, protecting the firewall host itself.
  -->
    <h3 id="synopsis-9">
      <a href="#synopsis-9">SYNOPSIS</a>
    </h3>
    <p>{ interface | interface46 } <em>real-interface</em> <em>name</em> <em>rule-params</em></p>
    <p>interface4 <em>real-interface</em> <em>name</em> <em>rule-params</em></p>
    <p>interface6 <em>real-interface</em> <em>name</em> <em>rule-params</em></p>
<!--
This comment ensures a manpage is created for each keyword
extra-manpage: firehol-interface46.5
extra-manpage: firehol-interface4.5
extra-manpage: firehol-interface6.5
  -->
    <h3 id="description-10">
      <a href="#description-10">DESCRIPTION</a>
    </h3>
    <p>An <code>interface</code> definition creates a firewall for protecting the host on which the firewall is running.</p>
    <p>The default policy is DROP, so that if no subcommands are given, the firewall will just drop all incoming and outgoing traffic using this interface.</p>
    <p>The behaviour of the defined interface is controlled by adding subcommands from those listed in <a href="#interface-subcommands">INTERFACE SUBCOMMANDS</a>.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>Forwarded traffic is never matched by the <code>interface</code> rules, even if it was originally destined for the firewall but was redirected using NAT. Any traffic to be passed through the firewall for whatever reason must be in a <code>router</code> (see <a href="#firehol-router5">firehol-router(5)</a>).</p>
    </blockquote>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>Writing <code>interface4</code> is equivalent to writing <code>ipv4 interface</code> and ensures the defined interface is created only in the IPv4 firewall along with any rules within it.</p>
      <p>Writing <code>interface6</code> is equivalent to writing <code>ipv6 interface</code> and ensures the defined interface is created only in the IPv6 firewall along with any rules within it.</p>
      <p>Writing <code>interface46</code> is equivalent to writing <code>both interface</code> and ensures the defined interface is created in both the IPv4 and IPv6 firewalls. Any rules within it will also be applied to both, unless they specify otherwise.</p>
    </blockquote>
    <h3 id="parameters">
      <a href="#parameters">PARAMETERS</a>
    </h3>
    <dl>
      <dt>
        <em>real-interface</em>
      </dt>
      <dd>
        <p>This is the interface name as shown by <code>ip link show</code>. Generally anything iptables(8) accepts is valid.</p>
        <p>The + (plus sign) after some text will match all interfaces that start with this text.</p>
        <p>Multiple interfaces may be specified by enclosing them within quotes, delimited by spaces for example:</p>
        <pre><code>interface "eth0 eth1 ppp0" myname</code></pre>
      </dd>
      <dt>
        <em>name</em>
      </dt>
      <dd>
        <p>This is a name for this interface. You should use short names (10 characters maximum) without spaces or other symbols.</p>
        <p>A name should be unique for all FireHOL interface and router definitions.</p>
      </dd>
      <dt>
        <em>rule-params</em>
      </dt>
      <dd>
        <p>The set of rule parameters to further restrict the traffic that is matched to this interface.</p>
        <p>See <a href="#firehol-params5">firehol-params(5)</a> for information on the parameters that can be used. Some examples:</p>
        <pre><code>
interface eth0 intranet src 192.0.2.0/24

interface eth0 internet src not "${UNROUTABLE_IPS}"</code></pre>
        <p>See <a href="#firehol.conf5">firehol.conf(5)</a> for an explanation of ${UNROUTABLE_IPS}.</p>
      </dd>
    </dl>
    <h3 id="see-also-10">
      <a href="#see-also-10">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-modifiers5">firehol-modifiers(5)</a> - ipv4/ipv6 selection</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-iptables5">firehol-iptables(5)</a> - iptables helper</li>
      <li><a href="#firehol-masquerade5">firehol-masquerade(5)</a> - masquerade helper</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <h4 id="interface-subcommands">
      <a href="#interface-subcommands">Interface Subcommands</a>
    </h4>
    <ul>
      <li><a href="#firehol-policy5">firehol-policy(5)</a> - policy command</li>
      <li><a href="#firehol-protection5">firehol-protection(5)</a> - protection command</li>
      <li><a href="#firehol-server5">firehol-server(5)</a> - server, route commands</li>
      <li><a href="#firehol-client5">firehol-client(5)</a> - client command</li>
      <li><a href="#firehol-group5">firehol-group(5)</a> - group command</li>
    </ul>
    <p></p>
    <h2 id="firehol-ipset5">
      <a href="#firehol-ipset5">firehol-ipset(5)</a>
    </h2>
    <h3 id="name-11">
      <a href="#name-11">NAME</a>
    </h3>
    <p>firehol-ipset - configure ipsets</p>
<!--
contents-table:helper:ipset:keyword-firehol-ipset:4/6:*all forbidden*:Define ipsets. A wrapper for the system ipset command to add ipsets to a FireHOL firewall.
  -->
    <h3 id="synopsis-10">
      <a href="#synopsis-10">SYNOPSIS</a>
    </h3>
    <p>ipset <em>command</em> <em>name</em> <em>options</em></p>
    <h3 id="description-11">
      <a href="#description-11">DESCRIPTION</a>
    </h3>
    <p>FireHOL has an <code>ipset</code> helper. It is a wrapper around the real <code>ipset</code> command and is handled internally within FireHOL in such a way so that the ipset collections defined in the configuration will be activated before activating the firewall.</p>
    <p>FireHOL is also smart enough to restore the ipsets after a reboot, before it restores the firewall, so that everything will work as seamlessly as possible.</p>
    <p>The <code>ipset</code> helper has the same syntax with the real <code>ipset</code> command. So in FireHOL you just add the <code>ipset</code> statements you need, and FireHOL will do the rest.</p>
    <p>Keep in mind that each <code>ipset</code> collection is either IPv4 or IPv6. In FireHOL prefix <code>ipset</code> with either <code>ipv4</code> or <code>ipv6</code> and FireHOL will choose the right IP version (there is also <code>ipset4</code> and <code>ipset6</code>).</p>
    <p>Also, do not add <code>-!</code> to ipset statements given in <code>firehol.conf</code>. FireHOL will batch import all ipsets and this option is not needed.</p>
    <h3 id="firehol-ipset-extensions">
      <a href="#firehol-ipset-extensions">FireHOL ipset extensions</a>
    </h3>
    <p>The features below are extensions of <code>ipset</code> that can only be used from within <code>firehol.conf</code>. They will not work on a terminal.</p>
    <p>The FireHOL helper allows mass import of ipset collections from files. This is done with <code>ipset addfile</code> command.</p>
    <p>The <code>ipset addfile</code> command will get a filename, remove all comments (anything after a <code>#</code> on the same line), trim any empty lines and spaces, and add all the remaining lines to <code>ipset</code>, as if each line of the file was run with <code>ipset add COLLECTION_NAME IP_FROM_FILE [other options]</code>.</p>
    <p>The syntax of the <code>ipset addfile</code> command is:</p>
    <pre><code> ipset addfile *name* [ip|net] *filename* [*other ipset add options*]</code></pre>
    <p><code>name</code> is the collection to add the IPs.</p>
    <p><code>ip</code> is optional and will select all the lines of the file that do not contain a <code>/</code>.</p>
    <p><code>net</code> is optional and will select all the lines of the file that contain a <code>/</code>.</p>
    <p><code>filename</code> is the filename to read. You can give absolute filenames and relative filenames (to <code>/etc/firehol</code>).</p>
    <p><code>other ipset add options</code> is whatever else <code>ipset add</code> supports, that you are willing to give for each line.</p>
    <p>The <code>ipset add</code> command implemented in FireHOL also allows you to give multiple IPs separated by comma or enclosed in quotes and separated by space.</p>
    <h3 id="examples-6">
      <a href="#examples-6">EXAMPLES</a>
    </h3>
    <pre><code> ipv4 ipset create badguys hash:ip
 ipv4 ipset add badguys 1.2.3.4
 ipv4 ipset addfile badguys file-with-the-bad-guys-ips.txt
 ...
 ipv4 blacklist full ipset:badguys

 # example with multiple IPs
 ipv4 ipset create badguys hash:ip
 ipv4 ipset add badguys 1.2.3.4,5.6.7.8,9.10.11.12 # &lt;&lt; comma separated
 ipv4 ipset add badguys "11.22.33.44 55.66.77.88"  # &lt;&lt; space separated in quotes</code></pre>
    <p>ipsets with IP Lists for abuse, malware, attacks, proxies, anonymizers, etc can be downloaded with the contrib/update-ipsets.sh script. Information about the supported ipsets can be found at <a href="http://iplists.firehol.org/">FireHOL IP Lists</a></p>
    <h3 id="see-also-11">
      <a href="#see-also-11">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-masquerade5">firehol-masquerade(5)</a> - masquerade helper</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="http://iplists.firehol.org/">FireHOL IP Lists</a>
      </li>
      <li>
        <a href="http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO-6.html">NAT HOWTO</a>
      </li>
      <li>
        <a href="http://upload.wikimedia.org/wikipedia/commons/3/37/Netfilter-packet-flow.svg">netfilter flow diagram</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-iptables5">
      <a href="#firehol-iptables5">firehol-iptables(5)</a>
    </h2>
    <h3 id="name-12">
      <a href="#name-12">NAME</a>
    </h3>
    <p>firehol-iptables - include custom iptables commands <!--
extra-manpage: firehol-ip6tables.5
contents-table:subcommand:iptables ip6tables:keyword-firehol-iptables:N:*all forbidden*:A wrapper for the system iptables command, to add custom iptables statements to a FireHOL firewall.
contents-table:helper:iptables ip6tables:keyword-firehol-ip6tables:N:*all forbidden*:A wrapper for the system iptables command, to add custom iptables statements to a FireHOL firewall.
  --></p>
    <h3 id="synopsis-11">
      <a href="#synopsis-11">SYNOPSIS</a>
    </h3>
    <p>iptables <em>argument</em>...</p>
    <p>ip6tables <em>argument</em>...</p>
    <h3 id="description-12">
      <a href="#description-12">DESCRIPTION</a>
    </h3>
    <p>The <code>iptables</code> and <code>ip6tables</code> helper commands pass all of their <em>argument</em>s to the real iptables(8) or ip6tables(8) at the appropriate point during run-time.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>When used in an <code>interface</code> or <code>router</code>, the result will not have a direct relationship to the enclosing definition as the parameters passed are only those you supply.</p>
    </blockquote>
    <p>You should not use <code>/sbin/iptables</code> or <code>/sbin/ip6tables</code> directly in a FireHOL configuration as they will run before FireHOL activates its firewall. This means that the commands are applied to the previously running firewall, not the new firewall, and will be lost when the new firewall is activated.</p>
    <p>The <code>iptables</code> and <code>ip6tables</code> helpers are provided to allow you to hook in commands safely.</p>
    <h3 id="see-also-12">
      <a href="#see-also-12">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-iptrap5">
      <a href="#firehol-iptrap5">firehol-iptrap(5)</a>
    </h2>
    <h3 id="name-13">
      <a href="#name-13">NAME</a>
    </h3>
    <p>firehol-iptrap - dynamically put IP addresses in an ipset</p>
<!--
contents-table:helper:iptrap:keyword-firehol-iptrap:4/6:-:Dynamically put IP addresses in an ipset.
  -->
    <h3 id="synopsis-12">
      <a href="#synopsis-12">SYNOPSIS</a>
    </h3>
    <p>{ iptrap | iptrap4 | iptrap6 } <em>ipset</em> <em>type</em> <em>seconds</em> [ timeout | counters ] [ method <strong>method</strong> ] [<em>rule-params</em>] [ except [<em>rule-params</em>] ]...</p>
    <p>{ ipuntrap | ipuntrap4 | ipuntrap6 } <em>ipset</em> <em>type</em> [ timeout | counters ] [ method <strong>method</strong> ] [<em>rule-params</em>] [ except [<em>rule-params</em>] ]...</p>
<!--
extra-manpage: firehol-iptrap4.5
extra-manpage: firehol-iptrap6.5
extra-manpage: firehol-ipuntrap.5
extra-manpage: firehol-ipuntrap4.5
extra-manpage: firehol-ipuntrap6.5
  -->
    <h3 id="description-13">
      <a href="#description-13">DESCRIPTION</a>
    </h3>
    <p><code>iptrap</code> adds the IP addresses of the matching packets to <code>ipset</code>.</p>
    <p><code>ipuntrap</code> deletes the IP addresses of the matching packets from <code>ipset</code>.</p>
    <p>Both helpers do not affect the flow of traffic. They do not <code>ACCEPT</code>, <code>REJECT</code>, <code>DROP</code> packets or affect the firewall in any way.</p>
    <p><code>ipset</code> is the name of the ipset to use.</p>
    <p><code>type</code> selects which of the IP addresses of the matching packets will be used (added or removed from the ipset). <code>type</code> can be <code>src</code>, <code>dst</code>, <code>src,dst</code>, <code>dst,src</code>, etc. If type is a pair, then the ipset must be an ipset of pairs too.</p>
    <p><code>seconds</code> is required by <code>iptrap</code> and gives the duration in seconds of the lifetime of each IP address that is added to <code>ipset</code>. Every matching packet will refresh this duration for the IP address in the ipset. The Linux kernel will automatically remove the IP from the ipset when this time expires. The user may monitor the remaining time for each IP, by running <code>ipset list NAME</code> (where <code>NAME</code> is the <code>ipset</code> parameter given in the <code>iptrap</code> command).</p>
    <p>The seconds value <code>default</code> will not set any seconds. The ipset default will be used.</p>
    <p>A seconds of <code>0</code> (zero), writes to the ipset permanently (this is a feature of the ipset command, not the ipset FireHOL helper).</p>
    <p>The keywords <code>timeout</code> and <code>counters</code> are mutually exclusive. <code>timeout</code> is the default and means that each IP address every time is matched its timeout will be refreshed, while <code>counters</code> means that its packets and bytes counters will be refreshed. Unfortunately the kernel either re-add the IP in the ipset with the new timeout - but its counters will be lost, or just the counters will be updated, but the timeout will not be refreshed.</p>
    <p><code>method</code> is defines the storage method of the underlying ipset. It accepts all the types the ipset commands accepts.</p>
    <p><code>method</code> and <code>type</code> should match. For example if method is <code>hash:ip</code> then method should be either <code>src</code> or <code>dst</code>. If method is <code>hash:ip,ip</code> then method should be either <code>src,dst</code> or <code>dst,src</code>. If method is <code>hash:ip,port,ip</code> method should be <code>src,src,dst</code> or <code>src,dst,dst</code> or <code>dst,src,src</code> or <code>dst,dst,src</code>. For more information check the manual page of the ipset command.</p>
    <p>The <em>rule-params</em> define a set of rule parameters to restrict the traffic that is matched to this helper. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <p><code>except</code><em>rule-params</em> are used to exclude traffic, i.e. traffic that normally is matched by the first set of <em>rule-params</em>, will be excluded if matched by the second.</p>
    <p><code>iptrap</code> and <code>ipuntrap</code> are hooked on PREROUTING so it is only useful for incoming traffic.</p>
    <p><code>iptrap</code> and <code>ipuntrap</code> cannot setup both IPv4 and IPv6 traps with one call. The reason is that the <code>ipset</code> can either be IPv4 or IPv6.</p>
    <p>Both helpers will create the <code>ipset</code> specified, if that ipset is not already created by other statements. When the ipset is created by the <code>iptrap</code> helper, the ipset will not be reset (emptied) when the firewall is restarted.</p>
    <p>The ipset options used when these helpers create ipsets can be controlled with the variable IPTRAP_DEFAULT_IPSET_OPTIONS.</p>
    <h3 id="examples-7">
      <a href="#examples-7">EXAMPLES</a>
    </h3>
    <pre><code> # Example: mini-IDS
 # add to the ipset `trap` for an hour (3600 seconds) all IPs from all packets
 # coming from eth0 and going to tcp/3306 (mysql).
 iptrap4 src trap 3600 inface eth0 proto tcp dport 3306 log "TRAPPED HTTP"
 # block them
 blacklist4 full inface eth0 log "BLOCKED" src ipset:trap except src ipset:whitelist

 # Example: ipuntrap
 ipuntrap4 src trap inface eth0 src ipset:trap proto tcp dport 80 log "UNTRAPPED HTTP"

 # Example: a knock
 # The user will be able to knock at tcp/12345
 iptrap4 src knock1 30 inface eth0 proto tcp dport 12345 log "KNOCK STEP 1"
 # in 30 seconds knock at tcp/23456
 iptrap4 src knock2 60 inface eth0 proto tcp dport 23456 src ipset:knock1 log "KNOCK STEP 2"
 # in 60 seconds knock at tcp/34566
 iptrap4 src knock3 90 inface eth0 proto tcp dport 34567 src ipset:knock2 log "KNOCK STEP 3"
 #
 # and in 90 seconds ssh
 interface ...
     server ssh accept src ipset:knock3</code></pre>
    <h3 id="see-also-13">
      <a href="#see-also-13">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-mac5">
      <a href="#firehol-mac5">firehol-mac(5)</a>
    </h2>
    <h3 id="name-14">
      <a href="#name-14">NAME</a>
    </h3>
    <p>firehol-mac - ensure source IP and source MAC address match</p>
<!--
contents-table:helper:mac:keyword-firehol-mac-helper:Y:*all forbidden*:Restricts an IP to a particular MAC address.
  -->
    <h3 id="synopsis-13">
      <a href="#synopsis-13">SYNOPSIS</a>
    </h3>
    <p>mac <em>IP</em> <em>macaddr</em></p>
    <h3 id="description-14">
      <a href="#description-14">DESCRIPTION</a>
    </h3>
    <p>Any <code>mac</code> commands will affect all traffic destined for the firewall host, or to be forwarded by the host. They must be declared before the first router or interface.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>There is also a <code>mac</code> parameter which allows matching MAC addresses within individual rules (see <a href="#firehol-params5">firehol-params(5)</a>).</p>
    </blockquote>
    <p>The <code>mac</code> helper command DROPs traffic from the <em>IP</em> address that was not sent using the <em>macaddr</em> specified.</p>
    <p>When packets are dropped, a log is produced with the label "MAC MISSMATCH" (sic.). <code>mac</code> obeys the default log limits (see <a href="#logging">LOGGING</a> in <a href="#firehol-params5">firehol-params(5)</a>).</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>This command restricts an IP to a particular MAC address. The same MAC address is permitted send traffic with a different IP.</p>
    </blockquote>
    <h3 id="examples-8">
      <a href="#examples-8">EXAMPLES</a>
    </h3>
    <pre><code>mac 192.0.2.1    00:01:01:00:00:e6
mac 198.51.100.1 00:01:01:02:aa:e8</code></pre>
    <h3 id="see-also-14">
      <a href="#see-also-14">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-mark5">
      <a href="#firehol-mark5">firehol-mark(5)</a>
    </h2>
    <h3 id="name-15">
      <a href="#name-15">NAME</a>
    </h3>
    <p>firehol-mark - mark traffic for traffic shaping tools</p>
    <h3 id="synopsis-14">
      <a href="#synopsis-14">SYNOPSIS</a>
    </h3>
    <p>
      <em>Warning - this manual page is out of date for nightly build/v3 behaviour</em>
    </p>
    <p>mark <em>value</em> <em>chain</em> <em>rule-params</em></p>
<!--
contents-table:helper:mark:keyword-firehol-mark-helper:Y:-:Set a stateful mark from the `usermark` group.
  -->
    <h3 id="description-15">
      <a href="#description-15">DESCRIPTION</a>
    </h3>
    <p>The <code>mark</code> helper command sets a mark on packets that can be matched by traffic shaping tools for controlling the traffic.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>To set a mark on whole connections, see <a href="#firehol-connmark5">firehol-connmark(5)</a>. There is also a <code>mark</code> parameter which allows matching marks within individual rules (see <a href="#mark">firehol-params(5)</a>).</p>
    </blockquote>
    <p>The <em>value</em> is the mark value to set (a 32 bit integer).</p>
    <p>The <em>chain</em> will be used to find traffic to mark. It can be any of the iptables(8) built in chains belonging to the <code>mangle</code> table. The chain names are: INPUT, FORWARD, OUTPUT, PREROUTING and POSTROUTING. The names are case-sensitive.</p>
    <p>The <em>rule-params</em> define a set of rule parameters to match the traffic that is to be marked within the chosen chain. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <p>Any <code>mark</code> commands will affect all traffic matched. They must be declared before the first router or interface.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>If you want to do policy based routing based on iptables(8) marks, you will need to disable the Root Path Filtering on the interfaces involved (rp_filter in sysctl).</p>
    </blockquote>
    <h3 id="examples-9">
      <a href="#examples-9">EXAMPLES</a>
    </h3>
    <pre><code> # mark with 1, packets sent by the local machine
 mark 1 OUTPUT

 # mark with 2, packets routed by the local machine
 mark 2 FORWARD

 # mark with 3, packets routed by the local machine, sent from
 #              192.0.2.2 destined for port TCP/25 of 198.51.100.1
 mark 3 FORWARD proto tcp dport 25 dst 198.51.100.1 src 192.0.2.2</code></pre>
    <h3 id="see-also-15">
      <a href="#see-also-15">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-connmark5">firehol-connmark(5)</a> - set a stateful mark on a connection</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>ip(8) - show / manipulate routing, devices, policy routing and tunnels</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="http://lartc.org/howto/">Linux Advanced Routing &amp; Traffic Control HOWTO</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-masquerade5">
      <a href="#firehol-masquerade5">firehol-masquerade(5)</a>
    </h2>
    <h3 id="name-16">
      <a href="#name-16">NAME</a>
    </h3>
    <p>firehol-masquerade - set up masquerading (NAT) on an interface</p>
<!--
contents-table:subcommand:masquerade:keyword-firehol-masquerade:Y:inface outface:Change the source IP of packets leaving `outface`, with the IP of the interface they are using to leave.
contents-table:helper:masquerade:keyword-firehol-masquerade:Y:-:Change the source IP of packets leaving `outface`, with the IP of the interface they are using to leave.
  -->
    <h3 id="synopsis-15">
      <a href="#synopsis-15">SYNOPSIS</a>
    </h3>
    <p>masquerade <em>real-interface</em> <em>rule-params</em></p>
    <p>masquerade [reverse] <em>rule-params</em></p>
    <h3 id="description-16">
      <a href="#description-16">DESCRIPTION</a>
    </h3>
    <p>The <code>masquerade</code> helper command sets up masquerading on the output of a real network interface (as opposed to a FireHOL <code>interface</code> definition).</p>
    <p>If a <em>real-interface</em> is specified the command should be used before any <code>interface</code> or <code>router</code> definitions. Multiple values can be given separated by whitespace, so long as they are enclosed in quotes.</p>
    <p>If used within an <code>interface</code> definition the definition's <em>real-interface</em> will be used.</p>
    <p>If used within a router definition the definition's <code>outface</code>(s) will be used, if specified. If the <code>reverse</code> option is given, then the definition's <code>inface</code>(s) will be used, if specified.</p>
    <p>Unlike most commands, <code>masquerade</code> does not inherit its parent definition's <em>rule-params</em>, it only honours its own. The <code>inface</code> and <code>outface</code> parameters should not be used (iptables(8) does not support inface in the POSTROUTING chain and outface will be overwritten by FireHOL using the rules above).</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>The masquerade always applies to the output of the chosen network interfaces.</p>
      <p>FIREHOL_NAT will be turned on automatically (see <a href="#firehol-variables5">firehol-variables(5)</a> ) and FireHOL will enable packet-forwarding in the kernel.</p>
    </blockquote>
    <h3 id="masquerading-and-snat">
      <a href="#masquerading-and-snat">MASQUERADING AND SNAT</a>
    </h3>
    <p>Masquerading is a special form of Source NAT (SNAT) that changes the source of requests when they go out and replaces their original source when they come in. This way a Linux host can become an Internet router for a LAN of clients having unroutable IP addresses. Masquerading takes care to re-map IP addresses and ports as required.</p>
    <p>Masquerading is expensive compare to SNAT because it checks the IP address of the outgoing interface every time for every packet. If your host has a static IP address you should generally prefer SNAT.</p>
    <h3 id="examples-10">
      <a href="#examples-10">EXAMPLES</a>
    </h3>
    <pre><code>
 # Before any interface or router
 masquerade eth0 src 192.0.2.0/24 dst not 192.0.2.0/24

 # In an interface definition to masquerade the output of its real-interface
 masquerade

 # In a router definition to masquerade the output of its outface
 masquerade

 # In a router definition to masquerade the output of its inface
 masquerade reverse</code></pre>
    <h3 id="see-also-16">
      <a href="#see-also-16">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-nat5">firehol-nat(5)</a> - nat, snat, dnat, redirect config helpers</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-modifiers5">
      <a href="#firehol-modifiers5">firehol-modifiers(5)</a>
    </h2>
    <h3 id="name-17">
      <a href="#name-17">NAME</a>
    </h3>
    <p>firehol-modifiers - select IPv4 or IPv6 mode <!--
extra-manpage: firehol-ipv4.5
extra-manpage: firehol-ipv6.5
--></p>
    <h3 id="synopsis-16">
      <a href="#synopsis-16">SYNOPSIS</a>
    </h3>
    <p>ipv4 <em>definition-or-command</em> <em>argument</em>...</p>
    <p>ipv6 <em>definition-or-command</em> <em>argument</em>...</p>
    <h3 id="description-17">
      <a href="#description-17">DESCRIPTION</a>
    </h3>
    <p>Without a modifier, interface and router definitions and commands that come before either will be applied to both IPv4 and IPV6. Commands within an <code>interface</code> or <code>router</code> assume the same behaviour as the enclosing definition.</p>
    <p>When preceded by a modifier, the command or definition can be made to apply to IPv4 or IPv6 only. Note that you cannot create an IPv4 only command within and IPv6 interface or vice-versa.</p>
    <p>Examples:</p>
    <pre><code>
 interface eth0 myboth src4 192.0.2.0/24 src6 2001:DB8::/24
   ipv4 server http accept
   ipv6 server http accept

 ipv4 interface eth0 my4only src 192.0.2.0/24
   server http accept

 ipv6 interface eth0 my6only src 2001:DB8::/24
   server http accept</code></pre>
    <p>Many definitions and commands have explicitly named variants (such as router4, router6, router46) which can be used as shorthand.</p>
    <h3 id="see-also-17">
      <a href="#see-also-17">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-policy5">firehol-policy(5)</a> - policy command</li>
      <li><a href="#firehol-protection5">firehol-protection(5)</a> - protection command</li>
      <li><a href="#firehol-server5">firehol-server(5)</a> - server, route commands</li>
      <li><a href="#firehol-client5">firehol-client(5)</a> - client command</li>
      <li><a href="#firehol-group5">firehol-group(5)</a> - group command</li>
      <li><a href="#firehol-iptables5">firehol-iptables(5)</a> - iptables helper</li>
      <li><a href="#firehol-masquerade5">firehol-masquerade(5)</a> - masquerade helper</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-nat5">
      <a href="#firehol-nat5">firehol-nat(5)</a>
    </h2>
    <h3 id="name-18">
      <a href="#name-18">NAME</a>
    </h3>
    <p>firehol-nat - set up NAT and port redirections</p>
<!--
extra-manpage: firehol-dnat.5
extra-manpage: firehol-snat.5
extra-manpage: firehol-redirect.5

contents-table:helper:dnat:keyword-firehol-dnat:Y:-:Change the destination IP or port of packets received, to fixed values or fixed ranges. `dnat` can be used to implement load balancers.
contents-table:helper:snat:keyword-firehol-snat:Y:-:Change the source IP or port of packets leaving, to fixed values or fixed ranges.
contents-table:helper:redirect:keyword-firehol-redirect-helper:Y:-:Redirect packets to the firewall host, possibly changing the destination port. Can support load balancers if multiple daemons run on localhost.
  -->
    <h3 id="synopsis-17">
      <a href="#synopsis-17">SYNOPSIS</a>
    </h3>
    <p>{ nat to-destination | dnat [to] } <em>ipaddr</em>[:<em>port</em>] [random] [persistent] [id <em>id</em>] [at <em>chain</em>] [<em>rule-params</em>]</p>
    <p>{ nat to-source | snat [to] } <em>ipaddr</em>[:<em>port</em>] [random] [persistent] [id <em>id</em>] [at <em>chain</em>] [<em>rule-params</em>]</p>
    <p>{ nat redirect-to | redirect [to] } <em>port</em>[-<em>range</em>] [random] [id <em>id</em>] [at <em>chain</em>] [<em>rule-params</em>]</p>
    <h3 id="description-18">
      <a href="#description-18">DESCRIPTION</a>
    </h3>
    <p>Destination NAT is provided by <code>nat to-destination</code> and its synonym <code>dnat</code>.</p>
    <p>Source NAT is provided by <code>nat to-source</code> and its synonym <code>snat</code>.</p>
    <p>Redirection to a port on the local host is provided by <code>nat redirect-to</code> and its synonym <code>redirect</code>.</p>
    <p>The <em>port</em> part of the new address is optional with SNAT and DNAT; if not specified it will not be changed.</p>
    <p>When you apply NAT to a packet, the Linux kernel will track the changes it makes, so that when it sees replies the transformation will be applied in the opposite direction. For instance if you changed the destination port of a packet from 80 to 8080, when a reply comes back, its source is set as 80. This means the original sender is not aware a transformation is happening.</p>
    <p>This means that NAT is only applied on the first packet of each connection (the nat FireHOL helper always appends <code>state NEW</code> to NAT statements).</p>
    <p>The NAT helper can be used to setup load balancing. Check the section BALANCING below.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>The <em>rule-params</em> are used only to determine the traffic that will be matched for NAT in these commands, not to permit traffic to flow.</p>
      <p>Applying NAT does not automatically create rules to allow the traffic to pass. You will still need to include client or server entries in an interface or router to allow the traffic.</p>
      <p>When using <code>dnat</code> or <code>redirect</code>, the transformation is in the PREROUTING chain of the NAT table and happens before normal rules are matched, so your client or server rule should match the "modified" traffic.</p>
      <p>When using <code>snat</code>, the transformation is in the POSTROUTING chain of the NAT table and happens after normal rules are matched, so your client or server rule should match the "unmodified" traffic.</p>
      <p>See the <a href="http://upload.wikimedia.org/wikipedia/commons/3/37/Netfilter-packet-flow.svg">netfilter flow diagram</a> if you would like to see how network packets are processed by the kernel in detail.</p>
    </blockquote>
    <p>The <code>at</code> keyword allows setting a different chain to attach the rules. For <code>dnat</code> and <code>redirect</code> the default is PREROUTING, but OUTPUT is also supported. For <code>snat</code> the default is POSTROUTING, but INPUT is also supported.</p>
    <p><code>random</code> will randomise the port mapping involved, to ensure the ports used are not predictable.</p>
    <p><code>persistent</code> is used when the statement is given alternatives (i.e. many destination servers for <code>dnat</code>, many source IPs for <code>snat</code>, many ports for <code>redirect</code>). It will attempt to keep each client on the same nat map. See below for more information about persistence.</p>
    <p>The <code>nat</code> helper takes one of the following sub-commands:</p>
    <dl>
      <dt>to-destination <em>ipaddr</em>[:<em>port</em>]</dt>
      <dd>
        <p>Defines a Destination NAT (DNAT). Commonly thought of as port-forwarding (where packets destined for the firewall with a given port and protocol are sent to a different IP address and possibly port), DNAT is much more flexible in that any number of parameters can be matched before the destination information is rewritten.</p>
        <p><em>ipaddr</em>[:<em>port</em>] is the destination address to be set in packets matching <em>rule-params</em>.</p>
        <p>If no rules are given, all forwarded traffic will be matched. <code>outface</code> should not be used in DNAT since the information is not available at the time the decision is made.</p>
        <p><em>ipaddr</em>[:<em>port</em>] accepts any <code>--to-destination</code> values that iptables(8) accepts. Run <code>iptables -j DNAT --help</code> for more information. Multiple <em>ipaddr</em>[:<em>port</em>] may be specified by separating with spaces and enclosing with quotes.</p>
      </dd>
      <dt>to-source <em>ipaddr</em>[:<em>port</em>]</dt>
      <dd>
        <p>Defines a Source NAT (SNAT). SNAT is similar to masquerading but is more efficient for static IP addresses. You can use it to give a public IP address to a host which does not have one behind the firewall. See also <a href="#firehol-masquerade5">firehol-masquerade(5)</a>.</p>
        <p><em>ipaddr</em>[:<em>port</em>] is the source address to be set in packets matching <em>rule-params</em>.</p>
        <p>If no rules are given, all forwarded traffic will be matched. <code>inface</code> should not be used in SNAT since the information is not available at the time the decision is made.</p>
        <p><em>ipaddr</em>[:<em>port</em>] accepts any <code>--to-source</code> values that iptables(8) accepts. Run <code>iptables -j SNAT --help</code> for more information. Multiple <em>ipaddr</em>[:<em>port</em>] may be specified by separating with spaces and enclosing with quotes.</p>
      </dd>
      <dt>redirect-to <em>port</em>[-<em>range</em>]</dt>
      <dd>
        <p>Redirect matching traffic to the local machine. This is typically useful if you want to intercept some traffic and process it on the local machine.</p>
        <p><em>port</em>[-<em>range</em>] is the port range (from-to) or single port that packets matching <em>rule-params</em> will be redirected to.</p>
        <p>If no rules are given, all forwarded traffic will be matched. <code>outface</code> should not be used in REDIRECT since the information is not available at the time the decision is made.</p>
      </dd>
    </dl>
    <h3 id="balancing">
      <a href="#balancing">BALANCING</a>
    </h3>
    <p>NAT can balance multiple servers (or IPs in case of <code>snat</code>) when a range is specified. This is handled by the kernel.</p>
    <p>Example:</p>
    <pre><code>dnat4 to 10.0.0.1-10.0.0.10 persistent proto tcp dst 1.1.1.1 dport 80</code></pre>
    <p>In the above example, the Linux kernel will give a <code>persistent</code> server to all the sockets of any single client.</p>
    <p>FireHOL can also setup balancing using a round-robin or weighted average distribution of requests. However <code>persistent</code> cannot be used (the Linux kernel applies persistence on a single NAT statement).</p>
    <h4 id="round-robbin-distribution">
      <a href="#round-robbin-distribution">Round Robbin distribution</a>
    </h4>
    <p>To enable round robin distribution, give multiple <code>to</code> values, space separated and enclosed in quotes, or comma separated.</p>
    <p>Example:</p>
    <pre><code> dnat4 to 10.0.0.1,10.0.0.2,10.0.0.3 proto tcp dst 1.1.1.1 port 80
 # or
 dnat4 to "10.0.0.1 10.0.0.2 10.0.0.3" proto tcp dst 1.1.1.1 port 80</code></pre>
    <p>Ports can also be given per IP:</p>
    <pre><code> dnat4 to 10.0.0.1:70,10.0.0.2:80,10.0.0.3:90 proto tcp dst 1.1.1.1 port 80
 # or
 dnat4 to "10.0.0.1:70 10.0.0.2:80 10.0.0.3:90" proto tcp dst 1.1.1.1 port 80</code></pre>
    <h4 id="weighted-distribution">
      <a href="#weighted-distribution">Weighted distribution</a>
    </h4>
    <p>To enable weighted distribution, append a slash with the weight requested for each entry.</p>
    <p>FireHOL adds all the weights given and calculates the percentage of traffic each entry should receive.</p>
    <p>Example:</p>
    <pre><code> dnat4 to 10.0.0.1/30,10.0.0.2/30,10.0.0.3/40 proto tcp dst 1.1.1.1 port 80
 # or
 dnat4 to "10.0.0.1/30 10.0.0.2/30 10.0.0.3/40" proto tcp dst 1.1.1.1 port 80
 # or
 dnat4 to 10.0.0.1:70/30,10.0.0.2:80/30,10.0.0.3:90/40 proto tcp dst 1.1.1.1 port 80
 # or
 dnat4 to "10.0.0.1:70/30 10.0.0.2:80/30 10.0.0.3:90/40" proto tcp dst 1.1.1.1 port 80</code></pre>
    <h4 id="persistence">
      <a href="#persistence">PERSISTENCE</a>
    </h4>
    <p>The kernel supports persistence only if the NAT alternatives are contiguous (i.e. dnat to A-B, snat to A-B, redirect to 1000:1010, etc). If they are contiguous, persistence is left at the kernel. FireHOL does nothing.</p>
    <p>If the alternatives are not contiguous, FireHOL will use the <em>recent</em> iptables module to apply persistence itself.</p>
    <p>FireHOL supports mixed mode persistence. For example, you can have something like this:</p>
    <pre><code>dnat to A-B/70,C-D/20,F/10 persistence id mybalancer</code></pre>
    <p>The above is a weighted distribution of persistence. Group A-B will get 70%, C-D 20% and server F 10%.</p>
    <p>Using the above, FireHOL will apply its persistence to pick one of the groups A-B, or C-D, or F. Once the group has been picked by FireHOL, the kernel will apply persistence within the group, to pick the server that will handle the request.</p>
    <p>The FireHOL persistence works like this:</p>
    <ol style="list-style-type: decimal">
      <li>A packet is received that should be NATed</li>
      <li>A lookup is made using the <em>recent</em> module to find if it has been seen before. The source IP of packet is looked up.</li>
      <li>If it has been seen before, the connection is mapped the same way the last time was mapped. The <em>recent</em> module is updated too.</li>
      <li>If it has not been seen before, the connection is mapped using the distribution method specified. The <em>recent</em> module is updated too, to be ready for the next connection.</li>
    </ol>
    <p>The <em>recent</em> module has a few limitations:</p>
    <ol style="list-style-type: decimal">
      <li>
        <p>It has lookup tables. We need one lookup table for each member of of the NAT. FireHOL uses the <code>id</code> parameter and the definition of each alternative in the NAT statement to form a name for the lookup table. These lookup tables are persistent to firewall restarts, this is why FireHOL requires from you to set an <code>id</code>.</p>
      </li>
      <li>
        <p>It can keep entries in its lookup tables for a given time. FireHOL sets this to 3600 seconds. You can control it by setting <code>FIREHOL_NAT_PERSISTENCE_SECONDS</code>.</p>
      </li>
      <li>
        <p>It has a limit on the number of entries in the lookup tables. FireHOL cannot set this. This is kernel module option. The default is 200 entries.</p>
      </li>
    </ol>
    <p>Check this:</p>
    <p>~<sub>~</sub> # modinfo xt_recent filename: /lib/modules/4.1.12-gentoo/kernel/net/netfilter/xt_recent.ko alias: ip6t_recent alias: ipt_recent license: GPL description: Xtables: "recently-seen" host matching author: Jan Engelhardt <a href="mailto:jengelh@medozas.de">jengelh@medozas.de</a> author: Patrick McHardy <a href="mailto:kaber@trash.net">kaber@trash.net</a> depends: x_tables intree: Y vermagic: 4.1.12-gentoo SMP preempt mod_unload modversions parm: ip_list_tot:number of IPs to remember per list (uint) parm: ip_list_hash_size:size of hash table used to look up IPs (uint) parm: ip_list_perms:permissions on /proc/net/xt_recent/* files (uint) parm: ip_list_uid:default owner of /proc/net/xt_recent/* files (uint) parm: ip_list_gid:default owning group of /proc/net/xt_recent/* files (uint) parm: ip_pkt_list_tot:number of packets per IP address to remember (max. 255) (uint) ~<sub>~</sub></p>
    <pre><code>You have to consult your distribution documentation to set these.
You can find their current values by examining files found in
`/sys/module/xt_recent/parameters/` Unfortunately, these files
are not writable, so to change parameters you have unload and
reload the module (i.e. apply a firewall that does not use the
*recent* module, `rmmod xt_recent`, change the parameter,
re-apply a firewall that uses the *recent* module).

Normaly, you will need a line in `/etc/modprobe.d/netfitler.conf`
like this:

~~~~
options xt_recent ip_list_tot=16384
~~~~

The number 16384 I used is the max number of unique client IPs
I expect to have per hour (`FIREHOL_NAT_PERSISTENCE_SECONDS`)
for this service.

`ip_list_hash_size` is calculated by kernel when the module
is loaded to be bigger and up to twice `ip_list_tot`.</code></pre>
    <p>Once you have the balancer running, you can find its lookup tables in <code>/proc/net/xt_recent/</code>. There you will find files starting with the <em>id</em> parameter, one file for every alternative of the NAT rule.</p>
    <h3 id="examples-11">
      <a href="#examples-11">EXAMPLES</a>
    </h3>
    <pre><code>
 # Port forwarding HTTP
 dnat4 to 192.0.2.2 proto tcp dport 80

 # Port forwarding HTTPS on to a different port internally
 dnat4 to 192.0.2.2:4443 proto tcp dport 443

 # Fix source for traffic leaving the firewall via eth0 with private address
 snat4 to 198.51.100.1 outface eth0 src 192.168.0.0/24

 # Transparent squid (running on the firewall) for some hosts
 redirect4 to 8080 inface eth0 src 198.51.100.0/24 proto tcp dport 80

 # Send to 192.0.2.1
 #  - all traffic arriving at or passing through the firewall
 nat4 to-destination 192.0.2.1

 # Send to 192.0.2.1
 #  - all traffic arriving at or passing through the firewall
 #  - which WAS going to 203.0.113.1
 nat4 to-destination 192.0.2.1 dst 203.0.113.1

 # Send to 192.0.2.1
 #  - TCP traffic arriving at or passing through the firewall
 #  - which WAS going to 203.0.113.1
 nat4 to-destination 192.0.2.1 proto tcp dst 203.0.113.1

 # Send to 192.0.2.1
 #  - TCP traffic arriving at or passing through the firewall
 #  - which WAS going to 203.0.113.1, port 25
 nat4 to-destination 192.0.2.1 proto tcp dport 25 dst 203.0.113.1</code></pre>
    <h3 id="see-also-18">
      <a href="#see-also-18">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-masquerade5">firehol-masquerade(5)</a> - masquerade helper</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO-6.html">NAT HOWTO</a>
      </li>
      <li>
        <a href="http://upload.wikimedia.org/wikipedia/commons/3/37/Netfilter-packet-flow.svg">netfilter flow diagram</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-params5">
      <a href="#firehol-params5">firehol-params(5)</a>
    </h2>
    <h3 id="name-19">
      <a href="#name-19">NAME</a>
    </h3>
    <p>firehol-params - optional rule parameters</p>
<!--
extra-manpage: firehol-src.5
extra-manpage: firehol-src4.5
extra-manpage: firehol-src6.5
extra-manpage: firehol-dst.5
extra-manpage: firehol-dst4.5
extra-manpage: firehol-dst6.5
extra-manpage: firehol-srctype.5
extra-manpage: firehol-dsttype.5
extra-manpage: firehol-dport.5
extra-manpage: firehol-sport.5
extra-manpage: firehol-inface.5
extra-manpage: firehol-outface.5
extra-manpage: firehol-physin.5
extra-manpage: firehol-physout.5
extra-manpage: firehol-custom.5
extra-manpage: firehol-log.5
extra-manpage: firehol-loglimit.5
extra-manpage: firehol-proto.5
extra-manpage: firehol-uid.5
extra-manpage: firehol-gid.5
extra-manpage: firehol-mac-param.5
extra-manpage: firehol-mark-param.5
extra-manpage: firehol-tos-param.5
extra-manpage: firehol-dscp-param.5
extra-manpage: firehol-dport.5
extra-manpage: firehol-sport.5
-->
    <h3 id="synopsis-18">
      <a href="#synopsis-18">SYNOPSIS</a>
    </h3>
    <p>
      <em>Common</em>
    </p>
    <p>{ src | src4 | src6 } [not] <em>host</em></p>
    <p>{ dst | dst4 | dst6 } [not] <em>host</em></p>
    <p>srctype [not] <em>type</em></p>
    <p>dsttype [not] <em>type</em></p>
    <p>proto [not] <em>protocol</em></p>
    <p>mac [not] <em>macaddr</em></p>
    <p>dscp [not] <em>value</em> <em>class</em> <em>classid</em></p>
    <p>mark [not] <em>id</em></p>
    <p>connmark [not] <em>id</em></p>
    <p>custommark [not] <em>name</em> <em>id</em></p>
    <p>rawmark [not] <em>id</em></p>
    <p>tos [not] <em>id</em></p>
    <p>custom "<em>iptables-options</em>..."</p>
    <p>custom-in "<em>iptables-options</em>..."</p>
    <p>custom-out "<em>iptables-options</em>..."</p>
    <p>
      <em>Router Only</em>
    </p>
    <p>inface [not] <em>interface</em></p>
    <p>outface [not] <em>interface</em></p>
    <p>physin [not] <em>interface</em></p>
    <p>physout [not] <em>interface</em></p>
    <p>
      <em>Interface Only</em>
    </p>
    <p>uid [not] <em>user</em></p>
    <p>gid [not] <em>group</em></p>
    <p>
      <em>Logging</em>
    </p>
    <p>connlog "log text"</p>
    <p>log "log text" [level <em>loglevel</em>]</p>
    <p>loglimit "log text" [level <em>loglevel</em>]</p>
    <p>
      <em>Helpers Only</em>
    </p>
    <p>sport <em>port</em></p>
    <p>dport <em>port</em></p>
    <p>state <em>state</em></p>
    <p>ipset [not] name flags [no-counters] [bytes-lt|bytes-eq|bytes-gt|bytes-not-eq <em>number</em>] [packets-lt|packets-eq|packets-gt|packets-not-eq <em>number</em>] [options <em>custom-ipset-options</em>]</p>
    <p>limit <em>limit</em> <em>burst</em></p>
    <p>connlimit upto|above <em>limit</em> [mask <em>mask</em>] [saddr|daddr]</p>
    <p>hashlimit <em>name</em> upto|above <em>amount/period</em> [burst <em>amount</em>] [mode <em>{srcip|srcport|dstip|dstport},...</em>] [srcmask <em>prefix</em>] [dstmask <em>prefix</em>] [htable-size <em>buckets</em>] [htable-max <em>entries</em>] [htable-expire <em>msec</em>] [htable-gcinterval <em>msec</em>]</p>
    <h3 id="description-19">
      <a href="#description-19">DESCRIPTION</a>
    </h3>
    <p>Optional rule parameters are accepted by many commands to narrow the match they make. Not all parameters are accepted by all commands so you should check the individual commands for exclusions.</p>
    <p>All matches are made against the REQUEST. FireHOL automatically sets up the necessary stateful rules to deal with replies in the reverse direction.</p>
    <p>All matches should be true for a statement to be executed. However, many matches support multiple values. In this case, at least one of the values must match.</p>
    <p>Example:</p>
    <pre><code>server smtp accept src 1.1.1.1 dst 2.2.2.2</code></pre>
    <p>In the above example all smtp requests coming in from 1.1.1.1 and going out to smtp server 2.2.2.2 will be matched.</p>
    <pre><code>server smtp accept src 1.1.1.1 dst 2.2.2.2,3.3.3.3</code></pre>
    <p>In the above example all smtp requests coming in from 1.1.1.1 and going out to either smtp server 2.2.2.2 or 3.3.3.3 will be matched.</p>
    <p>Use the keyword <code>not</code> to match any value other than the one(s) specified.</p>
    <p>The logging parameters are unusual in that they do not affect the match, they just cause a log message to be emitted. Therefore, the logging parameters don't support the <code>not</code> option.</p>
    <p>FireHOL is designed so that if you specify a parameter that is also used internally by the command then a warning will be issued (and the internal version will be used).</p>
    <h3 id="common">
      <a href="#common">COMMON</a>
    </h3>
    <h4 id="src-dst">
      <a href="#src-dst">src, dst</a>
    </h4>
    <p>Use <code>src</code> and <code>dst</code> to define the source and destination IP addresses of the request respectively. <em>host</em> defines the IP or IPs to be matched.</p>
    <p><em>host</em> can also refer to an ipset, using this syntax: <code>ipset:NAME</code>, where NAME is the name of the ipset. The ipset has to be of type <code>hash:ip</code> for this match to work. The source IP or the destination IP will be used for the match, depending if the ipset is given as <code>src</code> or <code>dst</code>.</p>
    <p>IPs and ipsets can be mixed together, like this: <code>src 1.1.1.1,ipset:NAME1,2.2.2.2,ipset:NAME2</code></p>
    <p>Examples:</p>
    <pre><code>server4 smtp accept src not 192.0.2.1
server4 smtp accept dst 198.51.100.1
server4 smtp accept src not 192.0.2.1 dst 198.51.100.1
server6 smtp accept src not 2001:DB8:1::/64
server6 smtp accept dst 2001:DB8:2::/64
server6 smtp accept src not 2001:DB8:1::/64 dst 2001:DB8:2::/64</code></pre>
    <p>When attempting to create rules for both IPv4 and IPv6 it is generally easier to use the <code>src4</code>, <code>src6</code>, <code>dst4</code> and <code>dst6</code> pairs:</p>
    <pre><code>server46 smtp accept src4 192.0.2.1 src6 2001:DB8:1::/64
server46 smtp accept dst4 198.51.100.1 dst6 2001:DB8:2::/64
server46 smtp accept dst4 $d4 dst6 $d6 src4 not $d4 src6 not $s6</code></pre>
    <p>To keep the rules sane, if one of the 4/6 pair specifies <code>not</code>, then so must the other. If you do not want to use both IPv4 and IPv6 addresses, you must specify the rule as IPv4 or IPv6 only. It is always possible to write a second IPv4 or IPv6 only rule.</p>
    <h4 id="srctype-dsttype">
      <a href="#srctype-dsttype">srctype, dsttype</a>
    </h4>
    <p>Use <code>srctype</code> or <code>dsttype</code> to define the source or destination IP address type of the request. <em>type</em> is the address type category as used in the kernel's network stack. It can be one of:</p>
    <dl>
      <dt>UNSPEC</dt>
      <dd>
        <p>an unspecified address (i.e. 0.0.0.0)</p>
      </dd>
      <dt>UNICAST</dt>
      <dd>
        <p>a unicast address</p>
      </dd>
      <dt>LOCAL</dt>
      <dd>
        <p>a local address</p>
      </dd>
      <dt>BROADCAST</dt>
      <dd>
        <p>a broadcast address</p>
      </dd>
      <dt>ANYCAST</dt>
      <dd>
        <p>an anycast address</p>
      </dd>
      <dt>MULTICAST</dt>
      <dd>
        <p>a multicast address</p>
      </dd>
      <dt>BLACKHOLE</dt>
      <dd>
        <p>a blackhole address</p>
      </dd>
      <dt>UNREACHABLE</dt>
      <dd>
        <p>an unreachable address</p>
      </dd>
      <dt>PROHIBIT</dt>
      <dd>
        <p>a prohibited address</p>
      </dd>
      <dt>THROW; NAT; XRESOLVE</dt>
      <dd>
        <p>undocumented</p>
      </dd>
    </dl>
    <p>See iptables(8) or run <code>iptables -m addrtype --help</code> for more information. Examples:</p>
    <pre><code>server smtp accept srctype not "UNREACHABLE PROHIBIT"
    </code></pre>
    <h4 id="proto">
      <a href="#proto">proto</a>
    </h4>
    <p>Use <code>proto</code> to match by protocol. The <em>protocol</em> can be any accepted by iptables(8).</p>
    <h4 id="mac">
      <a href="#mac">mac</a>
    </h4>
    <p>Use <code>mac</code> to match by MAC address. The <em>macaddr</em> matches to the "remote" host. In an <code>interface</code>, "remote" always means the non-local host. In a <code>router</code>, "remote" refers to the source of requests for <code>server</code>s. It refers to the destination of requests for <code>client</code>s. Examples:</p>
    <pre><code> # Only allow pop3 requests to the e6 host
 client pop3 accept mac 00:01:01:00:00:e6

 # Only allow hosts other than e7/e8 to access smtp
 server smtp accept mac not "00:01:01:00:00:e7 00:01:01:00:00:e8"</code></pre>
    <h4 id="dscp">
      <a href="#dscp">dscp</a>
    </h4>
    <p>Use <code>dscp</code> to match the DSCP field on packets. For details on DSCP values and classids, see <a href="#firehol-dscp5">firehol-dscp(5)</a>.</p>
    <pre><code> server smtp accept dscp not "0x20 0x30"
 server smtp accept dscp not class "BE EF"</code></pre>
    <h4 id="mark">
      <a href="#mark">mark</a>
    </h4>
    <p>Use <code>mark</code> to match marks set on packets. For details on mark ids, see <a href="#firehol-mark5">firehol-mark(5)</a>.</p>
    <pre><code>server smtp accept mark not "20 55"
    </code></pre>
    <h4 id="tos">
      <a href="#tos">tos</a>
    </h4>
    <p>Use <code>tos</code> to match the TOS field on packets. For details on TOS ids, see <a href="#firehol-tos5">firehol-tos(5)</a>.</p>
    <pre><code>server smtp accept tos not "Maximize-Throughput 0x10"
    </code></pre>
    <h4 id="custom">
      <a href="#custom">custom</a>
    </h4>
    <p>Use <code>custom</code> to pass arguments directly to iptables(8). All of the parameters must be in a single quoted string. To pass an option to iptables(8) that itself contains a space you need to quote strings in the usual bash(1) manner. For example:</p>
    <pre><code>server smtp accept custom "--some-option some-value"
server smtp accept custom "--some-option 'some-value second-value'"</code></pre>
    <h3 id="router-only">
      <a href="#router-only">ROUTER ONLY</a>
    </h3>
    <h4 id="inface-outface">
      <a href="#inface-outface">inface, outface</a>
    </h4>
    <p>Use <code>inface</code> and <code>outface</code> to define the <em>interface</em> via which a request is received and forwarded respectively. Use the same format as <a href="#firehol-interface5">firehol-interface(5)</a>. Examples:</p>
    <pre><code>server smtp accept inface not eth0
server smtp accept inface not "eth0 eth1"
server smtp accept inface eth0 outface eth1</code></pre>
    <h4 id="physin-physout">
      <a href="#physin-physout">physin, physout</a>
    </h4>
    <p>Use <code>physin</code> and <code>physout</code> to define the physical <em>interface</em> via which a request is received or send in cases where the inface or outface is known to be a virtual interface; e.g. a bridge. Use the same format as <a href="#firehol-interface5">firehol-interface(5)</a>. Examples:</p>
    <pre><code>server smtp accept physin not eth0
    </code></pre>
    <h3 id="interface-only">
      <a href="#interface-only">INTERFACE ONLY</a>
    </h3>
    <p>These parameters match information related to information gathered from the local host. They apply only to outgoing packets and are silently ignored for incoming requests and requests that will be forwarded.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>The Linux kernel infrastructure to match PID/SID and executable names with <code>pid</code>, <code>sid</code> and <code>cmd</code> has been removed so these options can no longer be used.</p>
    </blockquote>
    <h4 id="uid">
      <a href="#uid">uid</a>
    </h4>
    <p>Use <code>uid</code> to match the operating system user sending the traffic. The <em>user</em> is a username, uid number or a quoted list of the two.</p>
    <p>For example, to limit which users can access POP3 and IMAP by preventing replies for certain users from being sent:</p>
    <pre><code>client "pop3 imap" accept user not "user1 user2 user3"
    </code></pre>
    <p>Similarly, this will allow all requests to reach the server but prevent replies unless the web server is running as apache:</p>
    <pre><code>server http accept user apache
    </code></pre>
    <h4 id="gid">
      <a href="#gid">gid</a>
    </h4>
    <p>Use <code>gid</code> to match the operating system group sending the traffic. The <em>group</em> is a group name, gid number or a quoted list of the two.</p>
    <h3 id="logging">
      <a href="#logging">LOGGING</a>
    </h3>
    <h4 id="connlog">
      <a href="#connlog">connlog</a>
    </h4>
    <p>Use <code>connlog</code> to log only the first packet of a connection.</p>
    <h4 id="log-loglimit">
      <a href="#log-loglimit">log, loglimit</a>
    </h4>
    <p>Use <code>log</code> or <code>loglimit</code> to log matching packets to syslog. Unlike iptables(8) logging, this is not an action: FireHOL will produce multiple iptables(8) commands to accomplish both the action for the rule and the logging.</p>
    <p>Logging is controlled using the FIREHOL_LOG_OPTIONS and FIREHOL_LOG_LEVEL environment variables - see <a href="#firehol-variables5">firehol-variables(5)</a>. <code>loglimit</code> additionally honours the FIREHOL_LOG_FREQUENCY and FIREHOL_LOG_BURST variables.</p>
    <p>Specifying <code>level</code> (which takes the same values as FIREHOL_LOG_LEVEL) allows you to override the log level for a single rule.</p>
    <h3 id="helpers-only-parameters">
      <a href="#helpers-only-parameters">HELPERS ONLY PARAMETERS</a>
    </h3>
    <h4 id="dport-sport">
      <a href="#dport-sport">dport, sport</a>
    </h4>
    <p>FireHOL also provides <code>dport</code>, <code>sport</code> and <code>limit</code> which are used internally and rarely needed within configuration files.</p>
    <p><code>dport</code> and <code>sport</code> require an argument <em>port</em> which can be a name, number, range (FROM:TO) or a quoted list of ports.</p>
    <p>For <code>dport</code> <em>port</em> specifies the destination port of a request and can be useful when matching traffic to helper commands (such as nat) where there is no implicit port.</p>
    <p>For <code>sport</code> <em>port</em> specifies the source port of a request and can be useful when matching traffic to helper commands (such as nat) where there is no implicit port.</p>
    <h4 id="limit">
      <a href="#limit">limit</a>
    </h4>
    <p><code>limit</code> requires the arguments <em>frequency</em> and <em>burst</em> and will limit the matching of traffic in both directions.</p>
    <h4 id="connlimit">
      <a href="#connlimit">connlimit</a>
    </h4>
    <p><code>connlimit</code> matches on the number of connections per IP. It has been added to FireHOL since v3.</p>
    <p><em>saddr</em> matches on source IP. <em>daddr</em> matches on destination IP. <em>mask</em> groups IPs with the <em>mask</em> given <em>upto</em> matches when the number of connections is up to the given <em>limit</em> <em>above</em> matches when the number of connections above to the given <em>limit</em></p>
    <p>The number of connections counted are system wide, not service specific. For example for <em>saddr</em>, you cannot connlimit 2 connections for SSH and 4 for SMTP. If you connlimit 2 connections for SSH, then the first 2 connections of a client can be SSH. If a client has already 2 connections to another service, the client will not be able to connect to SSH.</p>
    <p>So, <code>connlimit</code> can safely be used:</p>
    <ul>
      <li>with <em>daddr</em> to limit the connections a server can accept</li>
      <li>with <em>saddr</em> to limit the total connections per client to all services.</li>
    </ul>
    <h4 id="hashlimit">
      <a href="#hashlimit">hashlimit</a>
    </h4>
    <p><code>hashlimit</code> has been added to FireHOL since v3.</p>
    <p><code>hashlimit</code> hashlimit uses hash buckets to express a rate limiting match (like the limit match) for a group of connections using a single iptables rule. Grouping can be done per-hostgroup (source and/or destination address) and/or per-port. It gives you the ability to express "N packets per time quantum per group" or "N bytes per seconds" (see below for some examples).</p>
    <p>A hash limit type (<code>upto</code>, <code>above</code>) and <em>name</em> are required.</p>
    <p><em>name</em> The name for the /proc/net/ipt_hashlimit/<em>name</em> entry.</p>
    <p><code>upto</code><em>amount[/second|/minute|/hour|/day]</em> Match if the rate is below or equal to amount/quantum. It is specified either as a number, with an optional time quantum suffix (the default is 3/hour), or as amountb/second (number of bytes per second).</p>
    <p><code>above</code><em>amount[/second|/minute|/hour|/day]</em> Match if the rate is above amount/quantum.</p>
    <p><code>burst</code><em>amount</em> Maximum initial number of packets to match: this number gets recharged by one every time the limit specified above is not reached, up to this number; the default is 5. When byte-based rate matching is requested, this option specifies the amount of bytes that can exceed the given rate. This option should be used with caution - if the entry expires, the burst value is reset too.</p>
    <p><code>mode</code><em>{srcip|srcport|dstip|dstport},...</em> A comma-separated list of objects to take into consideration. If no <code>mode</code> option is given, <em>srcip,dstport</em> is assumed.</p>
    <p><code>srcmask</code><em>prefix</em> When --hashlimit-mode srcip is used, all source addresses encountered will be grouped according to the given prefix length and the so-created subnet will be subject to hashlimit. prefix must be between (inclusive) 0 and 32. Note that <code>srcmask</code> <em>0</em> is basically doing the same thing as not specifying srcip for <code>mode</code>, but is technically more expensive.</p>
    <p><code>dstmask</code><em>prefix</em> Like <code>srcmask</code>, but for destination addresses.</p>
    <p><code>htable-size</code><em>buckets</em> The number of buckets of the hash table</p>
    <p><code>htable-max</code><em>entries</em> Maximum entries in the hash.</p>
    <p><code>htable-expire</code><em>msec</em> After how many milliseconds do hash entries expire.</p>
    <p><code>htable-gcinterval</code><em>msec</em> How many milliseconds between garbage collection intervals.</p>
    <p>Examples:</p>
    <p>matching on source host: "1000 packets per second for every host in 192.168.0.0/16"</p>
    <pre><code>src 192.168.0.0/16 hashlimit mylimit mode srcip upto 1000/sec</code></pre>
    <p>matching on source port: "100 packets per second for every service of 192.168.1.1"</p>
    <pre><code>src 192.168.1.1 hashlimit mylimit mode srcport upto 100/sec</code></pre>
    <p>matching on subnet: "10000 packets per minute for every /28 subnet (groups of 8 addresses) in 10.0.0.0/8"</p>
    <pre><code>src 10.0.0.8 hashlimit mylimit mask 28 upto 10000/min</code></pre>
    <p>matching bytes per second: "flows exceeding 512kbyte/s"</p>
    <pre><code>hashlimit mylimit mode srcip,dstip,srcport,dstport above 512kb/s</code></pre>
    <p>matching bytes per second: "hosts that exceed 512kbyte/s, but permit up to 1Megabytes without matching"</p>
    <pre><code>hashlimit mylimit mode dstip above 512kb/s burst 1mb</code></pre>
    <h3 id="see-also-19">
      <a href="#see-also-19">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-server5">firehol-server(5)</a> - server, route commands</li>
      <li><a href="#firehol-client5">firehol-client(5)</a> - client command</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-mark5">firehol-mark(5)</a> - mark config helper</li>
      <li><a href="#firehol-tos5">firehol-tos(5)</a> - tos config helper</li>
      <li><a href="#firehol-dscp5">firehol-dscp(5)</a> - dscp config helper</li>
      <li><a href="#firehol-variables5">firehol-variables(5)</a> - control variables</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-policy5">
      <a href="#firehol-policy5">firehol-policy(5)</a>
    </h2>
    <h3 id="name-20">
      <a href="#name-20">NAME</a>
    </h3>
    <p>firehol-policy - set default action for an interface or router</p>
<!--
contents-table:subcommand:policy:keyword-firehol-policy:N:*all forbidden*:Define the action to be applied on packets not matched by any `server` or `client` statements in the `interface` or `router`.
  -->
    <h3 id="synopsis-19">
      <a href="#synopsis-19">SYNOPSIS</a>
    </h3>
    <p>policy <em>action</em></p>
    <h3 id="description-20">
      <a href="#description-20">DESCRIPTION</a>
    </h3>
    <p>The <code>policy</code> subcommand defines the default policy for an interface or router.</p>
    <p>The <em>action</em> can be any of the actions listed in <a href="#firehol-actions5">firehol-actions(5)</a>.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>Change the default policy of a router only if you understand clearly what will be matched by the router statement whose policy is being changed.</p>
      <p>It is common to define overlapping router definitions. Changing the policy to anything other than the default <code>return</code> may cause strange results for your configuration.</p>
    </blockquote>
    <blockquote>
      <p>
        <strong>Warning</strong>
      </p>
      <p>Do not set a policy to <code>accept</code> unless you fully trust all hosts that can reach the interface. FireHOL CANNOT be used to create valid "accept by default" firewalls.</p>
    </blockquote>
    <h3 id="example">
      <a href="#example">EXAMPLE</a>
    </h3>
    <pre><code>
interface eth0 intranet src 192.0.2.0/24
  # I trust this interface absolutely
  policy accept</code></pre>
    <h3 id="see-also-20">
      <a href="#see-also-20">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-protection5">
      <a href="#firehol-protection5">firehol-protection(5)</a>
    </h2>
    <h3 id="name-21">
      <a href="#name-21">NAME</a>
    </h3>
    <p>firehol-protection - add extra protections to a definition</p>
<!--
contents-table:subcommand:protection:keyword-firehol-protection:N:*all forbidden*:Examine incoming packets per `interface` or `router` and filter out bad packets or limit request frequency.
  -->
    <h3 id="synopsis-20">
      <a href="#synopsis-20">SYNOPSIS</a>
    </h3>
    <p>protection [reverse] strong [<em>requests/period</em> [<em>burst</em>]]</p>
    <p>protection [reverse] <em>flood-protection-type</em> [<em>requests/period</em> [<em>burst</em>]]</p>
    <p>protection [reverse] { bad-packets | <em>packet-protection-type</em> }</p>
    <p>protection [reverse] connlimit <em>connections</em> [mask <em>prefix</em>]</p>
    <p>protection [reverse] connrate <em>rate</em> [burst <em>amount</em>] [srcmask <em>prefix</em>] [htable-size <em>buckets</em>] [htable-max <em>entries</em>] [htable-expire <em>msec</em>] [htable-gcinterval <em>msec</em>]</p>
    <h3 id="description-21">
      <a href="#description-21">DESCRIPTION</a>
    </h3>
    <p>The <code>protection</code> subcommand sets protection rules on an interface or router.</p>
    <p>Flood protections honour the values <em>requests/period</em> and <em>burst</em>. They are used to limit the rate of certain types of traffic.</p>
    <p>The default rate FireHOL uses is 100 operations per second with a burst of 50. Run <code>iptables -m limit --help</code> for more information.</p>
    <p>The protection type <code>strong</code> will switch on all protections (both packet and flood protections) except <code>all-floods</code>. It has aliases <code>full</code> and <code>all</code>.</p>
    <p>The protection type <code>bad-packets</code> will switch on all packet protections but not flood protections.</p>
    <p>You can specify multiple protection types by using multiple <code>protection</code> commands or by using a single command and enclosing the types in quotes.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>On a router, protections are normally set up on inface.</p>
      <p>The <code>reverse</code> option will set up the protections on outface. You must use it as the first keyword.</p>
    </blockquote>
    <h3 id="packet-protection-types">
      <a href="#packet-protection-types">PACKET PROTECTION TYPES</a>
    </h3>
    <dl>
      <dt>bad-packets:</dt>
      <dd>
        <p>Drops all the bad packets detected by these rules.</p>
      </dd>
      <dt>invalid</dt>
      <dd>
        <p>Drops all incoming invalid packets, as detected INVALID by the connection tracker.</p>
        <p>See also FIREHOL_DROP_INVALID in <a href="#firehol-variables5">firehol-variables(5)</a> which allows setting this function globally.</p>
      </dd>
      <dt>fragments</dt>
      <dd>
        <p>Drops all packet fragments.</p>
        <p>This rule will probably never match anything since iptables(8) reconstructs all packets automatically before the firewall rules are processed whenever connection tracking is running.</p>
      </dd>
      <dt>new-tcp-w/o-syn</dt>
      <dd>
        <p>Drops all TCP packets that initiate a socket but have not got the SYN flag set.</p>
      </dd>
      <dt>malformed-xmas</dt>
      <dd>
        <p>Drops all TCP packets that have all TCP flags set.</p>
      </dd>
      <dt>malformed-null</dt>
      <dd>
        <p>Drops all TCP packets that have all TCP flags unset.</p>
      </dd>
      <dt>malformed-bad</dt>
      <dd>
        <p>Drops all TCP packets that have illegal combinations of TCP flags set.</p>
      </dd>
    </dl>
    <h4 id="examples-12">
      <a href="#examples-12">EXAMPLES</a>
    </h4>
    <pre><code>protection bad-packets</code></pre>
    <h3 id="flood-protection-types">
      <a href="#flood-protection-types">FLOOD PROTECTION TYPES</a>
    </h3>
    <dl>
      <dt>icmp-floods [<em>requests/period</em> [<em>burst</em>]]</dt>
      <dd>
        <p>Allows only a certain amount of ICMP echo requests.</p>
      </dd>
      <dt>syn-floods [<em>requests/period</em> [<em>burst</em>]]</dt>
      <dd>
        <p>Allows only a certain amount of new TCP connections.</p>
        <p>Be careful to not set the rate too low as the rule is applied to all connections regardless of their final result (rejected, dropped, established, etc).</p>
      </dd>
      <dt>all-floods [<em>requests/period</em> [<em>burst</em>]]</dt>
      <dd>
        <p>Allows only a certain amount of new connections.</p>
        <p>Be careful to not set the rate too low as the rule is applied to all connections regardless of their final result (rejected, dropped, established, etc).</p>
      </dd>
    </dl>
    <h4 id="examples-13">
      <a href="#examples-13">EXAMPLES</a>
    </h4>
    <pre><code>protection all-floods 90/sec 40</code></pre>
    <h3 id="client-limiting-types">
      <a href="#client-limiting-types">CLIENT LIMITING TYPES</a>
    </h3>
    <p>These protections were added in v3.</p>
    <p>These protections are used to limit the connections client make, per <code>interface</code> or <code>router</code>.</p>
    <p>They support appending <code>optional rule parameters</code> to limit their scope to certain clients only.</p>
    <dl>
      <dt>protection [reverse] connlimit <em>connections</em> [mask <em>prefix</em>]</dt>
      <dd>
        <p>Allow only a number of connections per client (implemented with <code>connlimit</code> with fixed type=<em>saddr</em>).</p>
      </dd>
      <dt>protection [reverse] connrate <em>rate</em> [burst <em>amount</em>] [srcmask <em>prefix</em>] [htable-size <em>buckets</em>] [htable-max <em>entries</em>] [htable-expire <em>msec</em>] [htable-gcinterval <em>msec</em>]</dt>
      <dd>
        <p>Allow up to a rate of new connections per client (implemented with <code>hashlimit</code> with fixed type=<em>upto</em> and mode=<em>srcip</em>).</p>
      </dd>
    </dl>
    <h4 id="examples-14">
      <a href="#examples-14">EXAMPLES</a>
    </h4>
    <p>Limit the number of concurrent connections to 10 per client</p>
    <pre><code>protection connlimit 10 mask 32</code></pre>
    <p>Limit the number of concurrent connections to 100 per client class-C and also limit it to 5 for 1.2.3.4</p>
    <pre><code>protection connlimit 100 mask 24
protection connlimit 5 src 1.2.3.4</code></pre>
    <p>In the last example above, if you want to give client 1.2.3.4 more connections than all others, you should exclude it from the first connlimit statement, like this:</p>
    <pre><code>protection connlimit 100 mask 24 src not 1.2.3.4
protection connlimit 200 src 1.2.3.4</code></pre>
    <p>Limit all clients to 10 concurrect connections and 60 connections/minute</p>
    <pre><code>protection connlimit 10
protection connrate 60/minute</code></pre>
    <h3 id="known-issues">
      <a href="#known-issues">KNOWN ISSUES</a>
    </h3>
    <p>When using multiple types in a single command, if the quotes are forgotten, incorrect rules will be generated without warning.</p>
    <p>When using multiple types in a single command, FireHOL will silently ignore any types that come after a group type (<code>bad-packets</code>, <code>strong</code> and its aliases). Only use group types on their own line.</p>
    <h3 id="see-also-21">
      <a href="#see-also-21">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-proxy5">
      <a href="#firehol-proxy5">firehol-proxy(5)</a>
    </h2>
    <h3 id="name-22">
      <a href="#name-22">NAME</a>
    </h3>
    <p>firehol-proxy - set up a transparent TCP, HTTP or squid proxy</p>
<!--
extra-manpage: firehol-transparent_proxy.5
extra-manpage: firehol-transparent_squid.5

contents-table:helper:transparent_proxy:keyword-firehol-transparent_proxy:Y:*see notes*:Set up a transparent TCP, HTTP or squid proxy.
  -->
    <h3 id="synopsis-21">
      <a href="#synopsis-21">SYNOPSIS</a>
    </h3>
    <p>transparent_proxy <em>service</em> <em>port</em> <em>user</em> <em>rule-params</em></p>
    <p>transparent_squid <em>port</em> <em>user</em> <em>rule-params</em></p>
    <h3 id="description-22">
      <a href="#description-22">DESCRIPTION</a>
    </h3>
    <p>The <code>transparent_proxy</code> helper command sets up transparent caching for TCP traffic.</p>
    <p>The <code>transparent_squid</code> helper command sets up the special case for HTTP traffic with <em>service</em> implicitly set to 80.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>The proxy application must be running on the firewall host at port <em>port</em> with the credentials of the local user <em>user</em> (which may be a space-delimited list enclosed in quotes) serving requests appropriate to the TCP port service.</p>
    </blockquote>
    <p>The <em>rule-params</em> define a set of rule parameters to define the traffic that is to be proxied. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <p>For traffic destined for the firewall host or passing through the firewall, do not use the <code>outface</code> parameter because the rules are applied before the routing decision and so the outgoing interface will not be known.</p>
    <p>An empty <em>user</em> string ("") disables caching of locally-generated traffic. Otherwise, traffic starting from the firewall is captured, except that traffic generated by the local user(s) <em>user</em>. The <code>inface</code>, <code>outface</code> and <code>src</code> <em>rule-params</em> are all ignored for locally-generated traffic.</p>
    <h3 id="examples-15">
      <a href="#examples-15">EXAMPLES</a>
    </h3>
    <pre><code>
transparent_proxy 80 3128 squid inface eth0 src 192.0.2.0/24
transparent_squid 3128 squid inface eth0 src 192.0.2.0/24

transparent_proxy "80 3128 8080" 3128 "squid privoxy root bin" \
      inface not "ppp+ ipsec+" dst not "a.not.proxied.server"
transparent_squid "80 3128 8080" "squid privoxy root bin" \
      inface not "ppp+ ipsec+" dst not "non.proxied.server"</code></pre>
    <h3 id="see-also-22">
      <a href="#see-also-22">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-nat5">firehol-nat(5)</a> - nat, snat, dnat, redirect config helpers</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-router5">
      <a href="#firehol-router5">firehol-router(5)</a>
    </h2>
    <h3 id="name-23">
      <a href="#name-23">NAME</a>
    </h3>
    <p>firehol-router - create a router definition</p>
<!--
contents-table:primary:router:keyword-firehol-router:Y:-:Define packet filtering blocks, protecting other hosts from routed traffic.
  -->
    <h3 id="synopsis-22">
      <a href="#synopsis-22">SYNOPSIS</a>
    </h3>
    <p>{ router | router46 } <em>name</em> <em>rule-params</em></p>
    <p>router4 <em>name</em> <em>rule-params</em></p>
    <p>router6 <em>name</em> <em>rule-params</em></p>
<!--
extra-manpage: firehol-router46.5
extra-manpage: firehol-router4.5
extra-manpage: firehol-router6.5
  -->
    <h3 id="description-23">
      <a href="#description-23">DESCRIPTION</a>
    </h3>
    <p>A <code>router</code> definition consists of a set of rules for traffic passing through the host running the firewall.</p>
    <p>The default policy for router definitions is RETURN, meaning packets are not dropped by any particular router. Packets not matched by any router are dropped at the end of the firewall.</p>
    <p>The behaviour of the defined router is controlled by adding subcommands from those listed in <a href="#router-subcommands">ROUTER SUBCOMMANDS</a>.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>Writing <code>router4</code> is equivalent to writing <code>ipv4 router</code> and ensures the defined router is created only in the IPv4 firewall along with any rules within it.</p>
      <p>Writing <code>router6</code> is equivalent to writing <code>ipv6 router</code> and ensures the defined router is created only in the IPv6 firewall along with any rules within it.</p>
      <p>Writing <code>router46</code> is equivalent to writing <code>both router</code> and ensures the defined router is created in both the IPv4 and IPv6 firewalls. Any rules within it will also be applied to both, unless they specify otherwise.</p>
    </blockquote>
    <h3 id="parameters-1">
      <a href="#parameters-1">PARAMETERS</a>
    </h3>
    <dl>
      <dt>
        <em>name</em>
      </dt>
      <dd>
        <p>This is a name for this router. You should use short names (10 characters maximum) without spaces or other symbols.</p>
        <p>A name should be unique for all FireHOL interface and router definitions.</p>
      </dd>
      <dt>
        <em>rule-params</em>
      </dt>
      <dd>
        <p>The set of rule parameters to further restrict the traffic that is matched to this router.</p>
        <p>See <a href="#firehol-params5">firehol-params(5)</a> for information on the parameters that can be used. Some examples:</p>
        <pre><code>router mylan inface ppp+ outface eth0 src not ${UNROUTABLE_IPS}

router myrouter</code></pre>
        <p>See <a href="#firehol.conf5">firehol.conf(5)</a> for an explanation of ${UNROUTABLE_IPS}.</p>
      </dd>
    </dl>
    <h3 id="working-with-routers">
      <a href="#working-with-routers">WORKING WITH ROUTERS</a>
    </h3>
    <p>Routers create stateful iptables(8) rules which match traffic in both directions.</p>
    <p>To match some client or server traffic, the input/output interface or source/destination of the request must be specified. All <code>inface</code>/<code>outface</code> and <code>src</code>/<code>dst</code> <a href="#firehol-params5">firehol-params(5)</a> can be given on the router statement (in which case they will be applied to all subcommands for the router) or just within the subcommands of the router.</p>
    <p>For example, to define a router which matches requests from any PPP interface and destined for eth0, and on this allowing HTTP servers (on eth0) to be accessed by clients (from PPP) and SMTP clients (from eth0) to access any servers (on PPP):</p>
    <pre><code>router mylan inface ppp+ outface eth0
  server http accept
  client smtp accept</code></pre>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>The <code>client</code> subcommand reverses any optional rule parameters passed to the <code>router</code>, in this case the <code>inface</code> and <code>outface</code>.</p>
    </blockquote>
    <p>Equivalently, to define a router which matches all forwarded traffic and within the the router allow HTTP servers on eth0 to be accessible to PPP and any SMTP servers on PPP to be accessible from eth0:</p>
    <pre><code>router mylan
  server http accept inface ppp+ outface eth0
  server smtp accept inface eth0 outface ppp</code></pre>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>In this instance two <code>server</code> subcommands are used since there are no parameters on the <code>router</code> to reverse. Avoid the use of the <code>client</code> subcommand in routers unless the inputs and outputs are defined as part of the <code>router</code>.</p>
    </blockquote>
    <p>Any number of routers can be defined and the traffic they match can overlap. Since the default policy is RETURN, any traffic that is not matched by any rules in one will proceed to the next, in order, until none are left.</p>
    <h3 id="see-also-23">
      <a href="#see-also-23">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-modifiers5">firehol-modifiers(5)</a> - ipv4/ipv6 selection</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-iptables5">firehol-iptables(5)</a> - iptables helper</li>
      <li><a href="#firehol-masquerade5">firehol-masquerade(5)</a> - masquerade helper</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <h4 id="router-subcommands">
      <a href="#router-subcommands">Router Subcommands</a>
    </h4>
    <ul>
      <li><a href="#firehol-policy5">firehol-policy(5)</a> - policy command</li>
      <li><a href="#firehol-protection5">firehol-protection(5)</a> - protection command</li>
      <li><a href="#firehol-server5">firehol-server(5)</a> - server, route commands</li>
      <li><a href="#firehol-client5">firehol-client(5)</a> - client command</li>
      <li><a href="#firehol-group5">firehol-group(5)</a> - group command</li>
      <li><a href="#firehol-tcpmss5">firehol-tcpmss(5)</a> - tcpmss helper</li>
    </ul>
    <p></p>
    <h2 id="firehol-server5">
      <a href="#firehol-server5">firehol-server(5)</a>
    </h2>
    <h3 id="name-24">
      <a href="#name-24">NAME</a>
    </h3>
    <p>firehol-server - server, route commands: accept requests to a service</p>
<!--
contents-table:subcommand:server:keyword-firehol-server:Y:sport dport:Allow access to a server running on the `interface` or the protected `router` hosts.
  -->
    <h3 id="synopsis-23">
      <a href="#synopsis-23">SYNOPSIS</a>
    </h3>
    <p>{ server | server46 } <em>service</em> <em>action</em> <em>rule-params</em></p>
    <p>server4 <em>service</em> <em>action</em> <em>rule-params</em></p>
    <p>server6 <em>service</em> <em>action</em> <em>rule-params</em></p>
    <p>{ route | route46 } <em>service</em> <em>action</em> <em>rule-params</em></p>
    <p>route4 <em>service</em> <em>action</em> <em>rule-params</em></p>
    <p>route6 <em>service</em> <em>action</em> <em>rule-params</em></p>
<!--
extra-manpage: firehol-server46.5
extra-manpage: firehol-server4.5
extra-manpage: firehol-server6.5
extra-manpage: firehol-route46.5
extra-manpage: firehol-route4.5
extra-manpage: firehol-route6.5
  -->
    <h3 id="description-24">
      <a href="#description-24">DESCRIPTION</a>
    </h3>
    <p>The <code>server</code> subcommand defines a server of a service on an <code>interface</code> or <code>router</code>. Any <em>rule-params</em> given to a parent interface or router are inherited by the server.</p>
    <p>For FireHOL a server is the destination of a request. Even though this is more complex for some multi-socket services, to FireHOL a server always accepts requests.</p>
    <p>The <code>route</code> subcommand is an alias for <code>server</code> which may only be used in routers.</p>
    <p>The <em>service</em> parameter is one of the supported service names from <a href="#firehol-services5">firehol-services(5)</a>. Multiple services may be specified, space delimited in quotes.</p>
    <p>The <em>action</em> can be any of the actions listed in <a href="#firehol-actions5">firehol-actions(5)</a>.</p>
    <p>The <em>rule-params</em> define a set of rule parameters to further restrict the traffic that is matched to this service. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>Writing <code>server4</code> is equivalent to writing <code>ipv4 server</code> and ensures this subcommand is applied only in the IPv4 firewall rules.</p>
      <p>Writing <code>server6</code> is equivalent to writing <code>ipv6 server</code> and ensures this subcommand is applied only in the IPv6 firewall rules.</p>
      <p>Writing <code>server46</code> is equivalent to writing <code>both server</code> and ensures this subcommand is applied in both the IPv4 and IPv6 firewall rules; it cannot be used as part an interface or router that is IPv4 or IPv6 only.</p>
      <p>The default <code>server</code> inherits its behaviour from the enclosing interface or router.</p>
      <p>The same rules apply to the variations of <code>route</code>.</p>
    </blockquote>
    <h3 id="examples-16">
      <a href="#examples-16">EXAMPLES</a>
    </h3>
    <pre><code>server smtp accept

server "smtp pop3" accept

server smtp accept src 192.0.2.1

server smtp accept log "mail packet" src 192.0.2.1</code></pre>
    <h3 id="see-also-24">
      <a href="#see-also-24">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-modifiers5">firehol-modifiers(5)</a> - ipv4/ipv6 selection</li>
      <li><a href="#firehol-services5">firehol-services(5)</a> - services list</li>
      <li><a href="#firehol-actions5">firehol-actions(5)</a> - actions for rules</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-client5">firehol-client(5)</a> - client subcommand</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-services5">
      <a href="#firehol-services5">firehol-services(5)</a>
    </h2>
    <h3 id="name-25">
      <a href="#name-25">NAME</a>
    </h3>
    <p>firehol-services - FireHOL services list</p>
    <h3 id="synopsis-24">
      <a href="#synopsis-24">SYNOPSIS</a>
    </h3>
    <p>
      <a href="#service-ah">AH</a>
      <a href="#service-all">all</a>
      <a href="#service-amanda">amanda</a>
      <a href="#service-any">any</a>
      <a href="#service-anystateless">anystateless</a>
      <a href="#service-apcupsd">apcupsd</a>
      <a href="#service-apcupsdnis">apcupsdnis</a>
      <a href="#service-aptproxy">aptproxy</a>
      <a href="#service-asterisk">asterisk</a>
    </p>
    <p>
      <a href="#service-cups">cups</a>
      <a href="#service-custom">custom</a>
      <a href="#service-cvspserver">cvspserver</a>
    </p>
    <p>
      <a href="#service-darkstat">darkstat</a>
      <a href="#service-daytime">daytime</a>
      <a href="#service-dcc">dcc</a>
      <a href="#service-dcpp">dcpp</a>
      <a href="#service-dhcp">dhcp</a>
      <a href="#service-dhcprelay">dhcprelay</a>
      <a href="#service-dhcpv6">dhcpv6</a>
      <a href="#service-dict">dict</a>
      <a href="#service-distcc">distcc</a>
      <a href="#service-dns">dns</a>
    </p>
    <p>
      <a href="#service-echo">echo</a>
      <a href="#service-emule">emule</a>
      <a href="#service-eserver">eserver</a>
      <a href="#service-esp">ESP</a>
    </p>
    <p>
      <a href="#service-finger">finger</a>
      <a href="#service-ftp">ftp</a>
    </p>
    <p>
      <a href="#service-gift">gift</a>
      <a href="#service-giftui">giftui</a>
      <a href="#service-gkrellmd">gkrellmd</a>
      <a href="#service-gre">GRE</a>
    </p>
    <p>
      <a href="#service-h323">h323</a>
      <a href="#service-heartbeat">heartbeat</a>
      <a href="#service-http">http</a>
      <a href="#service-httpalt">httpalt</a>
      <a href="#service-https">https</a>
      <a href="#service-hylafax">hylafax</a>
    </p>
    <p>
      <a href="#service-iax">iax</a>
      <a href="#service-iax2">iax2</a>
      <a href="#service-icmp">ICMP</a>
      <a href="#service-icmp">icmp</a>
      <a href="#service-icmpv6">ICMPV6</a>
      <a href="#service-icmpv6">icmpv6</a>
      <a href="#service-icp">icp</a>
      <a href="#service-ident">ident</a>
      <a href="#service-imap">imap</a>
      <a href="#service-imaps">imaps</a>
      <a href="#service-ipsecnatt">ipsecnatt</a>
      <a href="#service-ipv6error">ipv6error</a>
      <a href="#service-ipv6mld">ipv6mld</a>
      <a href="#service-ipv6neigh">ipv6neigh</a>
      <a href="#service-ipv6router">ipv6router</a>
      <a href="#service-irc">irc</a>
      <a href="#service-isakmp">isakmp</a>
    </p>
    <p>
      <a href="#service-jabber">jabber</a>
      <a href="#service-jabberd">jabberd</a>
    </p>
    <p>
      <a href="#service-l2tp">l2tp</a>
      <a href="#service-ldap">ldap</a>
      <a href="#service-ldaps">ldaps</a>
      <a href="#service-lpd">lpd</a>
    </p>
    <p>
      <a href="#service-microsoft_ds">microsoft_ds</a>
      <a href="#service-mms">mms</a>
      <a href="#service-msn">msn</a>
      <a href="#service-msnp">msnp</a>
      <a href="#service-ms_ds">ms_ds</a>
      <a href="#service-multicast">multicast</a>
      <a href="#service-mysql">mysql</a>
    </p>
    <p>
      <a href="#service-netbackup">netbackup</a>
      <a href="#service-netbios_dgm">netbios_dgm</a>
      <a href="#service-netbios_ns">netbios_ns</a>
      <a href="#service-netbios_ssn">netbios_ssn</a>
      <a href="#service-nfs">nfs</a>
      <a href="#service-nis">nis</a>
      <a href="#service-nntp">nntp</a>
      <a href="#service-nntps">nntps</a>
      <a href="#service-nrpe">nrpe</a>
      <a href="#service-ntp">ntp</a>
      <a href="#service-nut">nut</a>
      <a href="#service-nxserver">nxserver</a>
    </p>
    <p>
      <a href="#service-openvpn">openvpn</a>
      <a href="#service-oracle">oracle</a>
      <a href="#service-ospf">OSPF</a>
    </p>
    <p>
      <a href="#service-ping">ping</a>
      <a href="#service-pop3">pop3</a>
      <a href="#service-pop3s">pop3s</a>
      <a href="#service-portmap">portmap</a>
      <a href="#service-postgres">postgres</a>
      <a href="#service-pptp">pptp</a>
      <a href="#service-privoxy">privoxy</a>
    </p>
    <p>
      <a href="#service-radius">radius</a>
      <a href="#service-radiusold">radiusold</a>
      <a href="#service-radiusoldproxy">radiusoldproxy</a>
      <a href="#service-radiusproxy">radiusproxy</a>
      <a href="#service-rdp">rdp</a>
      <a href="#service-rndc">rndc</a>
      <a href="#service-rsync">rsync</a>
      <a href="#service-rtp">rtp</a>
    </p>
    <p>
      <a href="#service-samba">samba</a>
      <a href="#service-sane">sane</a>
      <a href="#service-sip">sip</a>
      <a href="#service-smtp">smtp</a>
      <a href="#service-smtps">smtps</a>
      <a href="#service-snmp">snmp</a>
      <a href="#service-snmptrap">snmptrap</a>
      <a href="#service-socks">socks</a>
      <a href="#service-squid">squid</a>
      <a href="#service-ssh">ssh</a>
      <a href="#service-stun">stun</a>
      <a href="#service-submission">submission</a>
      <a href="#service-sunrpc">sunrpc</a>
      <a href="#service-swat">swat</a>
      <a href="#service-syslog">syslog</a>
    </p>
    <p>
      <a href="#service-telnet">telnet</a>
      <a href="#service-tftp">tftp</a>
      <a href="#service-time">time</a>
      <a href="#service-timestamp">timestamp</a>
      <a href="#service-tomcat">tomcat</a>
    </p>
    <p>
      <a href="#service-upnp">upnp</a>
      <a href="#service-uucp">uucp</a>
    </p>
    <p>
      <a href="#service-vmware">vmware</a>
      <a href="#service-vmwareauth">vmwareauth</a>
      <a href="#service-vmwareweb">vmwareweb</a>
      <a href="#service-vnc">vnc</a>
    </p>
    <p>
      <a href="#service-webcache">webcache</a>
      <a href="#service-webmin">webmin</a>
      <a href="#service-whois">whois</a>
    </p>
    <p>
      <a href="#service-xbox">xbox</a>
      <a href="#service-xdmcp">xdmcp</a>
    </p>
    <h3 id="description-25">
      <a href="#description-25">DESCRIPTION</a>
    </h3>
    <h4 id="service-ah">
      <a href="#service-ah">service: AH</a>
    </h4>
    <dl>
      <dt>IPSec Authentication Header (AH)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server AH accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>51/any</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/IPsec#Authentication_Header">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>For more information see this <a href="http://web.archive.org/web/20100918134143/http://www.freeswan.org/freeswan_trees/freeswan-1.99/doc/ipsec.html#AH.ipsec">Archive of the FreeS/WAN documentation</a> and <a href="http://www.ietf.org/rfc/rfc2402.txt">RFC 2402</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-all">
      <a href="#service-all">service: all</a>
    </h4>
    <dl>
      <dt>Match all traffic</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server all accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>all</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>all</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_ftp <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_FTP.html">CONFIG_NF_CONNTRACK_FTP</a></li>
          <li>nf_conntrack_irc <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_IRC.html">CONFIG_NF_CONNTRACK_IRC</a></li>
          <li>nf_conntrack_sip <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_SIP.html">CONFIG_NF_CONNTRACK_SIP</a></li>
          <li>nf_conntrack_pptp <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_PPTP.html">CONFIG_NF_CONNTRACK_PPTP</a></li>
          <li>nf_conntrack_proto_gre <a href="http://cateee.net/lkddb/web-lkddb/NF_CT_PROTO_GRE.html">CONFIG_NF_CT_PROTO_GRE</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_ftp <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_FTP.html">CONFIG_NF_NAT_FTP</a></li>
          <li>nf_nat_irc <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_IRC.html">CONFIG_NF_NAT_IRC</a></li>
          <li>nf_nat_sip <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_SIP.html">CONFIG_NF_NAT_SIP</a></li>
          <li>nf_nat_pptp <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_PPTP.html">CONFIG_NF_NAT_PPTP</a></li>
          <li>nf_nat_proto_gre <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_PROTO_GRE.html">CONFIG_NF_NAT_PROTO_GRE</a></li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Matches all traffic (all protocols, ports, etc.). Note that to provide "connections in one direction with replies" semantics, the kernel connection tracker is still used: this will therefore still not match packets if they are not understood as part of a connection (e.g. some ICMPv6 packets, requests and replies taking different routes, complex protocols with no helper loaded).</p>
          <p>This service may indirectly setup a set of other services, if they require kernel modules to be loaded. The following complex services are activated:</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-amanda">
      <a href="#service-amanda">service: amanda</a>
    </h4>
    <dl>
      <dt>Advanced Maryland Automatic Network Disk Archiver</dt>
      <dd>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/10080</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_amanda <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_AMANDA.html">CONFIG_NF_CONNTRACK_AMANDA</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_amanda <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_AMANDA.html">CONFIG_NF_NAT_AMANDA</a></li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.amanda.org/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Advanced_Maryland_Automatic_Network_Disk_Archiver">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-any">
      <a href="#service-any">service: any</a>
    </h4>
    <dl>
      <dt>Match all traffic (without modules or indirect)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server any *myname* accept proto 47</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>all</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>all</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li></li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Matches all traffic (all protocols, ports, etc), but does not care about kernel modules and does not activate any other service indirectly. In combination with the <a href="#firehol-params5">firehol-params(5)</a> this service can match unusual traffic (e.g. GRE - protocol 47).</p>
          <p>Note that you have to supply your own name in addition to "any".</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-anystateless">
      <a href="#service-anystateless">service: anystateless</a>
    </h4>
    <dl>
      <dt>Match all traffic statelessly</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server anystateless *myname* accept proto 47</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>all</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>all</li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Matches all traffic (all protocols, ports, etc), but does not care about kernel modules and does not activate any other service indirectly. In combination with the <a href="#firehol-params5">firehol-params(5)</a> this service can match unusual traffic (e.g. GRE - protocol 47).</p>
          <p>This service is identical to "any" but does not care about the state of traffic.</p>
          <p>Note that you have to supply your own name in addition to "anystateless".</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-apcupsd">
      <a href="#service-apcupsd">service: apcupsd</a>
    </h4>
    <dl>
      <dt>APC UPS Daemon</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server apcupsd accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/6544</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.apcupsd.com">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Apcupsd">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This service must be defined as "server apcupsd accept" on all machines not directly connected to the UPS (i.e. slaves).</p>
          <p>Note that the port defined here is not the default port (6666) used if you download and compile APCUPSD, since the default conflicts with IRC and many distributions (like Debian) have changed this to 6544.</p>
          <p>You can define port 6544 in APCUPSD, by changing the value of NETPORT in its configuration file, or overwrite this FireHOL service definition using the procedures described in <a href="#adding-services">Adding Services</a> in <a href="#firehol.conf5">firehol.conf(5)</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-apcupsdnis">
      <a href="#service-apcupsdnis">service: apcupsdnis</a>
    </h4>
    <dl>
      <dt>APC UPS Daemon Network Information Server</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server apcupsdnis accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/3551</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.apcupsd.com">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Apcupsd">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This service allows the remote WEB interfaces of <a href="http://www.apcupsd.com/">APCUPSD</a>, to connect and get information from the server directly connected to the UPS device.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-aptproxy">
      <a href="#service-aptproxy">service: aptproxy</a>
    </h4>
    <dl>
      <dt>Advanced Packaging Tool Proxy</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server aptproxy accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/9999</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Apt-proxy">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-asterisk">
      <a href="#service-asterisk">service: asterisk</a>
    </h4>
    <dl>
      <dt>Asterisk PABX</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server asterisk accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/5038</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.asterisk.org">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Asterisk_PBX">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This service refers only to the manager interface of asterisk. You should normally enable <a href="#service-sip">sip</a>, <a href="#service-h323">h323</a>, <a href="#service-rtp">rtp</a>, etc. at the firewall level, if you enable the relative channel drivers of asterisk.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-cups">
      <a href="#service-cups">service: cups</a>
    </h4>
    <dl>
      <dt>Common UNIX Printing System</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server cups accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/631 udp/631</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.cups.org">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Common_Unix_Printing_System">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-custom">
      <a href="#service-custom">service: custom</a>
    </h4>
    <dl>
      <dt>Custom definitions</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server custom myimap tcp/143 default accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>custom</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The full syntax is:</p>
          <p>
            <em>subcommand</em>
            <code>custom</code>            <em>name</em>
            <em>svr-proto/ports</em>
            <em>cli-ports</em>
            <em>action</em>
            <em>params</em>
          </p>
          <p>This service is used by FireHOL to allow you create rules for services which do not have a definition.</p>
          <p><code>subcommand</code>, <em>action</em> and <em>params</em> have their usual meanings.</p>
          <p>A <em>name</em> must be supplied along with server ports in the form <em>proto/range</em> and client ports which takes only a <em>range</em>.</p>
          <p>To define services with the built-in extension mechanism to avoid the need for <code>custom</code> services, see <a href="#adding-services">Adding Services</a> in <a href="#firehol.conf5">firehol.conf(5)</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-cvspserver">
      <a href="#service-cvspserver">service: cvspserver</a>
    </h4>
    <dl>
      <dt>Concurrent Versions System</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server cvspserver accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/2401</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.nongnu.org/cvs/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Concurrent_Versions_System">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-darkstat">
      <a href="#service-darkstat">service: darkstat</a>
    </h4>
    <dl>
      <dt>Darkstat network traffic analyser</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server darkstat accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/666</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="https://unix4lyfe.org/darkstat/">Homepage</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-daytime">
      <a href="#service-daytime">service: daytime</a>
    </h4>
    <dl>
      <dt>Daytime Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server daytime accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/13</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Daytime_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-dcc">
      <a href="#service-dcc">service: dcc</a>
    </h4>
    <dl>
      <dt>Distributed Checksum Clearinghouse</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server dcc accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/6277</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Distributed_Checksum_Clearinghouse">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>See also this <a href="http://www.rhyolite.com/dcc/FAQ.html#firewall-ports">DCC FAQ</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-dcpp">
      <a href="#service-dcpp">service: dcpp</a>
    </h4>
    <dl>
      <dt>Direct Connect++ P2P</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server dcpp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/1412 udp/1412</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://dcplusplus.sourceforge.net">Homepage</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-dhcp">
      <a href="#service-dhcp">service: dhcp</a>
    </h4>
    <dl>
      <dt>Dynamic Host Configuration Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server dhcp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/67</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>68</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Dhcp">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The dhcp service is implemented as stateless rules.</p>
          <p>DHCP clients broadcast to the network (src 0.0.0.0 dst 255.255.255.255) to find a DHCP server. If the DHCP service was stateful the iptables connection tracker would not match the packets and deny to send the reply.</p>
          <p>Note that this change does not affect the security of either DHCP servers or clients, since only the specific ports are allowed (there is no random port at either the server or the client side).</p>
          <p>Note also that the "server dhcp accept" or "client dhcp accept" commands should placed within interfaces that do not have src and / or dst defined (because of the initial broadcast).</p>
          <p>You can overcome this problem by placing the DHCP service on a separate interface, without a src or dst but with a policy return. Place this interface before the one that defines the rest of the services.</p>
          <p>For example:</p>
          <p>
            <code>interface eth0 dhcp</code>          </p>
          <p>
            <code>policy return</code>          </p>
          <p>
            <code>server dhcp accept</code>          </p>
          <p>
            <code>interface eth0 lan src "$mylan" dst "$myip"</code>          </p>
          <p>
            <code>client all accept</code>          </p>
          <p>For example: interface eth0 dhcp policy return server dhcp accept interface eth0 lan src "<span class="math">$mylan" dst "$</span>myip" client all accept</p>
          <p>This service implicitly sets its client or server to ipv4 mode.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-dhcprelay">
      <a href="#service-dhcprelay">service: dhcprelay</a>
    </h4>
    <dl>
      <dt>DHCP Relay</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server dhcprelay accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/67</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>67</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol#DHCP_relaying">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>From RFC 1812 section 9.1.2:</p>
          <p>In many cases, BOOTP clients and their associated BOOTP server(s) do not reside on the same IP (sub)network. In such cases, a third-party agent is required to transfer BOOTP messages between clients and servers. Such an agent was originally referred to as a BOOTP forwarding agent. However, to avoid confusion with the IP forwarding function of a router, the name BOOTP relay agent has been adopted instead.</p>
          <p>For more information about DHCP Relay see section 9.1.2 of <a href="http://www.ietf.org/rfc/rfc1812.txt">RFC 1812</a> and section 4 of <a href="http://www.ietf.org/rfc/rfc1542.txt">RFC 1542</a></p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-dhcpv6">
      <a href="#service-dhcpv6">service: dhcpv6</a>
    </h4>
    <dl>
      <dt>Dynamic Host Configuration Protocol for IPv6</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server dhcp accept
  client dhcp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/547</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>udp/546</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="https://en.wikipedia.org/wiki/DHCPv6">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The dhcp service is implemented as stateless rules. It cannot be stateful as the connection tracker will not match a unicast reply to a broadcast request. Further, if you wish to add src/dst rule parameters, you must account for both the broadcast and link-local network prefixes.</p>
          <p>Clients broadcast from a link-local address to the multicast address ff02::1:2 on UDP port 547 to find a server. The server sends a unicast reply back to the client which listens on UDP port 546.</p>
          <p>For a FireHOL interface, creating a client will allow sending to port 547 and receiving on port 546. Creating a server allows sending to port 546 and receiving on port 547.</p>
          <p>Unlike DHCP for IPv4, the source ports to be used are not defined in DHCPv6 - see section 5.2 of <a href="http://www.ietf.org/rfc/rfc3315.txt">RFC3315</a>. Some servers are known to make use of this to send from arbitrary ports, so FireHOL does not assume a source port.</p>
          <p>This service implicitly sets its client or server to ipv6 mode.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-dict">
      <a href="#service-dict">service: dict</a>
    </h4>
    <dl>
      <dt>Dictionary Server Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server dict accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/2628</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/DICT">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>See <a href="http://www.ietf.org/rfc/rfc2229.txt">RFC2229</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-distcc">
      <a href="#service-distcc">service: distcc</a>
    </h4>
    <dl>
      <dt>Distributed CC</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server distcc accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/3632</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="https://code.google.com/p/distcc/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Distcc">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>For distcc security, please check the <a href="http://distcc.googlecode.com/svn/trunk/doc/web/security.html">distcc security design</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-dns">
      <a href="#service-dns">service: dns</a>
    </h4>
    <dl>
      <dt>Domain Name System</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server dns accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/53 tcp/53</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Domain_Name_System">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>On very busy DNS servers you may see a few dropped DNS packets in your logs. This is normal. The iptables connection tracker will timeout the session and lose unmatched DNS packets that arrive too late to be useful.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-echo">
      <a href="#service-echo">service: echo</a>
    </h4>
    <dl>
      <dt>Echo Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server echo accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/7</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Echo_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-emule">
      <a href="#service-emule">service: emule</a>
    </h4>
    <dl>
      <dt>eMule (Donkey network client)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  client emule accept src 192.0.2.1</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>many</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>many</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.emule-project.com">Homepage</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>According to <a href="http://www.emule-project.net/home/perl/help.cgi?l=1&amp;rm=show_topic&amp;topic_id=122">eMule Port Definitions</a>, FireHOL defines:</p>
          <ul>
            <li>Accept from any client port to the server at tcp/4661</li>
            <li>Accept from any client port to the server at tcp/4662</li>
            <li>Accept from any client port to the server at udp/4665</li>
            <li>Accept from any client port to the server at udp/4672</li>
            <li>Accept from any server port to the client at tcp/4662</li>
            <li>Accept from any server port to the client at udp/4672</li>
          </ul>
          <p>Use the FireHOL <a href="#firehol-client5">firehol-client(5)</a> command to match the eMule client.</p>
          <p>Please note that the eMule client is an HTTP client also.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-eserver">
      <a href="#service-eserver">service: eserver</a>
    </h4>
    <dl>
      <dt>eDonkey network server</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server eserver accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/4661 udp/4661 udp/4665</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Eserver">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-esp">
      <a href="#service-esp">service: ESP</a>
    </h4>
    <dl>
      <dt>IPSec Encapsulated Security Payload (ESP)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ESP accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>50/any</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>For more information see this <a href="http://web.archive.org/web/20100918134143/http://www.freeswan.org/freeswan_trees/freeswan-1.99/doc/ipsec.html#ESP.ipsec">Archive of the FreeS/WAN documentation</a> <a href="http://www.ietf.org/rfc/rfc2406.txt">RFC 2406</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-finger">
      <a href="#service-finger">service: finger</a>
    </h4>
    <dl>
      <dt>Finger Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server finger accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/79</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Finger_protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ftp">
      <a href="#service-ftp">service: ftp</a>
    </h4>
    <dl>
      <dt>File Transfer Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ftp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/21</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_ftp <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_FTP.html">CONFIG_NF_CONNTRACK_FTP</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_ftp <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_FTP.html">CONFIG_NF_NAT_FTP</a></li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Ftp">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The FTP service matches both active and passive FTP connections.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-gift">
      <a href="#service-gift">service: gift</a>
    </h4>
    <dl>
      <dt>giFT Internet File Transfer</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server gift accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/4302 tcp/1214 tcp/2182 tcp/2472</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://gift.sourceforge.net">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/GiFT">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The gift FireHOL service supports:</p>
          <ul>
            <li>Gnutella listening at tcp/4302</li>
            <li>FastTrack listening at tcp/1214</li>
            <li>OpenFT listening at tcp/2182 and tcp/2472</li>
          </ul>
          <p>The above ports are the defaults given for the corresponding giFT modules.</p>
          <p>To allow access to the user interface ports of giFT, use the <a href="#service-giftui">giftui</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-giftui">
      <a href="#service-giftui">service: giftui</a>
    </h4>
    <dl>
      <dt>giFT Internet File Transfer User Interface</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server giftui accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/1213</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://gift.sourceforge.net">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/GiFT">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This service refers only to the user interface ports offered by giFT. To allow gift accept P2P requests, use the <a href="#service-gift">gift</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-gkrellmd">
      <a href="#service-gkrellmd">service: gkrellmd</a>
    </h4>
    <dl>
      <dt>GKrellM Daemon</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server gkrellmd accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/19150</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://gkrellm.net/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Gkrellm">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-gre">
      <a href="#service-gre">service: GRE</a>
    </h4>
    <dl>
      <dt>Generic Routing Encapsulation</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server GRE accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>47/any</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_proto_gre <a href="http://cateee.net/lkddb/web-lkddb/NF_CT_PROTO_GRE.html">CONFIG_NF_CT_PROTO_GRE</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_proto_gre <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_PROTO_GRE.html">CONFIG_NF_NAT_PROTO_GRE</a></li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Generic_Routing_Encapsulation">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Protocol No 47.</p>
          <p>For more information see RFC <a href="http://www.ietf.org/rfc/rfc2784.txt">RFC 2784</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-h323">
      <a href="#service-h323">service: h323</a>
    </h4>
    <dl>
      <dt>H.323 VoIP</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server h323 accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/1720 tcp/1720</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_h323 <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_H323.html">CONFIG_NF_CONNTRACK_H323</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_h323 <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_H323.html">CONFIG_NF_NAT_H323</a></li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/H323">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-heartbeat">
      <a href="#service-heartbeat">service: heartbeat</a>
    </h4>
    <dl>
      <dt>HeartBeat</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server heartbeat accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/690:699</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.linux-ha.org/">Homepage</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This FireHOL service has been designed such a way that it will allow multiple heartbeat clusters on the same LAN.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-http">
      <a href="#service-http">service: http</a>
    </h4>
    <dl>
      <dt>Hypertext Transfer Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server http accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/80</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Http">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-httpalt">
      <a href="#service-httpalt">service: httpalt</a>
    </h4>
    <dl>
      <dt>HTTP alternate port</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server httpalt accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/8080</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Http">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This port is commonly used by web servers, web proxies and caches where the standard <a href="#service-http">http</a> port is not available or can or should not be used.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-https">
      <a href="#service-https">service: https</a>
    </h4>
    <dl>
      <dt>Secure Hypertext Transfer Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server https accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/443</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Https">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-hylafax">
      <a href="#service-hylafax">service: hylafax</a>
    </h4>
    <dl>
      <dt>HylaFAX</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server hylafax accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>many</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>many</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.hylafax.org/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Hylafax">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This service allows incoming requests to server port tcp/4559 and outgoing from server port tcp/4558.</p>
          <p>The correct operation of this service has not been verified.</p>
          <p>USE THIS WITH CARE. A HYLAFAX CLIENT MAY OPEN ALL TCP UNPRIVILEGED PORTS TO ANYONE (from port tcp/4558).</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-iax">
      <a href="#service-iax">service: iax</a>
    </h4>
    <dl>
      <dt>Inter-Asterisk eXchange</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server iax accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/5036</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.asterisk.org">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Iax">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This service refers to IAX version 1. There is also <a href="#service-iax2">iax2</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-iax2">
      <a href="#service-iax2">service: iax2</a>
    </h4>
    <dl>
      <dt>Inter-Asterisk eXchange v2</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server iax2 accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/5469 udp/4569</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.asterisk.org">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Iax">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This service refers to IAX version 2. There is also <a href="#service-iax">iax</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-icmp">
      <a href="#service-icmp">service: ICMP</a>
    </h4>
    <dl>
      <dt>Internet Control Message Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ICMP accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>icmp/any</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Internet_Control_Message_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-icmp-1">
      <a href="#service-icmp-1">service: icmp</a>
    </h4>
    <dl>
      <dt>Internet Control Message Protocol</dt>
      <dd>Alias for <a href="#service-icmp">ICMP</a>
</dd>
    </dl>
    <h4 id="service-icmpv6">
      <a href="#service-icmpv6">service: ICMPV6</a>
    </h4>
    <dl>
      <dt>Internet Control Message Protocol v6</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ICMPV6 accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>icmpv6/any</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/ICMPv6">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-icmpv6-1">
      <a href="#service-icmpv6-1">service: icmpv6</a>
    </h4>
    <dl>
      <dt>Internet Control Message Protocol v6</dt>
      <dd>Alias for <a href="#service-icmpv6">ICMPV6</a>
</dd>
    </dl>
    <h4 id="service-icp">
      <a href="#service-icp">service: icp</a>
    </h4>
    <dl>
      <dt>Internet Cache Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server icp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/3130</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>3130</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Internet_Cache_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ident">
      <a href="#service-ident">service: ident</a>
    </h4>
    <dl>
      <dt>Identification Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ident reject with tcp-reset</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/113</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Ident_protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-imap">
      <a href="#service-imap">service: imap</a>
    </h4>
    <dl>
      <dt>Internet Message Access Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server imap accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/143</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Imap">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-imaps">
      <a href="#service-imaps">service: imaps</a>
    </h4>
    <dl>
      <dt>Secure Internet Message Access Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server imaps accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/993</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Imap">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ipsecnatt">
      <a href="#service-ipsecnatt">service: ipsecnatt</a>
    </h4>
    <dl>
      <dt>NAT traversal and IPsec</dt>
      <dd>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/4500</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/NAT_traversal#IPsec_traversal_across_NAT">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ipv6error">
      <a href="#service-ipv6error">service: ipv6error</a>
    </h4>
    <dl>
      <dt>ICMPv6 Error Handling</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ipv6error accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Not all icmpv6 error types should be treated equally inbound and outbound.</p>
          <p>The ipv6error rule wraps all of them in the following way: * allow incoming messages only for existing sessions * allow outgoing messages always</p>
          <p>The following ICMPv6 messages are handled:</p>
          <ul>
            <li>destination-unreachable</li>
            <li>packet-too-big</li>
            <li>ttl-zero-during-transit</li>
            <li>ttl-zero-during-reassembly</li>
            <li>unknown-header-type</li>
            <li>unknown-option</li>
          </ul>
          <p>Interfaces should always have this set:</p>
          <p>
            <code>server ipv6error accept</code>          </p>
          <p>In a router with inface being internal and outface being external the following will meet the recommendations of <a href="http://tools.ietf.org/html/rfc4890">RFC 4890</a>:</p>
          <p>
            <code>server ipv6error accept</code>          </p>
          <p>Do not use: <code>client ipv6error accept</code> unless you are controlling traffic on a router interface where outface is the internal destination.</p>
          <p>This service implicitly sets its client or server to ipv6 mode.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-ipv6mld">
      <a href="#service-ipv6mld">service: ipv6mld</a>
    </h4>
    <dl>
      <dt>IPv6 Multicast Listener Discovery for IPv6</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  client ipv6mld accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="https://en.wikipedia.org/wiki/Multicast_Listener_Discovery">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>IPv6 uses Multicast Listener Discovery to discover multicast listeners and what they are listening for.</p>
          <p>In practice all IPv6 nodes are multicast listeners since multicast is used in the neighbour discovery protocol which replaces ARP in IPv4.</p>
          <p>These rules are stateless since reports can happen automatically as well as on query.</p>
          <p>Unless muticast snooping is disabled across the network, MLD should be enabled for any clients:</p>
          <p>
            <code>client ipv6mld accept</code>          </p>
          <p>MLD should also be enabled as a server on any hosts acting as a router:</p>
          <p>
            <code>server ipv6mld accept</code>          </p>
          <p>The rules should generally not be used to pass packets across a firewall (e.g. in a router definition) unless the firewall is for a bridge.</p>
          <p>This service implicitly sets its client or server to ipv6 mode.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-ipv6neigh">
      <a href="#service-ipv6neigh">service: ipv6neigh</a>
    </h4>
    <dl>
      <dt>IPv6 Neighbour discovery</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  client ipv6neigh accept
  server ipv6neigh accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="https://en.wikipedia.org/wiki/Neighbor_Discovery_Protocol">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>IPv6 uses the Neighbour Discovery Protocol to do automatic configuration of routes and to replace ARP. To allow this functionality the network neighbour and router solicitation/advertisement messages should be enabled on each interface.</p>
          <p>These rules are stateless since advertisement can happen automatically as well as on solicitation.</p>
          <p>Neighbour discovery (incoming) should always be enabled:</p>
          <p>
            <code>server ipv6neigh accept</code>          </p>
          <p>Neighbour advertisement (outgoing) should always be enabled:</p>
          <p>
            <code>client ipv6neigh accept</code>          </p>
          <p>The rules should not be used to pass packets across a firewall (e.g. in a router definition) unless the firewall is for a bridge.</p>
          <p>This service implicitly sets its client or server to ipv6 mode.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-ipv6router">
      <a href="#service-ipv6router">service: ipv6router</a>
    </h4>
    <dl>
      <dt>IPv6 Router discovery</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  client ipv6router accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="https://en.wikipedia.org/wiki/Neighbor_Discovery_Protocol">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>IPv6 uses the Neighbour Discovery Protocol to do automatic configuration of routes and to replace ARP. To allow this functionality the network neighbour and router solicitation/advertisement messages should be enabled on each interface.</p>
          <p>These rules are stateless since advertisement can happen automatically as well as on solicitation.</p>
          <p>Router discovery (incoming) should always be enabled:</p>
          <p>
            <code>client ipv6router accept</code>          </p>
          <p>Router advertisement (outgoing) should be enabled on a host that routes:</p>
          <p>
            <code>server ipv6router accept</code>          </p>
          <p>The rules should not be used to pass packets across a firewall (e.g. in a router definition) unless the firewall is for a bridge.</p>
          <p>This service implicitly sets its client or server to ipv6 mode.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-irc">
      <a href="#service-irc">service: irc</a>
    </h4>
    <dl>
      <dt>Internet Relay Chat</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server irc accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/6667</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_irc <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_IRC.html">CONFIG_NF_CONNTRACK_IRC</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_irc <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_IRC.html">CONFIG_NF_NAT_IRC</a></li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Internet_Relay_Chat">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-isakmp">
      <a href="#service-isakmp">service: isakmp</a>
    </h4>
    <dl>
      <dt>Internet Security Association and Key Management Protocol (IKE)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server isakmp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/500</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/ISAKMP">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>For more information see the <a href="http://web.archive.org/web/20100918134143/http://www.freeswan.org/freeswan_trees/freeswan-1.99/doc/ipsec.html#IKE.ipsec">Archive of the FreeS/WAN documentation</a></p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-jabber">
      <a href="#service-jabber">service: jabber</a>
    </h4>
    <dl>
      <dt>Extensible Messaging and Presence Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server jabber accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/5222 tcp/5223</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Jabber">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Allows clear and SSL client-to-server connections.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-jabberd">
      <a href="#service-jabberd">service: jabberd</a>
    </h4>
    <dl>
      <dt>Extensible Messaging and Presence Protocol (Server)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server jabberd accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/5222 tcp/5223 tcp/5269</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Jabber">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Allows clear and SSL client-to-server and server-to-server connections.</p>
          <p>Use this service for a jabberd server. In all other cases, use the <a href="#service-jabber">jabber</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-l2tp">
      <a href="#service-l2tp">service: l2tp</a>
    </h4>
    <dl>
      <dt>Layer 2 Tunneling Protocol</dt>
      <dd>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/1701</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/L2tp">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ldap">
      <a href="#service-ldap">service: ldap</a>
    </h4>
    <dl>
      <dt>Lightweight Directory Access Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ldap accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/389</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Ldap">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ldaps">
      <a href="#service-ldaps">service: ldaps</a>
    </h4>
    <dl>
      <dt>Secure Lightweight Directory Access Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ldaps accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/636</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Ldap">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-lpd">
      <a href="#service-lpd">service: lpd</a>
    </h4>
    <dl>
      <dt>Line Printer Daemon Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server lpd accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/515</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Line_Printer_Daemon_protocol">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>LPD is documented in <a href="http://www.ietf.org/rfc/rfc1179.txt">RFC 1179</a>.</p>
          <p>Since many operating systems incorrectly use the non-default client ports for LPD access, this definition allows any client port to access the service (in addition to the RFC defined 721 to 731 inclusive).</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-microsoft_ds">
      <a href="#service-microsoft_ds">service: microsoft_ds</a>
    </h4>
    <dl>
      <dt>Direct Hosted (NETBIOS-less) SMB</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server microsoft_ds accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/445</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Direct Hosted (i.e. NETBIOS-less SMB)</p>
          <p>This is another NETBIOS Session Service with minor differences with <a href="#service-netbios_ssn">netbios_ssn</a>. It is supported only by Windows 2000 and Windows XP and it offers the advantage of being independent of WINS for name resolution.</p>
          <p>It seems that samba supports transparently this protocol on the <a href="#service-netbios_ssn">netbios_ssn</a> ports, so that either direct hosted or traditional SMB can be served simultaneously.</p>
          <p>Please refer to the <a href="#service-netbios_ssn">netbios_ssn</a> for more information.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-mms">
      <a href="#service-mms">service: mms</a>
    </h4>
    <dl>
      <dt>Microsoft Media Server</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server mms accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/1755 udp/1755</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>See <a href="http://www.netfilter.org/documentation/HOWTO/netfilter-extensions-HOWTO-5.html#ss5.5">here</a>.</li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>See <a href="http://www.netfilter.org/documentation/HOWTO/netfilter-extensions-HOWTO-5.html#ss5.5">here</a>.</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Microsoft_Media_Server">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Microsoft's proprietary network streaming protocol used to transfer unicast data in Windows Media Services (previously called NetShow Services).</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-msn">
      <a href="#service-msn">service: msn</a>
    </h4>
    <dl>
      <dt>Microsoft MSN Messenger Service</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server msn accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/1863 udp/1863</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-msnp">
      <a href="#service-msnp">service: msnp</a>
    </h4>
    <dl>
      <dt>msnp</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server msnp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/6891</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ms_ds">
      <a href="#service-ms_ds">service: ms_ds</a>
    </h4>
    <dl>
      <dt>Direct Hosted (NETBIOS-less) SMB</dt>
      <dd>Alias for <a href="#service-microsoft_ds">microsoft_ds</a>
</dd>
    </dl>
    <h4 id="service-multicast">
      <a href="#service-multicast">service: multicast</a>
    </h4>
    <dl>
      <dt>Multicast</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server multicast reject with proto-unreach</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Multicast">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The multicast service matches all packets sent to the $MULTICAST_IPS addresses using IGMP or UDP. For IPv4 that means 224.0.0.0/4 and for IPv6 FF00::/16.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-mysql">
      <a href="#service-mysql">service: mysql</a>
    </h4>
    <dl>
      <dt>MySQL</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server mysql accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/3306</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.mysql.com/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Mysql">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-netbackup">
      <a href="#service-netbackup">service: netbackup</a>
    </h4>
    <dl>
      <dt>Veritas NetBackup service</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server netbackup accept
  client netbackup accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/13701 tcp/13711 tcp/13720 tcp/13721 tcp/13724 tcp/13782 tcp/13783</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Netbackup">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>To use this service you must define it as both client and server in NetBackup clients and NetBackup servers.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-netbios_dgm">
      <a href="#service-netbios_dgm">service: netbios_dgm</a>
    </h4>
    <dl>
      <dt>NETBIOS Datagram Distribution Service</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server netbios_dgm accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/138</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Netbios#Datagram_distribution_service">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>See also the <a href="#service-samba">samba</a>.</p>
          <p>Keep in mind that this service broadcasts (to the broadcast address of your LAN) UDP packets. If you place this service within an interface that has a dst parameter, remember to include (in the dst parameter) the broadcast address of your LAN too.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-netbios_ns">
      <a href="#service-netbios_ns">service: netbios_ns</a>
    </h4>
    <dl>
      <dt>NETBIOS Name Service</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server netbios_ns accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/137</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Netbios#Name_service">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>See also the <a href="#service-samba">samba</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-netbios_ssn">
      <a href="#service-netbios_ssn">service: netbios_ssn</a>
    </h4>
    <dl>
      <dt>NETBIOS Session Service</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server netbios_ssn accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/139</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Netbios#Session_service">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>See also the <a href="#service-samba">samba</a>.</p>
          <p>Please keep in mind that newer NETBIOS clients prefer to use port 445 (<a href="#service-microsoft_ds">microsoft_ds</a>) for the NETBIOS session service, and when this is not available they fall back to port 139 (netbios_ssn). Versions of samba above 3.x bind automatically to ports 139 and 445.</p>
          <p>If you have an older samba version and your policy on an interface or router is DROP, clients trying to access port 445 will have to timeout before falling back to port 139. This timeout can be up to several minutes.</p>
          <p>To overcome this problem you can explicitly REJECT the <a href="#service-microsoft_ds">microsoft_ds</a> with a tcp-reset message:</p>
          <p>server microsoft_ds reject with tcp-reset</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-nfs">
      <a href="#service-nfs">service: nfs</a>
    </h4>
    <dl>
      <dt>Network File System</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  client nfs accept dst 192.0.2.1</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>many</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Network_File_System_%28protocol%29">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The NFS service queries the RPC service on the NFS server host to find out the ports nfsd, mountd, lockd and rquotad are listening. Then, according to these ports it sets up rules on all the supported protocols (as reported by RPC) in order the clients to be able to reach the server.</p>
          <p>For this reason, the NFS service requires that:</p>
          <ul>
            <li>the firewall is restarted if the NFS server is restarted</li>
            <li>the NFS server must be specified on all nfs statements (only if it is not the localhost)</li>
          </ul>
          <p>Since NFS queries the remote RPC server, it is required to also be allowed to do so, by allowing the <a href="#service-portmap">portmap</a> too. Take care that this is allowed by the running firewall when FireHOL tries to query the RPC server. So you might have to setup NFS in two steps: First add the portmap service and activate the firewall, then add the NFS service and restart the firewall.</p>
          <p>To avoid this you can setup your NFS server to listen on pre-defined ports, as documented in <a href="http://nfs.sourceforge.net/nfs-howto/ar01s06.html#nfs_firewalls">NFS Howto</a>. If you do this then you will have to define the the ports using the procedure described in <a href="#adding-services">Adding Services</a> in <a href="#firehol.conf5">firehol.conf(5)</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-nis">
      <a href="#service-nis">service: nis</a>
    </h4>
    <dl>
      <dt>Network Information Service</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  client nis accept dst 192.0.2.1</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>many</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Network_Information_Service">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The nis service queries the RPC service on the nis server host to find out the ports ypserv and yppasswdd are listening. Then, according to these ports it sets up rules on all the supported protocols (as reported by RPC) in order the clients to be able to reach the server.</p>
          <p>For this reason, the nis service requires that:</p>
          <ul>
            <li>the firewall is restarted if the nis server is restarted</li>
            <li>the nis server must be specified on all nis statements (only if it is not the localhost)</li>
          </ul>
          <p>Since nis queries the remote RPC server, it is required to also be allowed to do so, by allowing the <a href="#service-portmap">portmap</a> too. Take care that this is allowed by the running firewall when FireHOL tries to query the RPC server. So you might have to setup nis in two steps: First add the portmap service and activate the firewall, then add the nis service and restart the firewall.</p>
          <p>This service was added to FireHOL by <a href="http://sourceforge.net/p/firehol/feature-requests/20/">Carlos Rodrigues</a>. His comments regarding this implementation, are:</p>
          <p>These rules work for client access only!</p>
          <p>Pushing changes to slave servers won't work if these rules are active somewhere between the master and its slaves, because it is impossible to predict the ports where yppush will be listening on each push.</p>
          <p>Pulling changes directly on the slaves will work, and could be improved performance-wise if these rules are modified to open fypxfrd. This wasn't done because it doesn't make that much sense since pushing changes on the master server is the most common, and recommended, way to replicate maps.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-nntp">
      <a href="#service-nntp">service: nntp</a>
    </h4>
    <dl>
      <dt>Network News Transfer Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server nntp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/119</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Nntp">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-nntps">
      <a href="#service-nntps">service: nntps</a>
    </h4>
    <dl>
      <dt>Secure Network News Transfer Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server nntps accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/563</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Nntp">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-nrpe">
      <a href="#service-nrpe">service: nrpe</a>
    </h4>
    <dl>
      <dt>Nagios NRPE</dt>
      <dd>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/5666</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Nagios#NRPE">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ntp">
      <a href="#service-ntp">service: ntp</a>
    </h4>
    <dl>
      <dt>Network Time Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ntp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/123 tcp/123</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Network_Time_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-nut">
      <a href="#service-nut">service: nut</a>
    </h4>
    <dl>
      <dt>Network UPS Tools</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server nut accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/3493 udp/3493</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.networkupstools.org/">Homepage</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-nxserver">
      <a href="#service-nxserver">service: nxserver</a>
    </h4>
    <dl>
      <dt>NoMachine NX Server</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server nxserver accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/5000:5200</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/NX_Server">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Default ports used by NX server for connections without encryption.</p>
          <p>Note that nxserver also needs the <a href="#service-ssh">ssh</a> to be enabled.</p>
          <p>This information has been extracted from this The TCP ports used by nxserver are 4000 + DISPLAY_BASE to 4000 + DISPLAY_BASE + DISPLAY_LIMIT. DISPLAY_BASE and DISPLAY_LIMIT are set in /usr/NX/etc/node.conf and the defaults are DISPLAY_BASE=1000 and DISPLAY_LIMIT=200.</p>
          <p>For encrypted nxserver sessions, only <a href="#service-ssh">ssh</a> is needed.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-openvpn">
      <a href="#service-openvpn">service: openvpn</a>
    </h4>
    <dl>
      <dt>OpenVPN</dt>
      <dd>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/1194 udp/1194</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://openvpn.net/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/OpenVPN">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-oracle">
      <a href="#service-oracle">service: oracle</a>
    </h4>
    <dl>
      <dt>Oracle Database</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server oracle accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/1521</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Oracle_db">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ospf">
      <a href="#service-ospf">service: OSPF</a>
    </h4>
    <dl>
      <dt>Open Shortest Path First</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server OSPF accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>89/any</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Ospf">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ping">
      <a href="#service-ping">service: ping</a>
    </h4>
    <dl>
      <dt>Ping (ICMP echo)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ping accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Ping">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This services matches requests of protocol ICMP and type echo-request (TYPE=8) and their replies of type echo-reply (TYPE=0).</p>
          <p>The ping service is stateful.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-pop3">
      <a href="#service-pop3">service: pop3</a>
    </h4>
    <dl>
      <dt>Post Office Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server pop3 accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/110</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Pop3">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-pop3s">
      <a href="#service-pop3s">service: pop3s</a>
    </h4>
    <dl>
      <dt>Secure Post Office Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server pop3s accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/995</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Pop3">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-portmap">
      <a href="#service-portmap">service: portmap</a>
    </h4>
    <dl>
      <dt>Open Network Computing Remote Procedure Call - Port Mapper</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server portmap accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/111 tcp/111</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Portmap">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-postgres">
      <a href="#service-postgres">service: postgres</a>
    </h4>
    <dl>
      <dt>PostgreSQL</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server postgres accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/5432</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Postgres">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-pptp">
      <a href="#service-pptp">service: pptp</a>
    </h4>
    <dl>
      <dt>Point-to-Point Tunneling Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server pptp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/1723</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_pptp <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_PPTP.html">CONFIG_NF_CONNTRACK_PPTP</a></li>
          <li>nf_conntrack_proto_gre <a href="http://cateee.net/lkddb/web-lkddb/NF_CT_PROTO_GRE.html">CONFIG_NF_CT_PROTO_GRE</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_pptp <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_PPTP.html">CONFIG_NF_NAT_PPTP</a></li>
          <li>nf_nat_proto_gre <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_PROTO_GRE.html">CONFIG_NF_NAT_PROTO_GRE</a></li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Pptp">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-privoxy">
      <a href="#service-privoxy">service: privoxy</a>
    </h4>
    <dl>
      <dt>Privacy Proxy</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server privoxy accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/8118</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.privoxy.org/">Homepage</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-radius">
      <a href="#service-radius">service: radius</a>
    </h4>
    <dl>
      <dt>Remote Authentication Dial In User Service (RADIUS)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server radius accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/1812 udp/1813</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/RADIUS">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-radiusold">
      <a href="#service-radiusold">service: radiusold</a>
    </h4>
    <dl>
      <dt>Remote Authentication Dial In User Service (RADIUS)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server radiusold accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/1645 udp/1646</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/RADIUS">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-radiusoldproxy">
      <a href="#service-radiusoldproxy">service: radiusoldproxy</a>
    </h4>
    <dl>
      <dt>Remote Authentication Dial In User Service (RADIUS)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server radiusoldproxy accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/1647</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/RADIUS">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-radiusproxy">
      <a href="#service-radiusproxy">service: radiusproxy</a>
    </h4>
    <dl>
      <dt>Remote Authentication Dial In User Service (RADIUS)</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server radiusproxy accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/1814</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/RADIUS">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-rdp">
      <a href="#service-rdp">service: rdp</a>
    </h4>
    <dl>
      <dt>Remote Desktop Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server rdp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/3389</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Remote_Desktop_Protocol">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Remote Desktop Protocol is also known also as Terminal Services.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-rndc">
      <a href="#service-rndc">service: rndc</a>
    </h4>
    <dl>
      <dt>Remote Name Daemon Control</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server rndc accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/953</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Rndc">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-rsync">
      <a href="#service-rsync">service: rsync</a>
    </h4>
    <dl>
      <dt>rsync protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server rsync accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/873 udp/873</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://rsync.samba.org/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Rsync">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-rtp">
      <a href="#service-rtp">service: rtp</a>
    </h4>
    <dl>
      <dt>Real-time Transport Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server rtp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/10000:20000</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Real-time_Transport_Protocol">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>RTP ports are generally all the UDP ports. This definition narrows down RTP ports to UDP 10000 to 20000.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-samba">
      <a href="#service-samba">service: samba</a>
    </h4>
    <dl>
      <dt>Samba</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server samba accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>many</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.samba.org/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Samba_(software)">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>The samba service automatically sets all the rules for <a href="#service-netbios_ns">netbios_ns</a>, <a href="#service-netbios_dgm">netbios_dgm</a>, <a href="#service-netbios_ssn">netbios_ssn</a> and <a href="#service-microsoft_ds">microsoft_ds</a>.</p>
          <p>Please refer to the notes of the above services for more information.</p>
          <p>NETBIOS initiates based on the broadcast address of an interface (request goes to broadcast address) but the server responds from its own IP address. This makes the "server samba accept" statement drop the server reply, because of the way the iptables connection tracker works.</p>
          <p>This service definition includes a hack, that allows a Linux samba server to respond correctly in such situations, by allowing new outgoing connections from the well known <a href="#service-netbios_ns">netbios_ns</a> port to the clients high ports.</p>
          <p>However, for clients and routers this hack is not applied because it would open all unprivileged ports to the samba server. The only solution to overcome the problem in such cases (routers or clients) is to build a trust relationship between the samba servers and clients.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-sane">
      <a href="#service-sane">service: sane</a>
    </h4>
    <dl>
      <dt>SANE Scanner service</dt>
      <dd>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/6566</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_sane <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_SANE.html">CONFIG_NF_CONNTRACK_SANE</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.sane-project.org/">Homepage</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-sip">
      <a href="#service-sip">service: sip</a>
    </h4>
    <dl>
      <dt>Session Initiation Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server sip accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/5060 udp/5060</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>5060 default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_sip <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_SIP.html">CONFIG_NF_CONNTRACK_SIP</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_sip <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_SIP.html">CONFIG_NF_NAT_SIP</a></li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Session_Initiation_Protocol">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p><a href="http://www.voip-info.org/wiki/view/SIP">SIP</a> is an IETF standard protocol (RFC 2543) for initiating interactive user sessions involving multimedia elements such as video, voice, chat, gaming, etc. SIP works in the application layer of the OSI communications model.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-smtp">
      <a href="#service-smtp">service: smtp</a>
    </h4>
    <dl>
      <dt>Simple Mail Transport Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server smtp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/25</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-smtps">
      <a href="#service-smtps">service: smtps</a>
    </h4>
    <dl>
      <dt>Secure Simple Mail Transport Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server smtps accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/465</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/SMTPS">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-snmp">
      <a href="#service-snmp">service: snmp</a>
    </h4>
    <dl>
      <dt>Simple Network Management Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server snmp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/161</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Simple_Network_Management_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-snmptrap">
      <a href="#service-snmptrap">service: snmptrap</a>
    </h4>
    <dl>
      <dt>SNMP Trap</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server snmptrap accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/162</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Simple_Network_Management_Protocol#Trap">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>An SNMP trap is a notification from an agent to a manager.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-socks">
      <a href="#service-socks">service: socks</a>
    </h4>
    <dl>
      <dt>SOCKet Secure</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server socks accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/1080 udp/1080</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/SOCKS">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>See also <a href="http://www.ietf.org/rfc/rfc1928.txt">RFC 1928</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-squid">
      <a href="#service-squid">service: squid</a>
    </h4>
    <dl>
      <dt>Squid Web Cache</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server squid accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/3128</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.squid-cache.org/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Squid_(software)">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-ssh">
      <a href="#service-ssh">service: ssh</a>
    </h4>
    <dl>
      <dt>Secure Shell Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server ssh accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/22</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Secure_Shell">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-stun">
      <a href="#service-stun">service: stun</a>
    </h4>
    <dl>
      <dt>Session Traversal Utilities for NAT</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server stun accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/3478 udp/3479</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>any</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/STUN">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p><a href="http://www.voip-info.org/wiki/view/STUN">STUN</a> is a protocol for assisting devices behind a NAT firewall or router with their packet routing.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-submission">
      <a href="#service-submission">service: submission</a>
    </h4>
    <dl>
      <dt>SMTP over SSL/TLS submission</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server submission accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/587</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Submission is essentially normal SMTP with an SSL/TLS negotiation.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-sunrpc">
      <a href="#service-sunrpc">service: sunrpc</a>
    </h4>
    <dl>
      <dt>Open Network Computing Remote Procedure Call - Port Mapper</dt>
      <dd>Alias for <a href="#service-portmap">portmap</a>
</dd>
    </dl>
    <h4 id="service-swat">
      <a href="#service-swat">service: swat</a>
    </h4>
    <dl>
      <dt>Samba Web Administration Tool</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server swat accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/901</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/SWAT.html">Homepage</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-syslog">
      <a href="#service-syslog">service: syslog</a>
    </h4>
    <dl>
      <dt>Syslog Remote Logging Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server syslog accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/514</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>514 default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Syslog">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-telnet">
      <a href="#service-telnet">service: telnet</a>
    </h4>
    <dl>
      <dt>Telnet</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server telnet accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/23</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Telnet">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-tftp">
      <a href="#service-tftp">service: tftp</a>
    </h4>
    <dl>
      <dt>Trivial File Transfer Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server tftp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/69</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Netfilter Modules</p>
        <ul>
          <li>nf_conntrack_tftp <a href="http://cateee.net/lkddb/web-lkddb/NF_CONNTRACK_TFTP.html">CONFIG_NF_CONNTRACK_TFTP</a></li>
        </ul>
        <p>Netfilter NAT Modules</p>
        <ul>
          <li>nf_nat_tftp <a href="http://cateee.net/lkddb/web-lkddb/NF_NAT_TFTP.html">CONFIG_NF_NAT_TFTP</a></li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Trivial_File_Transfer_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-time">
      <a href="#service-time">service: time</a>
    </h4>
    <dl>
      <dt>Time Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server time accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/37 udp/37</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Time_Protocol">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-timestamp">
      <a href="#service-timestamp">service: timestamp</a>
    </h4>
    <dl>
      <dt>ICMP Timestamp</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server timestamp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>N/A</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Internet_Control_Message_Protocol#Timestamp">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>This services matches requests of protocol ICMP and type timestamp-request (TYPE=13) and their replies of type timestamp-reply (TYPE=14).</p>
          <p>The timestamp service is stateful.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-tomcat">
      <a href="#service-tomcat">service: tomcat</a>
    </h4>
    <dl>
      <dt>HTTP alternate port</dt>
      <dd>Alias for <a href="#service-httpalt">httpalt</a>
</dd>
    </dl>
    <h4 id="service-upnp">
      <a href="#service-upnp">service: upnp</a>
    </h4>
    <dl>
      <dt>Universal Plug and Play</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server upnp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/1900 tcp/2869</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://upnp.sourceforge.net/">Homepage</a>
          </li>
          <li>
            <a href="http://en.wikipedia.org/wiki/Universal_Plug_and_Play">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>For a Linux implementation see: <a href="http://linux-igd.sourceforge.net/">Linux IGD</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-uucp">
      <a href="#service-uucp">service: uucp</a>
    </h4>
    <dl>
      <dt>Unix-to-Unix Copy</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server uucp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/540</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/UUCP">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-vmware">
      <a href="#service-vmware">service: vmware</a>
    </h4>
    <dl>
      <dt>vmware</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server vmware accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/902</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Used from VMWare 1 and up. See the <a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1012382">VMWare KnowledgeBase</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-vmwareauth">
      <a href="#service-vmwareauth">service: vmwareauth</a>
    </h4>
    <dl>
      <dt>vmwareauth</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server vmwareauth accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/903</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Used from VMWare 1 and up. See the <a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1012382">VMWare KnowledgeBase</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-vmwareweb">
      <a href="#service-vmwareweb">service: vmwareweb</a>
    </h4>
    <dl>
      <dt>vmwareweb</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server vmwareweb accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/8222 tcp/8333</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Used from VMWare 2 and up. See <a href="http://www.vmware.com/support/server2/doc/releasenotes_vmserver2.html">VMWare Server 2.0 release notes</a> and the <a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1012382">VMWare KnowledgeBase</a>.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-vnc">
      <a href="#service-vnc">service: vnc</a>
    </h4>
    <dl>
      <dt>Virtual Network Computing</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server vnc accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/5900:5903</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Virtual_Network_Computing">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>VNC is a graphical desktop sharing protocol.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-webcache">
      <a href="#service-webcache">service: webcache</a>
    </h4>
    <dl>
      <dt>HTTP alternate port</dt>
      <dd>Alias for <a href="#service-httpalt">httpalt</a>
</dd>
    </dl>
    <h4 id="service-webmin">
      <a href="#service-webmin">service: webmin</a>
    </h4>
    <dl>
      <dt>Webmin Administration System</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server webmin accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/10000</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://www.webmin.com/">Homepage</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-whois">
      <a href="#service-whois">service: whois</a>
    </h4>
    <dl>
      <dt>WHOIS Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server whois accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>tcp/43</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/Whois">Wikipedia</a>
          </li>
        </ul>
      </dd>
    </dl>
    <h4 id="service-xbox">
      <a href="#service-xbox">service: xbox</a>
    </h4>
    <dl>
      <dt>Xbox Live</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  client xbox accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>complex</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>many</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>Definition for the Xbox live service.</p>
          <p>See program source for contributor details.</p>
        </blockquote>
      </dd>
    </dl>
    <h4 id="service-xdmcp">
      <a href="#service-xdmcp">service: xdmcp</a>
    </h4>
    <dl>
      <dt>X Display Manager Control Protocol</dt>
      <dd>
        <p>Example:</p>
        <pre><code>  server xdmcp accept</code></pre>
        <p>Service Type:</p>
        <ul>
          <li>simple</li>
        </ul>
        <p>Server Ports:</p>
        <ul>
          <li>udp/177</li>
        </ul>
        <p>Client Ports:</p>
        <ul>
          <li>default</li>
        </ul>
        <p>Links</p>
        <ul>
          <li>
            <a href="http://en.wikipedia.org/wiki/X_display_manager_(program_type)#X_Display_Manager_Control_Protocol">Wikipedia</a>
          </li>
        </ul>
        <p>Notes</p>
        <blockquote>
          <p>See <a href="http://www.jirka.org/gdm-documentation/x70.html">Gnome Display Manager</a> for a discussion about XDMCP and firewalls (Gnome Display Manager is a replacement for XDM).</p>
        </blockquote>
      </dd>
    </dl>
    <p></p>
    <h2 id="firehol-synproxy5">
      <a href="#firehol-synproxy5">firehol-synproxy(5)</a>
    </h2>
    <h3 id="name-26">
      <a href="#name-26">NAME</a>
    </h3>
    <p>firehol-synproxy - configure synproxy</p>
<!--
contents-table:helper:synproxy:keyword-firehol-synproxy:Y:-:Configure synproxy.
  -->
    <h3 id="synopsis-25">
      <a href="#synopsis-25">SYNOPSIS</a>
    </h3>
    <p>synproxy <em>type</em> <em>rules-to-match-request</em> <em>action</em> [<em>action options</em>]</p>
    <h3 id="description-26">
      <a href="#description-26">DESCRIPTION</a>
    </h3>
    <ul>
      <li><strong>type</strong> defines where the SYNPROXY will be attached. It can be <code>input</code> (or <code>in</code>), <code>forward</code> (or <code>pass</code>):
<ul><li>use <code>input</code> (or <code>in</code>) when the IP of the real server is an IP assigned to a physical interface of the machine (i.e. the IP is at the firewall itself)</li><li>use <code>forward</code> (or <code>pass</code>) when the IP of the real server is routed by the machine (i.e. SYNPROXY should look at the FORWARD chain for this traffic).</li></ul></li>
      <li>
        <p><code>rules to match request</code> are FireHOL optional rule parameters and should match the original client REQUEST, before any destination NAT. <code>inface</code> and <code>dst</code> are required:</p>
        <ul>
          <li><code>inface</code> is one or more interfaces the REQUEST should be received from</li>
          <li><code>dst</code> is the IP of the real server, as seen by the client (before any destination NAT)</li>
        </ul>
      </li>
      <li>
        <p><strong>action</strong> defines how SYNPROXY will reach the real server and can be:</p>
        <ul>
          <li>
            <p><code>accept</code> to just allow the REQUEST reach the real server without any destination NAT</p>
          </li>
          <li>
            <p><code>dnat to IP:PORT</code> or <code>dnat to IP1-IP2:PORT1-PORT2</code> or <code>dnat to IP</code> or <code>dnat to :PORT</code> to have SYNPROXY reach a server on another machine in a DMZ (different IP and/or PORT compared to the original request). The synproxy statement supports everything supported by the dnat helper (see <a href="#firehol-nat5">firehol-nat(5)</a>).</p>
          </li>
          <li>
            <p><code>redirect to PORT</code> to divert the request to a port on the firewall itself. The synproxy statement supports everything supported by the redirect helper (see <a href="#firehol-nat5">firehol-nat(5)</a>).</p>
          </li>
          <li>
            <p><code>action CUSTOM_ACTION</code> to have any other FireHOL action performed on the NEW socket. Use the <code>action</code> helper to define custom actions (see <a href="#firehol-action5">firehol-action(5)</a>).</p>
          </li>
          <li>
            <p><code>action options</code> are everything supported by FireHOL optional rule parameters that should be applied only on the final action of SYN packet from SYNPROXY to the real server. For example this can be used to append <code>loglimit "TEXT"</code> to have something logged by iptables, or limit the concurrent sockets with <code>connlimit</code>. Generally, everything you can write on the same line after <code>server http accept</code> is also accepted here.</p>
          </li>
        </ul>
      </li>
    </ul>
    <h3 id="background">
      <a href="#background">BACKGROUND</a>
    </h3>
    <p>SYNPROXY is a TCP SYN packets proxy. It can be used to protect any TCP server (like a web server) from SYN floods and similar DDos attacks.</p>
    <p>SYNPROXY is a netfilter module, in the Linux kernel. It is optimized to handle millions of packets per second utilizing all CPUs available without any concurrency locking between the connections.</p>
    <p>The net effect of this, is that the real servers will not notice any change during the attack. The valid TCP connections will pass through and served, while the attack will be stopped at the firewall.</p>
    <p>For more information on why you should use a SYNPROXY, check these articles:</p>
    <ul>
      <li>http://rhelblog.redhat.com/2014/04/11/mitigate-tcp-syn-flood-attacks-with-red-hat-enterprise-linux-7-beta/</li>
      <li>https://r00t-services.net/knowledgebase/14/Homemade-DDoS-Protection-Using-IPTables-SYNPROXY.html</li>
    </ul>
    <p>SYNPROXY is included in the Linux kernels since version 3.12.</p>
    <h3 id="how-it-works">
      <a href="#how-it-works">HOW IT WORKS</a>
    </h3>
    <ul>
      <li>
        <p>When a SYNPROXY is used, clients transparently get connected to the SYNPROXY. So the 3-way TCP handshake happens first between the client and the SYNPROXY:</p>
        <ul>
          <li>Clients send TCP SYN to server A</li>
          <li>At the firewall, when this packet arrives it is marked as UNTRACKED</li>
          <li>The UNTRACKED TCP SYN packet is then given to SYNPROXY</li>
          <li>SYNPROXY gets this and responds (as server A) with TCP SYN+ACK (UNTRACKED)</li>
          <li>Client responds with TCP ACK (marked as INVALID or UNTRACKED in iptables) which is also given to SYNPROXY</li>
        </ul>
      </li>
      <li>
        <p>Once a client has been connected to the SYNPROXY, SYNPROXY automatically initiates a 3-way TCP handshake with the real server, spoofing the SYN packet so that the real server will see that the original client is attempting to connect:</p>
        <ul>
          <li>SYNPROXY sends TCP SYN to real server A. This is a NEW connection in iptables and happens on the OUTPUT chain. The source IP of the packet is the IP of the client</li>
          <li>The real server A responds with SYN+ACK to the client</li>
          <li>SYNPROXY receives this and responds back to the server with ACK. The connection is now marked as ESTABLISHED</li>
        </ul>
      </li>
      <li>
        <p>Once the connection has been established, SYNPROXY leaves the traffic flow between the client and the server</p>
      </li>
    </ul>
    <p>So, SYNPROXY can be used for any kind of TCP traffic. It can be used for both unencrypted and encrypted traffic, since it does not interfere with the content itself.</p>
    <h3 id="use-cases">
      <a href="#use-cases">USE CASES</a>
    </h3>
    <p>In FireHOL SYNPROXY support is implemented as a helper. The <code>synproxy</code> command can be used to set up any number of SYNPROXYs.</p>
    <p>FireHOL can set up SYNPROXY for any of these cases:</p>
    <ol style="list-style-type: decimal">
      <li>
        <p><strong>real server on the firewall itself, on the same port</strong> (e.g. SYNPROXY on port 80, real server on port 80 too).</p>
      </li>
      <li>
        <p><strong>real server on the firewall itself, on a different port</strong> (e.g. SYNPROXY on port 2200, real server on port 22).</p>
      </li>
      <li>
        <p><strong>real server on a different machine, without NAT</strong> (e.g. SYNPROXY on a router catching traffic towards IP A, port 80 and real server is at IP A port 80 too).</p>
      </li>
      <li>
        <p><strong>real server on a different machine, with NAT</strong> (e.g. SYNPROXY on a router catching traffic towards IP A, port 80 and real server is at IP 10.1.1.1 port 90).</p>
      </li>
      <li>
        <p><strong>screening incoming traffic that should never be sent to a real server</strong> so that traps and dynamic blacklists can be created using traffic that has been screened by SYNPROXY (eliminate "internet noise" and spoofed packets).</p>
      </li>
    </ol>
    <p>So, generally, all cases are covered.</p>
    <h3 id="design">
      <a href="#design">DESIGN</a>
    </h3>
    <p>The general guidelines for using <code>synproxy</code> in FireHOL, are:</p>
    <ol style="list-style-type: decimal">
      <li>
        <strong>Design your firewall as you would normally do without SYNPROXY</strong>
      </li>
      <li>Test that it works without SYNPROXY. Test especially the servers you want to protect. They should be working too</li>
      <li>Add <code>synproxy</code> statements for the servers you want to protect.</li>
    </ol>
    <p>To achieve these requirements:</p>
    <ol style="list-style-type: decimal">
      <li>
        <p>The helper will automatically do everything needed for SYNPROXY to:</p>
        <ul>
          <li>receive the initial SYN packet from the client</li>
          <li>respond back to the client with SYN+ACK</li>
          <li>receive the first ACK packet from the client</li>
          <li>send the initial SYN packet to the server</li>
        </ul>
      </li>
    </ol>
    <p>There are cases where the above are very tricky to achieve. You don't need to match these in your <code>firehol.conf</code>. The <code>synproxy</code> helper will automatically take care of them. However:</p>
    <blockquote>
      <p>You do need the allow the flow of traffic between the real server and the real client (as you normally do without a <code>synproxy</code>, with a <code>client</code>, <code>server</code>, or <code>route</code> statement in an <code>interface</code> or <code>router</code> section).</p>
    </blockquote>
    <ol start="2" style="list-style-type: decimal">
      <li>The helper will prevent the 3-way TCP handshake between SYNPROXY and the real server interact with other <strong>destination NAT</strong> rules you may have. However for this to happen, make sure you place the <code>synproxy</code> statements above any destination NAT rules (<code>redirect</code>, <code>dnat</code>, <code>transparent_squid</code>, <code>transparent_proxy</code>, <code>tproxy</code>, etc). So:</li>
    </ol>
    <blockquote>
      <p>SYNPROXY will interact with destination NAT you have in <code>firehol.conf</code> <strong>only</strong> if the <code>synproxy</code> statements are place below the destination NAT ones.</p>
      <p>You normally do not need to have <code>synproxy</code> interact with other destination NAT rules. The <code>synproxy</code> helper will handle the destination NAT (<code>dnat</code> or <code>redirect</code>) it needs by itself.</p>
      <p>So <strong>place <code>synproxy</code> statements above all destination NAT statements, unless you know what you are doing</strong>.</p>
    </blockquote>
    <ol start="3" style="list-style-type: decimal">
      <li>The helper will allow the 3-way TCP handshake between SYNPROXY and the real server interact with <strong>source NAT</strong> rules you may have (<code>snat</code>, <code>masquerade</code>), since these may be needed to reach the real server.</li>
    </ol>
    <h3 id="limitations">
      <a href="#limitations">LIMITATIONS</a>
    </h3>
    <ol style="list-style-type: decimal">
      <li>
        <p>Internally there are matches that are made without taking into account the original <code>inface</code>. So, in case different actions have to be taken depending on the interface the request is received, <code>src</code> should be added to differentiate the traffic between the two flows.</p>
      </li>
      <li>
        <p>SYNPROXY does not inherit MARKs from the original request packets. It should and it would make matching a lot easier, but it does not. This means that for all packets generated by SYNPROXY, <code>inface</code> is lost.</p>
      </li>
      <li>
        <p>FireHOL internally uses a MARK to tag packets send from SYNPROXY to the target server. This is used for 3 reasons:</p>
        <ul>
          <li>
            <p>isolate these packets from other destination NAT rules. If they were not isolated from the destination NAT rules, then packets from the SYNPROXY could be matched by a transparent proxy and enter your web proxy. They could be matched by a transparent proxy because they actually originate from the local machine.</p>
          </li>
          <li>
            <p>isolate the same packets from the rest of the packet filtering rules. Without this isolation, most probably the packets will have been dropped since they come from lo.</p>
          </li>
          <li>
            <p>report if orphan synproxy packets are encountered. So packets the FireHOL engine failed to match properly, should appear with a iptables log saying "ORPHAN SYNPROXY-&gt;SERVER". If you don't have such logs, everything works as expected.</p>
          </li>
        </ul>
      </li>
    </ol>
    <h3 id="other-options">
      <a href="#other-options">OTHER OPTIONS</a>
    </h3>
    <p>You can change the TCP options used by <code>synproxy</code> by setting the variable <code>FIREHOL_SYNPROXY_OPTIONS</code>. The default is this:</p>
    <pre><code>FIREHOL_SYNPROXY_OPTIONS="--sack-perm --timestamp --wscale 7 --mss 1460"</code></pre>
    <p>If you want to see it in action in the iptables log, then enable logging:</p>
    <pre><code>FIREHOL_SYNPROXY_LOG=1</code></pre>
    <p>The default is disabled (0). If you enable it, every step of the 3-way setup between the client and SYNPROXY and the SYN packet of SYNPROXY towards the real server will be logged by iptables.</p>
    <p>Using the variable <code>FIREHOL_CONNTRACK_LOOSE_MATCHING</code> you can set <code>net.netfilter.nf_conntrack_tcp_loose</code>. FireHOL will automatically set this to 0 when a synproxy is set up.</p>
    <p>Using the variable <code>FIREHOL_TCP_TIMESTAMPS</code> you can set <code>net.ipv4.tcp_timestamps</code>. FireHOL will automatically set this to 1 when a synproxy is set up.</p>
    <p>Using the variable <code>FIREHOL_TCP_SYN_COOKIES</code> you can set <code>net.ipv4.tcp_syncookies</code>. FireHOL will automatically set this to 1 when a synproxy is set up.</p>
    <p>On a busy server, you are advised to increase the maximum connection tracker entries and its hash table size.</p>
    <ul>
      <li>
        <p>Using the variable <code>FIREHOL_CONNTRACK_HASHSIZE</code> you can set <code>/sys/module/nf_conntrack/parameters/hashsize</code>.</p>
      </li>
      <li>
        <p>Using the variable <code>FIREHOL_CONNTRACK_MAX</code> you can set <code>net.netfilter.nf_conntrack_max</code>.</p>
      </li>
    </ul>
    <p>FireHOL will not alter these variables by itself.</p>
    <h3 id="synproxy-and-dynamic-ip">
      <a href="#synproxy-and-dynamic-ip">SYNPROXY AND DYNAMIC IP</a>
    </h3>
    <p>By default the <code>synproxy</code> helper requires from you to define a <code>dst IP</code> of the server that is to be protected. This is required because the destination IP will be used to match the SYN packet the synproxy sends to the server.</p>
    <p>There is however another way that allows the use of synproxy in environments where the IP of the server is unknown (like a dynamic IP DSL):</p>
    <ol style="list-style-type: decimal">
      <li>
        <p>First you need to set <code>FIREHOL_SYNPROXY_EXCLUDE_OWNER=1</code>. This will make synproxy not match packets that are generated by the local machine, even if the process that generates them uses your public IP (the packets in order to be matched they will need not have a UID or GID).</p>
      </li>
      <li>
        <p>Next you will need to exclude you lan IPs by adding <code>src not "${UNROUTABLE_IPS}"</code> (or any other network you know you use) to the synproxy statement.</p>
      </li>
    </ol>
    <h3 id="examples-17">
      <a href="#examples-17">EXAMPLES</a>
    </h3>
    <p>Protect a web server running on the firewall with IP 1.2.3.4, from clients on eth0:</p>
    <pre><code>ipv4 synproxy input inface eth0 dst 1.2.3.4 dport 80 accept

interface eth0 wan
    server http accept</code></pre>
    <p>Protect a web server running on port 90 on the firewall with IP 1.2.3.4, from clients on eth0 that believe the web server is running on port 80:</p>
    <pre><code>server_myhttp_ports="tcp/90"
client_myhttp_ports="default"

ipv4 synproxy input inface eth0 dst 1.2.3.4 dport 80 redirect to 90

interface eth0 wan
    server myhttp accept # packet filtering works with the real ports</code></pre>
    <p>Protect a web server running on another machine (5.6.7.8), while the firewall is the router (without NAT):</p>
    <pre><code>ipv4 synproxy forward inface eth0 dst 5.6.7.8 dport 80 accept

router wan2lan inface eth0 outface eth1
    server http accept dst 5.6.7.8</code></pre>
    <p>Protect a web server running on another machine in a DMZ (public IP is 1.2.3.4 on eth0, web server IP is 10.1.1.1 on eth1):</p>
    <pre><code>ipv4 synproxy input inface eth0 \
    dst 1.2.3.4 dport 80 dnat to 10.1.1.1

router wan2lan inface eth0 outface eth1
    server http accept dst 10.1.1.1</code></pre>
    <p>Note that we used <code>input</code> not <code>forward</code>, because the firewall has the IP 1.2.3.4 on its eth0 interface. The client request is expected on input.</p>
    <p>Protect an array of 10 web servers running on 10 other machines in a DMZ (public IP is 1.2.3.4 on eth0, web servers IPs are 10.1.1.1 to 10.1.1.10 on eth1):</p>
    <pre><code>ipv4 synproxy input inface eth0 \
    dst 1.2.3.4 dport 80 dnat to 10.1.1.1-10.1.1.10 persistent

router wan2lan inface eth0 outface eth1
    server http accept dst 10.1.1.1-10.1.1.10</code></pre>
    <p>The above configuration is a load balancer. Requests towards 1.2.3.4 port 80 will be distributed to the 10 web servers with persistence (each client will always see one of them).</p>
    <p>Catch all traffic towards SSH port tcp/22 and send it to <code>TRAP_AND_DROP</code> as explained in <a href="Working-with-traps">Working With Traps</a>. At the same time, allow SSH on port tcp/2200 (without altering the ssh server):</p>
    <pre><code> # definition of action TRAP_AND_DROP
 ipv4 action TRAP_AND_DROP sockets_suspects_trap 3600 86400 1 src not "${UNROUTABLE_IPS}" next action DROP

 # send ssh traffic to TRAP_AND_DROP
 ipv4 synproxy input inface eth0 dst 1.2.3.4 dport 22 action TRAP_AND_DROP

 # accept ssh traffic on tcp/2200
 ipv4 synproxy input inface eth0 dst 1.2.3.4 dport 2200 redirect to 22

 interface eth0 wan
    server ssh accept</code></pre>
    <h3 id="see-also-25">
      <a href="#see-also-25">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-masquerade5">firehol-masquerade(5)</a> - masquerade helper</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO-6.html">NAT HOWTO</a>
      </li>
      <li>
        <a href="http://upload.wikimedia.org/wikipedia/commons/3/37/Netfilter-packet-flow.svg">netfilter flow diagram</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-tcpmss5">
      <a href="#firehol-tcpmss5">firehol-tcpmss(5)</a>
    </h2>
    <h3 id="name-27">
      <a href="#name-27">NAME</a>
    </h3>
    <p>firehol-tcpmss - set the MSS of TCP SYN packets for routers</p>
<!--
contents-table:subcommand:tcpmss:keyword-firehol-tcpmss:Y:*all forbidden*:Set the MSS (Maximum Segment Size) of TCP SYN packets routed through the firewall.
contents-table:helper:tcpmss:keyword-firehol-tcpmss:Y:*all forbidden*:Set the MSS (Maximum Segment Size) of TCP SYN packets routed through the firewall.
  -->
    <h3 id="synopsis-26">
      <a href="#synopsis-26">SYNOPSIS</a>
    </h3>
    <p>tcpmss { <em>mss</em> | auto } [<em>if-list</em>]</p>
    <h3 id="description-27">
      <a href="#description-27">DESCRIPTION</a>
    </h3>
    <p>The <code>tcpmss</code> helper command sets the MSS (Maximum Segment Size) of TCP SYN packets routed through the firewall. This can be used to overcome situations where Path MTU Discovery is not working and packet fragmentation is not possible.</p>
    <p>A numeric <em>mss</em> will set MSS of TCP connections to the value given. Using the word <code>auto</code> will set the MSS to the MTU of the outgoing interface minus 40 (clamp-mss-to-pmtu).</p>
    <p>If used within a <code>router</code> or <code>interface</code> definition the MSS will be applied to outgoing traffic on the <code>outface</code>(s) of the router or interface.</p>
    <p>If used before any router or interface definitions it will be applied to all traffic passing through the firewall. If <em>if-list</em> is given, the MSS will be applied only to those interfaces.</p>
    <h3 id="examples-18">
      <a href="#examples-18">EXAMPLES</a>
    </h3>
    <pre><code>
tcpmss auto

tcpmss 500

tcpmss 500 "eth1 eth2 eth3"</code></pre>
    <h3 id="see-also-26">
      <a href="#see-also-26">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-interface5">firehol-interface(5)</a> - interface definition</li>
      <li><a href="#firehol-router5">firehol-router(5)</a> - router definition</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
      <li>
        <a href="https://www.frozentux.net/iptables-tutorial/iptables-tutorial.html#TCPMSSTARGET">TCPMSS target in the iptables tutorial</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-tos5">
      <a href="#firehol-tos5">firehol-tos(5)</a>
    </h2>
    <h3 id="name-28">
      <a href="#name-28">NAME</a>
    </h3>
    <p>firehol-tos - set the Type of Service (TOS) of packets</p>
<!--
contents-table:helper:tos:keyword-firehol-tos-helper:Y:-:Set the Type of Service (TOS) of packets.
  -->
    <h3 id="synopsis-27">
      <a href="#synopsis-27">SYNOPSIS</a>
    </h3>
    <p>tos <em>value</em> <em>chain</em> [<em>rule-params</em>]</p>
    <h3 id="description-28">
      <a href="#description-28">DESCRIPTION</a>
    </h3>
    <p>The <code>tos</code> helper command sets the Type of Service (TOS) field in packet headers.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>There is also a <code>tos</code> parameter which allows matching TOS values within individual rules (see <a href="#tos">firehol-params(5)</a>).</p>
    </blockquote>
    <p>The <em>value</em> can be an integer number (decimal or hexadecimal) or one of the descriptive values accepted by iptables(8) (run <code>iptables -j TOS --help</code> for a list).</p>
    <p>The <em>chain</em> will be used to find traffic to mark. It can be any of the iptables(8) built in chains belonging to the <code>mangle</code> table. The chain names are: INPUT, FORWARD, OUTPUT, PREROUTING and POSTROUTING. These names are case-sensitive.</p>
    <p>The <em>rule-params</em> define a set of rule parameters to match the traffic that is to be marked within the chosen chain. See <a href="#firehol-params5">firehol-params(5)</a> for more details.</p>
    <p>Any <code>tos</code> commands will affect all traffic matched. They must be declared before the first <code>router</code> or <code>interface</code>.</p>
    <h3 id="examples-19">
      <a href="#examples-19">EXAMPLES</a>
    </h3>
    <pre><code>
 # set TOS to 16, packets sent by the local machine
 tos 16 OUTPUT

 # set TOS to 0x10 (16), packets routed by the local machine
 tos 0x10 FORWARD

 # set TOS to Maximize-Throughput (8), packets routed by the local
 #              machine, destined for port TCP/25 of 198.51.100.1
 tos Maximize-Throughput FORWARD proto tcp dport 25 dst 198.51.100.1</code></pre>
    <h3 id="see-also-27">
      <a href="#see-also-27">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-params5">firehol-params(5)</a> - optional rule parameters</li>
      <li><a href="#firehol-tosfix5">firehol-tosfix(5)</a> - tosfix config helper</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-tosfix5">
      <a href="#firehol-tosfix5">firehol-tosfix(5)</a>
    </h2>
    <h3 id="name-29">
      <a href="#name-29">NAME</a>
    </h3>
    <p>firehol-tosfix - apply suggested TOS values to packets</p>
<!--
contents-table:helper:tosfix:keyword-firehol-tosfix:Y:*all forbidden*:Apply suggested TOS values to packets.
  -->
    <h3 id="synopsis-28">
      <a href="#synopsis-28">SYNOPSIS</a>
    </h3>
    <p>tosfix</p>
    <h3 id="description-29">
      <a href="#description-29">DESCRIPTION</a>
    </h3>
    <p>The <code>tosfix</code> helper command sets the Type of Service (TOS) field in packet headers based on the suggestions given by Erik Hensema in <a href="http://www.docum.org/docum.org/faq/cache/49.html">iptables and tc shaping tricks</a>.</p>
    <p>The following TOS values are set:</p>
    <ul>
      <li>
        <p>All TCP ACK packets with length less than 128 bytes are assigned Minimize-Delay, while bigger ones are assigned Maximize-Throughput</p>
      </li>
      <li>
        <p>All packets with TOS Minimize-Delay, that are bigger than 512 bytes are set to Maximize-Throughput, except for short bursts of 2 packets per second</p>
      </li>
    </ul>
    <p>The <code>tosfix</code> command must be used before the first router or interface.</p>
    <h3 id="example-1">
      <a href="#example-1">EXAMPLE</a>
    </h3>
    <pre><code>tosfix</code></pre>
    <h3 id="see-also-28">
      <a href="#see-also-28">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-tos5">firehol-tos(5)</a> - tosfix config helper</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-variables5">
      <a href="#firehol-variables5">firehol-variables(5)</a>
    </h2>
    <h3 id="name-30">
      <a href="#name-30">NAME</a>
    </h3>
    <p>firehol-variables - control variables for FireHOL</p>
    <h3 id="synopsis-29">
      <a href="#synopsis-29">SYNOPSIS</a>
    </h3>
    <p>Defaults:</p>
    <ul>
      <li>DEFAULT_INTERFACE_POLICY="DROP"</li>
      <li>DEFAULT_ROUTER_POLICY="RETURN"</li>
      <li>UNMATCHED_INPUT_POLICY="DROP"</li>
      <li>UNMATCHED_OUTPUT_POLICY="DROP"</li>
      <li>UNMATCHED_FORWARD_POLICY="DROP"</li>
      <li>FIREHOL_INPUT_ACTIVATION_POLICY="ACCEPT"</li>
      <li>FIREHOL_OUTPUT_ACTIVATION_POLICY="ACCEPT"</li>
      <li>FIREHOL_FORWARD_ACTIVATION_POLICY="ACCEPT"</li>
      <li>FIREHOL_LOG_MODE="LOG"</li>
      <li>FIREHOL_LOG_LEVEL=<em>see notes</em></li>
      <li>FIREHOL_LOG_OPTIONS="--log-level warning"</li>
      <li>FIREHOL_LOG_FREQUENCY="1/second"</li>
      <li>FIREHOL_LOG_BURST="5"</li>
      <li>FIREHOL_LOG_PREFIX=""</li>
      <li>FIREHOL_DROP_INVALID="0"</li>
      <li>DEFAULT_CLIENT_PORTS="1000:65535"</li>
      <li>FIREHOL_NAT="0"</li>
      <li>FIREHOL_ROUTING="0"</li>
      <li>FIREHOL_AUTOSAVE=<em>see notes</em></li>
      <li>FIREHOL_AUTOSAVE6=<em>see notes</em></li>
      <li>FIREHOL_LOAD_KERNEL_MODULES="1"</li>
      <li>FIREHOL_TRUST_LOOPBACK="1"</li>
      <li>FIREHOL_DROP_ORPHAN_TCP_ACK_FIN="0"</li>
      <li>FIREHOL_DEBUGGING=""</li>
      <li>WAIT_FOR_IFACE=""</li>
    </ul>
    <h3 id="description-30">
      <a href="#description-30">DESCRIPTION</a>
    </h3>
    <p>There are a number of variables that control the behaviour of FireHOL.</p>
    <p>All variables may be set in the main FireHOL configuration file <code>/etc/firehol/firehol.conf</code>.</p>
    <p>Variables which affect the runtime but not the created firewall may also be set as environment variables before running <a href="#firehol1">firehol(1)</a>. These can change the default values but will be overwritten by values set in the configuration file. If a variable can be set by an environment variable it is specified below.</p>
    <p>FireHOL also sets some variables before processing the configuration file which you can use as part of your configuration. These are described in <a href="#firehol.conf5">firehol.conf(5)</a>.</p>
    <h3 id="variables">
      <a href="#variables">VARIABLES</a>
    </h3>
    <dl>
      <dt>DEFAULT_INTERFACE_POLICY</dt>
      <dd>
        <p>This variable controls the default action to be taken on traffic not matched by any rule within an interface. It can be overridden using <a href="#firehol-policy5">firehol-policy(5)</a>.</p>
        <p>Packets that reach the end of an interface without an action of return or accept are logged. You can control the frequency of this logging by altering FIREHOL_LOG_FREQUENCY.</p>
        <p>Example:</p>
        <pre><code>
DEFAULT_INTERFACE_POLICY="REJECT"</code></pre>
      </dd>
      <dt>DEFAULT_ROUTER_POLICY</dt>
      <dd>
        <p>This variable controls the default action to be taken on traffic not matched by any rule within a router. It can be overridden using <a href="#firehol-policy5">firehol-policy(5)</a>.</p>
        <p>Packets that reach the end of a router without an action of return or accept are logged. You can control the frequency of this logging by altering FIREHOL_LOG_FREQUENCY.</p>
        <p>Example:</p>
        <pre><code>
DEFAULT_ROUTER_POLICY="REJECT"</code></pre>
      </dd>
      <dt>UNMATCHED_{INPUT|OUTPUT|FORWARD}_POLICY</dt>
      <dd>
        <p>These variables control the default action to be taken on traffic not matched by any interface or router definition that was incoming, outgoing or for forwarding respectively. Any supported value from <a href="#firehol-actions5">firehol-actions(5)</a> may be set.</p>
        <p>All packets that reach the end of a chain are logged, regardless of these settings. You can control the frequency of this logging by altering FIREHOL_LOG_FREQUENCY.</p>
        <p>Example:</p>
        <pre><code>
UNMATCHED_INPUT_POLICY="REJECT"
UNMATCHED_OUTPUT_POLICY="REJECT"
UNMATCHED_FORWARD_POLICY="REJECT"</code></pre>
      </dd>
      <dt>FIREHOL_{INPUT|OUTPUT|FORWARD}_ACTIVATION_POLICY</dt>
      <dd>
        <p>These variables control the default action to be taken on traffic during firewall activation for incoming, outgoing and forwarding respectively. Acceptable values are <code>ACCEPT</code>, <code>DROP</code> and <code>REJECT</code>. They may be set as environment variables.</p>
        <p>FireHOL defaults all values to <code>ACCEPT</code> so that your communications continue to work uninterrupted.</p>
        <p>If you wish to prevent connections whilst the new firewall is activating, set these values to <code>DROP</code>. This is important to do if you are using <code>all</code> or <code>any</code> to match traffic; connections established during activation will continue even if they would not be allowed once the firewall is established.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_INPUT_ACTIVATION_POLICY="DROP"
FIREHOL_OUTPUT_ACTIVATION_POLICY="DROP"
FIREHOL_FORWARD_ACTIVATION_POLICY="DROP"</code></pre>
      </dd>
      <dt>FIREHOL_LOG_MODE</dt>
      <dd>
        <p>This variable controls method that FireHOL uses for logging.</p>
        <p>Acceptable values are <code>LOG</code> (normal syslog) and <code>ULOG</code> (netfilter ulogd). When <code>ULOG</code> is selected, FIREHOL_LOG_LEVEL is ignored.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_LOG_MODE="ULOG"</code></pre>
        <p>To see the available options run: <code>/sbin/iptables -j LOG --help</code> or <code>/sbin/iptables -j ULOG --help</code></p>
      </dd>
      <dt>FIREHOL_LOG_LEVEL</dt>
      <dd>
        <p>This variable controls the level at which events will be logged to syslog.</p>
        <p>To avoid packet logs appearing on your console you should ensure klogd only logs traffic that is more important than that produced by FireHOL.</p>
        <p>Use the following option to choose an iptables(8) log level (alpha or numeric) which is higher than the <code>-c</code> of klogd.</p>
        <table>
          <caption>iptables/klogd levels</caption>
          <thead>
            <tr class="header">
              <th align="left">iptables</th>
              <th align="left">klogd</th>
              <th align="left">description</th>
            </tr>
          </thead>
          <tbody>
            <tr class="odd">
              <td align="left">emerg (0)</td>
              <td align="left">0</td>
              <td align="left">system is unusable</td>
            </tr>
            <tr class="even">
              <td align="left">alert (1)</td>
              <td align="left">1</td>
              <td align="left">action must be taken immediately</td>
            </tr>
            <tr class="odd">
              <td align="left">crit (2)</td>
              <td align="left">2</td>
              <td align="left">critical conditions</td>
            </tr>
            <tr class="even">
              <td align="left">error (3)</td>
              <td align="left">3</td>
              <td align="left">error conditions</td>
            </tr>
            <tr class="odd">
              <td align="left">warning (4)</td>
              <td align="left">4</td>
              <td align="left">warning conditions</td>
            </tr>
            <tr class="even">
              <td align="left">notice (5)</td>
              <td align="left">5</td>
              <td align="left">normal but significant condition</td>
            </tr>
            <tr class="odd">
              <td align="left">info (6)</td>
              <td align="left">6</td>
              <td align="left">informational</td>
            </tr>
            <tr class="even">
              <td align="left">debug (7)</td>
              <td align="left">7</td>
              <td align="left">debug-level messages</td>
            </tr>
          </tbody>
        </table>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>The default for klogd is generally to log everything (7 and lower) and the default level for iptables(4) is to log as warning (4).</p>
        </blockquote>
      </dd>
      <dt>FIREHOL_LOG_OPTIONS</dt>
      <dd>
        <p>This variable controls the way in which events will be logged to syslog.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_LOG_OPTIONS="--log-level info \
                     --log-tcp-options --log-ip-options"</code></pre>
        <p>To see the available options run: <code>/sbin/iptables -j LOG --help</code></p>
      </dd>
      <dt>FIREHOL_LOG_FREQUENCY; FIREHOL_LOG_BURST</dt>
      <dd>
        <p>These variables control the frequency that each logging rule will write events to syslog. FIREHOL_LOG_FREQUENCY is set to the maximum average frequency and FIREHOL_LOG_BURST specifies the maximum initial number.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_LOG_FREQUENCY="30/minute"
FIREHOL_LOG_BURST="2"</code></pre>
        <p>To see the available options run: <code>/sbin/iptables -m limit --help</code></p>
      </dd>
      <dt>FIREHOL_LOG_PREFIX</dt>
      <dd>
        <p>This value is added to the contents of each logged line for easy detection of FireHOL lines in the system logs. By default it is empty.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_LOG_PREFIX="FIREHOL:"</code></pre>
      </dd>
      <dt>FIREHOL_DROP_INVALID</dt>
      <dd>
        <p>If set to 1, this variable causes FireHOL to drop all packets matched as <code>INVALID</code> in the iptables(8) connection tracker.</p>
        <p>You may be better off using <a href="#firehol-protection5">firehol-protection(5)</a> to control matching of <code>INVALID</code> packets and others on a per-interface and per-router basis.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>Care must be taken on IPv6 interfaces, since ICMPv6 packets such as Neighbour Discovery are not tracked, meaning they are marked as INVALID.</p>
        </blockquote>
        <p>Example:</p>
        <pre><code>
FIREHOL_DROP_INVALID="1"</code></pre>
      </dd>
      <dt>DEFAULT_CLIENT_PORTS</dt>
      <dd>
        <p>This variable controls the port range that is used when a remote client is specified. For clients on the local host, FireHOL finds the exact client ports by querying the kernel options.</p>
        <p>Example:</p>
        <pre><code>
DEFAULT_CLIENT_PORTS="0:65535"</code></pre>
      </dd>
      <dt>FIREHOL_NAT</dt>
      <dd>
        <p>If set to 1, this variable causes FireHOL to load the NAT kernel modules. If you make use of the NAT helper commands, the variable will be set to 1 automatically. It may be set as an environment variable.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_NAT="1"</code></pre>
      </dd>
      <dt>FIREHOL_ROUTING</dt>
      <dd>
        <p>If set to 1, this variable causes FireHOL to enable routing in the kernel. If you make use of <code>router</code> definitions or certain helper commands the variable will be set to 1 automatically. It may be set as an environment variable.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_ROUTING="1"</code></pre>
      </dd>
      <dt>FIREHOL_AUTOSAVE; FIREHOL_AUTOSAVE6</dt>
      <dd>
        <p>These variables specify the file of IPv4/IPv6 rules that will be created when <a href="#firehol1">firehol(1)</a> is called with the <code>save</code> argument. It may be set as an environment variable.</p>
        <p>If the variable is not set, a system-specific value is used which was defined at configure-time. If no value was chosen then the save fails.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_AUTOSAVE="/tmp/firehol-saved-ipv4.txt"
FIREHOL_AUTOSAVE6="/tmp/firehol-saved-ipv6.txt"</code></pre>
      </dd>
      <dt>FIREHOL_LOAD_KERNEL_MODULES</dt>
      <dd>
        <p>If set to 0, this variable forces FireHOL to not load any kernel modules. It is needed only if the kernel has modules statically included and in the rare event that FireHOL cannot access the kernel configuration. It may be set as an environment variable.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_LOAD_KERNEL_MODULES="0"</code></pre>
      </dd>
      <dt>FIREHOL_TRUST_LOOPBACK</dt>
      <dd>
        <p>If set to 0, the loopback device "lo" will not be trusted and you can write standard firewall rules for it.</p>
        <blockquote>
          <p>
            <strong>Warning</strong>
          </p>
          <p>If you do not set up appropriate rules, local processes will not be able to communicate with each other which can result in serious breakages.</p>
        </blockquote>
        <p>By default "lo" is trusted and all <code>INPUT</code> and <code>OUTPUT</code> traffic is accepted (forwarding is not included).</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_TRUST_LOOPBACK="0"</code></pre>
      </dd>
      <dt>FIREHOL_DROP_ORPHAN_TCP_ACK_FIN</dt>
      <dd>
        <p>If set to 1, FireHOL will drop all TCP connections with ACK FIN set without logging them.</p>
        <p>In busy environments the iptables(8) connection tracker removes connection tracking list entries as soon as it receives a FIN. This makes the ACK FIN appear as an invalid packet which will normally be logged by FireHOL.</p>
        <p>Example:</p>
        <pre><code>
FIREHOL_DROP_ORPHAN_TCP_ACK_FIN="1"</code></pre>
      </dd>
      <dt>FIREHOL_DEBUGGING</dt>
      <dd>
        <p>If set to a non-empty value, switches on debug output so that it is possible to see what processing FireHOL is doing.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>This variable can <em>only</em> be set as an environment variable, since it is processed before any configuration files are read.</p>
        </blockquote>
        <p>Example:</p>
        <pre><code>
FIREHOL_DEBUGGING="Y"</code></pre>
      </dd>
      <dt>WAIT_FOR_IFACE</dt>
      <dd>
        <p>If set to the name of a network device (e.g. eth0), FireHOL will wait until the device is up (or until 60 seconds have elapsed) before continuing.</p>
        <blockquote>
          <p>
            <strong>Note</strong>
          </p>
          <p>This variable can <em>only</em> be set as an environment variable, since it determines when the main configuration file will be processed.</p>
        </blockquote>
        <p>A device does not need to be up in order to have firewall rules created for it, so this option should only be used if you have a specific need to wait (e.g. the network must be queried to determine the hosts or ports which will be firewalled).</p>
        <p>Example:</p>
        <pre><code>
WAIT_FOR_IFACE="eth0"</code></pre>
      </dd>
    </dl>
    <h3 id="see-also-29">
      <a href="#see-also-29">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li><a href="#firehol-nat5">firehol-nat(5)</a> - nat, snat, dnat, redirect helpers</li>
      <li><a href="#firehol-actions5">firehol-actions(5)</a> - actions for rules</li>
      <li><a href="http://ipset.netfilter.org/iptables.man.html">iptables(8)</a> - administration tool for IPv4 firewalls</li>
      <li><a href="http://ipset.netfilter.org/ip6tables.man.html">ip6tables(8)</a> - administration tool for IPv6 firewalls</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
    <h2 id="firehol-version5">
      <a href="#firehol-version5">firehol-version(5)</a>
    </h2>
    <h3 id="name-31">
      <a href="#name-31">NAME</a>
    </h3>
    <p>firehol-version - set version number of configuration file</p>
<!--
contents-table:helper:version:keyword-firehol-version:N:*all forbidden*:Specify a version number for the configuration file.
  -->
    <h3 id="synopsis-30">
      <a href="#synopsis-30">SYNOPSIS</a>
    </h3>
    <p>version 6</p>
    <h3 id="description-31">
      <a href="#description-31">DESCRIPTION</a>
    </h3>
    <p>The <code>version</code> helper command states the configuration file version.</p>
    <p>If the value passed is newer than the running version of FireHOL supports, FireHOL will not run.</p>
    <p>You do not have to specify a version number for a configuration file, but by doing so you will prevent FireHOL trying to process a file which it cannot handle.</p>
    <p>The value that FireHOL expects is increased every time that the configuration file format changes.</p>
    <blockquote>
      <p>
        <strong>Note</strong>
      </p>
      <p>If you pass version 5 to FireHOL, it will disable IPv6 support and warn you that you must update your configuration.</p>
    </blockquote>
    <h3 id="see-also-30">
      <a href="#see-also-30">SEE ALSO</a>
    </h3>
    <ul>
      <li><a href="#firehol1">firehol(1)</a> - FireHOL program</li>
      <li><a href="#firehol.conf5">firehol.conf(5)</a> - FireHOL configuration</li>
      <li>
        <a href="http://firehol.org/">FireHOL Website</a>
      </li>
      <li>
        <a href="http://firehol.org/firehol-manual.pdf">FireHOL Online PDF Manual</a>
      </li>
      <li>
        <a href="http://firehol.org/documentation/">FireHOL Online Documentation</a>
      </li>
    </ul>
    <p></p>
<!--
  This file lists keywords associated with FireHOL services
  and associates them with anchors in the HTML.
  -->
<!--
    This file lists internal references within the manual
    and associates them with anchors in the output.

    Note that the blank line after this comment is required, to keep
    pandoc(1) happy when formatting.
  -->
<!--
    This file lists keywords associated with the FireHOL configuration
    language and associates them with anchors in the output.

    Note that the blank line after this comment is required, to keep
    pandoc(1) happy when formatting.
  -->
<!--
    This file lists references used by the website and need to be maintained
    within the document.

    Note that the blank line after this comment is required, to keep
    pandoc(1) happy when formatting.
  -->
  </body>
</html>
